<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>NOTE 199 &#8211; Table Query Language</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,mathml,fn-in,html --> 
<meta name="src" content="199.tex" /> 
<meta name="date" content="2015-05-29 10:59:00" /> 
<link rel="stylesheet" type="text/css" href="199.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                                         

                                                                                         
                                                                                         

                                                                                         

<h2 class="titleHead">NOTE 199 &#8211; Table Query Language</h2>
<div class="author" ><span 
class="cmr-12">Ger van Diepen, ASTRON Dwingeloo</span></div><br />
<div class="date" ><span 
class="cmr-12">2013 Aug 19</span></div>
   </div><div 
class="abstract" 
>
<div class="center" 
>
<!--l. 22--><p class="noindent" >
</p><!--l. 22--><p class="noindent" ><span 
class="cmbx-10">Abstract</span></p></div>
     <!--l. 23--><p class="indent" >    <span 
class="cmr-10">The Table Query Language (TaQL) is an SQL-like high level language to do operations</span>
     <span 
class="cmr-10">like selection, sort, and update on a casacore table. It is a very versatile language with full</span>
     <span 
class="cmr-10">support for table columns containing array data. It has inherent support for masked arrays,</span>
     <span 
class="cmr-10">units, and astronomical coordinates. It has a very rich set of functions (like cone search and</span>
     <span 
class="cmr-10">array reduction) making it very suitable for astronomical applications. It also has full support</span>
     <span 
class="cmr-10">of nested queries. An operation that can be expressed in a single function is the matching of</span>
     <span 
class="cmr-10">two sky catalogues. </span><br 
class="newline" /><span 
class="cmr-10">A binding in C++, Python, and Glish is available.</span>
</p>
</div> <a 
href="199.pdf" >A pdf version of this note is available.</a>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Introduction</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">TaQL Commands</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Command summary</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-5">Using a style</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.3 <a 
href="#x1-60002.3" id="QQ2-1-6">Timing</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.4 <a 
href="#x1-70002.4" id="QQ2-1-7">Reserved words</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-80003" id="QQ2-1-8">Selection from a table</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-90003.1" id="QQ2-1-9">SELECT column_list</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-100003.2" id="QQ2-1-10">INTO [table] [AS type]</a></span>
                                                                                         

                                                                                         
<br />   &#x00A0;<span class="subsectionToc" >3.3 <a 
href="#x1-110003.3" id="QQ2-1-11">FROM table_list</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.4 <a 
href="#x1-120003.4" id="QQ2-1-12">WHERE expression</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.5 <a 
href="#x1-130003.5" id="QQ2-1-13">ORDERBY sort_list</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.6 <a 
href="#x1-140003.6" id="QQ2-1-14">LIMIT/OFFSET expression</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.7            <a 
href="#x1-150003.7" id="QQ2-1-15">GIVING            [table]            [AS            type]
<!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo></math> set</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-160004" id="QQ2-1-16">Expressions</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-170004.1" id="QQ2-1-17">Data Types</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.2 <a 
href="#x1-180004.2" id="QQ2-1-18">Regular Expressions and String Distances</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.3 <a 
href="#x1-190004.3" id="QQ2-1-19">Constants</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.1 <a 
href="#x1-200004.3.1" id="QQ2-1-20">Bool</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.2 <a 
href="#x1-210004.3.2" id="QQ2-1-21">Integer</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.3 <a 
href="#x1-220004.3.3" id="QQ2-1-22">Double (and time/position)</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.4 <a 
href="#x1-230004.3.4" id="QQ2-1-23">Complex</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.5 <a 
href="#x1-240004.3.5" id="QQ2-1-24">String</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.6 <a 
href="#x1-250004.3.6" id="QQ2-1-25">Regular expression and String distance</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.7 <a 
href="#x1-260004.3.7" id="QQ2-1-26">Date/time</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.8 <a 
href="#x1-270004.3.8" id="QQ2-1-27">Arrays</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.9 <a 
href="#x1-280004.3.9" id="QQ2-1-28">Masked Arrays</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.4 <a 
href="#x1-290004.4" id="QQ2-1-29">Table Columns</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.5 <a 
href="#x1-300004.5" id="QQ2-1-30">Table Keywords</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.6 <a 
href="#x1-310004.6" id="QQ2-1-31">Operators</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.7 <a 
href="#x1-320004.7" id="QQ2-1-32">Sets and intervals</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.8 <a 
href="#x1-330004.8" id="QQ2-1-33">Array Index Operator</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.9 <a 
href="#x1-340004.9" id="QQ2-1-34">Units</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.10 <a 
href="#x1-350004.10" id="QQ2-1-35">Functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.1 <a 
href="#x1-360004.10.1" id="QQ2-1-36">String functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.2 <a 
href="#x1-370004.10.2" id="QQ2-1-37">Regex functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.3 <a 
href="#x1-380004.10.3" id="QQ2-1-38">Date/time functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.4 <a 
href="#x1-390004.10.4" id="QQ2-1-39">Pretty printing functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.5 <a 
href="#x1-400004.10.5" id="QQ2-1-40">Comparison functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.6 <a 
href="#x1-410004.10.6" id="QQ2-1-41">Mathematical functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.7 <a 
href="#x1-420004.10.7" id="QQ2-1-42">Array to scalar reduction functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.8 <a 
href="#x1-430004.10.8" id="QQ2-1-43">Array to array reduction functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.9 <a 
href="#x1-440004.10.9" id="QQ2-1-44">Array downsampling functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.10 <a 
href="#x1-450004.10.10" id="QQ2-1-45">Array functions operating in running windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.11 <a 
href="#x1-460004.10.11" id="QQ2-1-46">Type conversion functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.12 <a 
href="#x1-470004.10.12" id="QQ2-1-47">Array creation functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.13 <a 
href="#x1-480004.10.13" id="QQ2-1-48">Miscellaneous functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.14 <a 
href="#x1-490004.10.14" id="QQ2-1-49">Cone search functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.15 <a 
href="#x1-500004.10.15" id="QQ2-1-50">User defined functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.16 <a 
href="#x1-510004.10.16" id="QQ2-1-51">Special MeasurementSet functions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.10.17 <a 
href="#x1-540004.10.17" id="QQ2-1-54">Special Measures functions</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.11 <a 
href="#x1-570004.11" id="QQ2-1-57">Subqueries</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-580005" id="QQ2-1-58">Some further remarks</a></span>
                                                                                         

                                                                                         
<br />   &#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-590005.1" id="QQ2-1-59">Joining tables</a></span>
<br />   &#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-600005.2" id="QQ2-1-60">Optimization</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-610006" id="QQ2-1-61">Modifying a table</a></span>
<br />   &#x00A0;<span class="subsectionToc" >6.1 <a 
href="#x1-620006.1" id="QQ2-1-62">UPDATE</a></span>
<br />   &#x00A0;<span class="subsectionToc" >6.2 <a 
href="#x1-630006.2" id="QQ2-1-63">INSERT</a></span>
<br />   &#x00A0;<span class="subsectionToc" >6.3 <a 
href="#x1-640006.3" id="QQ2-1-64">DELETE</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-650007" id="QQ2-1-65">Creating a new table</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-660008" id="QQ2-1-66">Counting in a table</a></span>
<br />   <span class="sectionToc" >9 <a 
href="#x1-670009" id="QQ2-1-67">Calculations on a table</a></span>
<br />   <span class="sectionToc" >10 <a 
href="#x1-6800010" id="QQ2-1-68">Examples</a></span>
<br />   &#x00A0;<span class="subsectionToc" >10.1 <a 
href="#x1-6900010.1" id="QQ2-1-69">Selection examples</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >10.1.1 <a 
href="#x1-7000010.1.1" id="QQ2-1-70">Reference table results</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >10.1.2 <a 
href="#x1-7100010.1.2" id="QQ2-1-71">Plain table results</a></span>
<br />   &#x00A0;<span class="subsectionToc" >10.2 <a 
href="#x1-7200010.2" id="QQ2-1-72">Modification examples</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >10.2.1 <a 
href="#x1-7300010.2.1" id="QQ2-1-73">Applying running median to an image</a></span>
<br />   &#x00A0;<span class="subsectionToc" >10.3 <a 
href="#x1-7400010.3" id="QQ2-1-74">Table creation examples</a></span>
<br />   &#x00A0;<span class="subsectionToc" >10.4 <a 
href="#x1-7500010.4" id="QQ2-1-75">Calculation examples</a></span>
<br />   <span class="sectionToc" >11 <a 
href="#x1-7600011" id="QQ2-1-76">Interface to TaQL</a></span>
<br />   &#x00A0;<span class="subsectionToc" >11.1 <a 
href="#x1-7700011.1" id="QQ2-1-77">Python interface <span 
class="cmtt-10x-x-109">pyrap</span></a></span>
<br />   &#x00A0;<span class="subsectionToc" >11.2 <a 
href="#x1-7800011.2" id="QQ2-1-78">Interface to Glish</a></span>
<br />   &#x00A0;<span class="subsectionToc" >11.3 <a 
href="#x1-7900011.3" id="QQ2-1-79">Program <span 
class="cmtt-10x-x-109">taql</span></a></span>
<br />   &#x00A0;<span class="subsectionToc" >11.4 <a 
href="#x1-8000011.4" id="QQ2-1-80">C++ interface</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >11.4.1 <a 
href="#x1-8100011.4.1" id="QQ2-1-81">TaQL query string</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >11.4.2 <a 
href="#x1-8200011.4.2" id="QQ2-1-82">Expression string</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >11.4.3 <a 
href="#x1-8300011.4.3" id="QQ2-1-83">Expression classes</a></span>
<br />   <span class="sectionToc" >12 <a 
href="#x1-8400012" id="QQ2-1-84">Writing user defined functions</a></span>
<br />   <span class="sectionToc" >13 <a 
href="#x1-8500013" id="QQ2-1-85">Possible future developments</a></span>
   </div>
                                                                                         

                                                                                         
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 5--><p class="noindent" >The Table Query Language (TaQL, rhymes with bagel (though some people pronounce it as tackle))
makes it possible to select rows from an arbitrary table based on the contents of its columns and
keywords. It supports arbitrary complex expressions including units, extended regular expressions, and
many functions. User defined functions written in C++ are also supported. TaQL also makes sorting and
column selection possible. Furthermore TaQL has commands to create a table and to modify data in a
table.
</p><!--l. 15--><p class="indent" >   TaQL is modeled after SQL and contains most of SQL&#8217;s functionality. Some familiarity with SQL
makes it easier to understand the TaQL syntax. The most important features of TaQL different from SQL
are: </p>
     <ul class="itemize1">
     <li class="itemize">The result of a SELECT is not ASCII output. Instead it always creates another table (either
     temporary or persistent). Usually this is a so-called reference table, but it is also possible to
     make a deep copy and create a plain table. <br 
class="newline" />A reference table is a table that can be used as any other table, but it does not contain data.
     Instead it contains references to the rows and columns in the original table. Thus modifying
     data in a reference table means that effectively the data in the original table are modified.
     </li>
     <li class="itemize">A very rich set of mathematical and other functions.
     </li>
     <li class="itemize">Any operand can be a scalar or an N-dimensional array. Many reduction functions can be
     applied to arrays.
     </li>
     <li class="itemize">Arrays can optionally be masked.
     </li>
     <li class="itemize">Full support of units and automatic conversion of units.
     </li>
     <li class="itemize">Support  of  various  types  of  patterns/regular  expressions  and  maximum  string  distances
     (Levensthein (aka Edit) distance).
     </li>
     <li class="itemize">Specific operators and functions for cone searching (i.e. spatial searching with a search radius).
     </li>
     <li class="itemize">An advanced way of specifying intervals.
     </li>
     <li class="itemize">No support of indices, thus a linear table search is done. Because data are stored column-wise,
     a linear search is usually very fast, even for very large tables.
     </li>
     <li class="itemize">Limited support for joins (only implicit joins on row number).
                                                                                         

                                                                                         
     </li>
     <li class="itemize">In the SELECT command GROUPBY and HAVING are not supported yet.
     </li>
     <li class="itemize">The COUNT command exists to count the occurrences of column values.
     </li>
     <li class="itemize">The CALC command exists to calculate an arbitrary expression (including subqueries) on
     a table. This can be useful to derive values from a table (e.g. the number of flags set in a
     measurement set). It can even be used as a desk calculator.
     </li>
     <li class="itemize">TaQL can be used from languages with different conventions, for example the order of array
     axes. Therefore it is possible to set the language style to be used.
     </li>
     <li class="itemize">The language can be extended by means of User Defined Functions. Some standard UDFs
     exist to deal with measure conversions (for directions, epochs, positions, and stokes).</li></ul>
<!--l. 57--><p class="noindent" >TaQL has a keyword that makes it possible to time the various parts of a TaQL command.
</p><!--l. 60--><p class="indent" >   The first sections of this document explain the syntax and show the options. The last sections show
the interface to TaQL using Python or C++. The Python interface makes it possible to embed Python
variables and expressions in a TaQL command.
</p><!--l. 65--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>TaQL Commands</h3>
<!--l. 66--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Command summary</h4>
<!--l. 67--><p class="noindent" >TaQL contains six commands. In the commands shown below the square brackets are not part of the
syntax, but indicate the optional parts of the commands.
</p>
     <ul class="itemize1">
     <li class="itemize">selection
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-1">
     &#x00A0;&#x00A0;SELECT&#x00A0;[[DISTINCT]&#x00A0;column_list]&#x00A0;[INTO&#x00A0;table&#x00A0;[AS&#x00A0;type]]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;table_list&#x00A0;[WHERE&#x00A0;expression]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[ORDERBY&#x00A0;[DISTINCT]&#x00A0;sort_list]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[LIMIT&#x00A0;expression]&#x00A0;[OFFSET&#x00A0;expression]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[GIVING&#x00A0;table&#x00A0;[AS&#x00A0;type]&#x00A0;|&#x00A0;set]
</div>
     <!--l. 79--><p class="nopar" > It can be used to get an optionally sorted subset from a table. It can also be used to do a subquery
     (see <a 
href="#x1-570004.11">section 4.11</a> for more information on subqueries).
     </p></li>
     <li class="itemize">updating
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-2">
     &#x00A0;&#x00A0;UPDATE&#x00A0;table_list&#x00A0;SET&#x00A0;update_list&#x00A0;[FROM&#x00A0;table_list]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[WHERE&#x00A0;...]&#x00A0;[ORDERBY&#x00A0;...]&#x00A0;[LIMIT&#x00A0;...]&#x00A0;[OFFSET&#x00A0;...]
</div>
     <!--l. 88--><p class="nopar" > It can be used to update data in (a subset of) the first table in the table list.
     </p></li>
     <li class="itemize">addition
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-3">
     &#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;table_list&#x00A0;[(column_list)]&#x00A0;VALUES&#x00A0;(expr_list)
     &#x00A0;<br />or
     &#x00A0;<br />&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;table_list&#x00A0;[(column_list)]&#x00A0;SELECT_command
</div>
     <!--l. 97--><p class="nopar" > It can be used to add and fill new rows in the first table in the table list.
     </p></li>
     <li class="itemize">deletion
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-4">
     &#x00A0;&#x00A0;DELETE&#x00A0;FROM&#x00A0;table_list
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[WHERE&#x00A0;...]&#x00A0;[ORDERBY&#x00A0;...]&#x00A0;[LIMIT&#x00A0;...]&#x00A0;[OFFSET&#x00A0;...]
</div>
     <!--l. 105--><p class="nopar" > It can be used to delete some or all rows from the first table in the table list.
     </p></li>
     <li class="itemize">counting
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-5">
     &#x00A0;&#x00A0;COUNT&#x00A0;[column_list]&#x00A0;FROM&#x00A0;table_list&#x00A0;[WHERE&#x00A0;...]
</div>
     <!--l. 112--><p class="nopar" > It can be used to count occurrences of column values. It is similar to the GROUPBY clause in SQL
     which is not impemented yet.
     </p></li>
     <li class="itemize">calculation
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-6">
     &#x00A0;&#x00A0;CALC&#x00A0;expression&#x00A0;[FROM&#x00A0;table_list]
</div>
     <!--l. 119--><p class="nopar" > It can be used to calculate an expression, in which columns in a table can be used.
     </p></li>
     <li class="itemize">table creation
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-7">
     &#x00A0;&#x00A0;CREATE&#x00A0;TABLE&#x00A0;table&#x00A0;[column_spec]&#x00A0;[DMINFO&#x00A0;datamanager_list]
</div>
     <!--l. 126--><p class="nopar" > It can be used to create a new table with the given columns. Optionally specific data manager info
     can be given.
</p>
     </li></ul>
<!--l. 131--><p class="noindent" >The commands and verbs in the commands are case-insensitive, but case is important in string values
and in names of columns and keywords. Whitespace (blanks and tabs) can be used at will.
<br 
class="newline" /><a 
href="#x1-610006">Section 6 (Modifying a table)</a> explains the UPDATE, INSERT, and DELETE commands in
more detail. The CREATE TABLE command is explained in <a 
href="#x1-650007">section 7 (Creating a table)</a>.
<br 
class="newline" /><a 
href="#x1-660008">Section 8 (Counting in a table)</a> explains the COUNT command in more detail. <br 
class="newline" /><a 
href="#x1-670009">Section 9 (Calculations on a table)</a> explains the CALC command in more detail.
</p><!--l. 143--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Using a style</h4>
<!--l. 144--><p class="noindent" >TaQL can be used from different languages, in particular Python and Glish. Each has its own conventions
breaking down into three important categories: </p>
     <ul class="itemize1">
     <li class="itemize">0-based or 1-based indexing.
     </li>
     <li class="itemize">Fortran-order or C-order of arrays.
     </li>
     <li class="itemize">Inclusive or exclusive end in <span 
class="cmtt-10x-x-109">start:end </span>ranges.</li></ul>
<!--l. 152--><p class="noindent" >The user can set the style (convention) to be used by preceeding a TaQL statement with
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-8">
&#x00A0;&#x00A0;USING&#x00A0;STYLE&#x00A0;value,&#x00A0;value,&#x00A0;...
</div>
<!--l. 156--><p class="nopar" > The possible (case-independent) values are: </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10x-x-109">BASE0 </span>or <span 
class="cmtt-10x-x-109">BASE1 </span>telling the indexing style.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">ENDEXCL </span>or <span 
class="cmtt-10x-x-109">ENDINCL </span>telling the range style.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">CORDER </span>or <span 
class="cmtt-10x-x-109">FORTRANORDER </span>telling the array style.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">PYTHON </span>which is equivalent to <span 
class="cmtt-10x-x-109">BASE0,ENDEXCL,CORDER</span>
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">GLISH </span>which is equivalent to <span 
class="cmtt-10x-x-109">BASE1,ENDINCL,FORTRANORDER</span></li></ul>
<!--l. 165--><p class="noindent" >If multiple values are given for a category, the last one will be used. The default style used is <span 
class="cmtt-10x-x-109">GLISH</span>, which is
the way TaQL always worked before this feature was introduced.
</p><!--l. 169--><p class="indent" >   It is important to note that the interpretation of the axes numbers depends on the style being used.
E.g. when using glish style, axes numbers are 1-based and in Fortran order, thus axis 1 is the
most rapidly varying axis. When using python style, axis 0 is the most slowly varying axis.
<br 
class="newline" />Casacore arrays are in Fortran order, but TaQL maps it to the style being used. Thus when using python
style, the axes will be reversed (data will not be transposed).
</p><!--l. 177--><p class="indent" >   The style feature has to be used with care. A given TaQL statement will behave differently when used
with another style.
</p><!--l. 180--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-60002.3"></a>Timing</h4>
<!--l. 181--><p class="noindent" >It is possible to time a TaQL command by giving the case-insensitive keyword <span 
class="cmtt-10x-x-109">TIME </span>after the optional
style keywords described above. If given, the total execution time and the times needed for various parts
of the TaQL command will be shown on stdout. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-9">
time&#x00A0;select&#x00A0;distinct&#x00A0;ANTENNA1,ANTENNA2
&#x00A0;<br />from&#x00A0;~/3C343.MS&#x00A0;where&#x00A0;any(FLAG)&#8217;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;Where&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.87&#x00A0;real&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.16&#x00A0;user&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.69&#x00A0;system
&#x00A0;<br />&#x00A0;&#x00A0;Projection&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;real&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;user&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;system
&#x00A0;<br />&#x00A0;&#x00A0;Distinct&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.18&#x00A0;real&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.16&#x00A0;user&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.03&#x00A0;system
&#x00A0;<br />&#x00A0;Total&#x00A0;time&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3.07&#x00A0;real&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.33&#x00A0;user&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.72&#x00A0;system
</div>
<!--l. 193--><p class="nopar" > shows the time to do the where part (i.e. row selection on FLAG), projection (selection of columns), and
distinct (unique column values).
</p><!--l. 197--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-70002.4"></a>Reserved words</h4>
<!--l. 198--><p class="noindent" >TaQL uses the following words as part of its language.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-10">
&#x00A0;&#x00A0;ALL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AND&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AS&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ASC
&#x00A0;<br />&#x00A0;&#x00A0;BETWEEN
&#x00A0;<br />&#x00A0;&#x00A0;CALC&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;CREATETABLE
&#x00A0;<br />&#x00A0;&#x00A0;DELETE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DESC&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DISTINCT&#x00A0;&#x00A0;DMINFO
&#x00A0;<br />&#x00A0;&#x00A0;EXCEPT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;EXISTS
&#x00A0;<br />&#x00A0;&#x00A0;F&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FALSE&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM
&#x00A0;<br />&#x00A0;&#x00A0;GIVING&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;GROUPBY
&#x00A0;<br />&#x00A0;&#x00A0;HAVING
&#x00A0;<br />&#x00A0;&#x00A0;IN&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;INCONE&#x00A0;&#x00A0;&#x00A0;INSERT&#x00A0;&#x00A0;&#x00A0;&#x00A0;INTERSECT&#x00A0;&#x00A0;INTO
&#x00A0;<br />&#x00A0;&#x00A0;JOIN
&#x00A0;<br />&#x00A0;&#x00A0;LIKE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;LIMIT
&#x00A0;<br />&#x00A0;&#x00A0;MINUS
&#x00A0;<br />&#x00A0;&#x00A0;NODUPLICATES&#x00A0;&#x00A0;NOT
&#x00A0;<br />&#x00A0;&#x00A0;OFFSET&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ON&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ORDERBY
&#x00A0;<br />&#x00A0;&#x00A0;SAVETO&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SELECT&#x00A0;&#x00A0;&#x00A0;SET
&#x00A0;<br />&#x00A0;&#x00A0;T&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TRUE
&#x00A0;<br />&#x00A0;&#x00A0;UNION&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UNIQUE&#x00A0;&#x00A0;&#x00A0;UPDATE&#x00A0;&#x00A0;&#x00A0;&#x00A0;USINGSTYLE
&#x00A0;<br />&#x00A0;&#x00A0;VALUES
&#x00A0;<br />&#x00A0;&#x00A0;WHERE
&#x00A0;<br />&#x00A0;&#x00A0;XOR
</div>
<!--l. 220--><p class="nopar" > These words are reserved. Note that the words in the TaQL vocabulary are case insensitive, thus the
lowercase (or any mixed case) versions are also reserved.
</p><!--l. 225--><p class="indent" >   The reserved words cannot directly be used as <a 
href="#x1-290004.4">column name</a>, <a 
href="#x1-300004.5">keyword name</a>, or <a 
href="#x1-340004.9">unit</a>. However, a
reserved word can be used by escaping it with a backslash like <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">AS</span>. When reading further, the meaning
of
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-11">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;\IN&#x00A0;&#x00A0;\in&#x00A0;&#x00A0;IN&#x00A0;[3mm,4mm]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;column&#x00A0;unit&#x00A0;IN&#x00A0;&#x00A0;&#x00A0;&#x00A0;set
</div>
<!--l. 234--><p class="nopar" > might come clear. It means: use unit <span 
class="cmtt-10x-x-109">in </span>(inch) for column <span 
class="cmtt-10x-x-109">IN </span>and test if it is in the given set.
<br 
class="newline" />Note this is unlike SQL where quotes have to be used to use a reserved word as a column
name.
</p><!--l. 240--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-80003"></a>Selection from a table</h3>
<!--l. 241--><p class="noindent" >The SELECT is the main TaQL command. It can be used to select a subset of rows and/or columns from
a table or to generate new columns based on expressions.
</p><!--l. 245--><p class="indent" >   As explained above, the result of a selection is usually a reference table. This table can be used as any
other table, thus it is possible to do another selection on it or to update it (which updates the underlying
original table). It is, however, not possible to insert rows in a reference table or to delete rows from
it.
</p><!--l. 251--><p class="indent" >   If the select column list contains expressions, it is not possible to generate a reference table. Instead a
normal plain table is generated (which can take some time if it contains large data arrays). It should be
clear that updating such a table does not update the original table.
</p><!--l. 257--><p class="indent" >   The various parts of the SELECT command are explained in the following sections. <br 
class="newline" />Although the clauses column_list, WHERE, ORDERBY, LIMIT, and OFFSET are optional, at least one
of them has to be used. Otherwise no operation is performed on the primary table (which
makes no sense). Note that the GIVING clause with a value set is seen as an operation as
well.
</p><!--l. 266--><p class="indent" >   There is no explicit JOIN clause, but it is possible to equi-join tables on row number. Such tables have
to have the same number of rows. <br 
class="newline" />One can also join , for example, the main table of a MeasurementSet with a subtable like the ANTENNA
table using a <a 
href="#x1-570004.11">subquery</a>. <br 
class="newline" />Joins are explained further in <a 
href="#x1-590005.1">section 5</a>.
</p><!--l. 274--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-90003.1"></a>SELECT column_list</h4>
<!--l. 275--><p class="noindent" >Columns to be selected can be given as a comma-separated list with names of columns that have to be
selected from the primary table in the table_list (see below). If no column_list is given, all
columns will be selected. It results in a so-called reference table. Optionally a selected column
can be given another name in the reference table using <span 
class="cmtt-10x-x-109">AS name </span>(where AS is optional). For
example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-12">
&#x00A0;&#x00A0;select&#x00A0;TIME,ANTENNA1,ANTENNA2,DATA&#x00A0;from&#x00A0;3C343.MS
&#x00A0;<br />&#x00A0;&#x00A0;select&#x00A0;TIME,ANTENNA1,ANTENNA2,MODEL_DATA&#x00A0;AS&#x00A0;DATA&#x00A0;from&#x00A0;3C343.MS
</div>
<!--l. 286--><p class="nopar" > It is possible to change the data type of a column by specifying a data type (see below) after the new
column name. Giving a data type (even if the same as the existing one) counts as an expression, thus
results in the generation of a plain table. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-13">
&#x00A0;&#x00A0;select&#x00A0;MODEL_DATA&#x00A0;AS&#x00A0;DATA&#x00A0;FCOMPLEX&#x00A0;from&#x00A0;3C343.MS
</div>
<!--l. 294--><p class="nopar" >
</p><!--l. 296--><p class="indent" >   Apart from giving exact column names, it is also possible to use wildcards by means of a UNIX
filename-like pattern (like <span 
class="cmtt-10x-x-109">p/pattern/</span>) or a regular expression (like <span 
class="cmtt-10x-x-109">f/regex/ </span>for a full match or
<span 
class="cmtt-10x-x-109">m/regex/ </span>for a partial match). They can be suffixed with an <span 
class="cmtt-10x-x-109">i </span>indicating case-insensitive matching. See
<a 
href="#x1-250004.3.6">section 4.3.6</a> for a discussion of these constants. The operator <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~</span></span></span> needs to be given before the pattern
or regex to indicate that columns have to be included. Thereafter operator <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">!~</span></span></span> can be used
with another pattern or regex to remove columns. Such an excluding pattern or regex only
removes columns from the wildcarded columns before it until the latest non-wildcarded column.
<br 
class="newline" />A special pattern is * (which is the same as <span 
class="cmtt-10x-x-109">&#x00A0;p/*/</span>). For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-14">
&#x00A0;&#x00A0;select&#x00A0;*,&#x00A0;!~p/*_DATA/&#x00A0;from&#x00A0;3C343.MS
</div>
<!--l. 311--><p class="nopar" > selects all columns except the ones ending in <span 
class="cmtt-10x-x-109">_DATA</span>.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-15">
&#x00A0;&#x00A0;select&#x00A0;~m/DATA/,&#x00A0;!~p/*_DATA/&#x00A0;from&#x00A0;3C343.MS
</div>
<!--l. 315--><p class="nopar" > selects columns with a name containing <span 
class="cmtt-10x-x-109">DATA </span>except the ones ending in <span 
class="cmtt-10x-x-109">_DATA</span>.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-16">
&#x00A0;&#x00A0;select&#x00A0;CORRECTED_DATA,&#x00A0;*,&#x00A0;!~p/*_DATA/&#x00A0;from&#x00A0;3C343.MS
&#x00A0;<br />or
&#x00A0;<br />&#x00A0;&#x00A0;select&#x00A0;*,&#x00A0;!~p/*_DATA/,&#x00A0;CORRECTED_DATA&#x00A0;from&#x00A0;3C343.MS
</div>
<!--l. 322--><p class="nopar" > does select the <span 
class="cmtt-10x-x-109">CORRECTED</span><span 
class="cmtt-10x-x-109">_DATA </span>column. <br 
class="newline" />Note it is not possible to change the name or data type of wildcarded columns.
</p><!--l. 327--><p class="indent" >   It is also possible to use expressions in the column list to create new columns based on the contents of
other columns. When doing this, the resulting table is a plain table (because a reference table cannot
contain expressions). The new column can be given a name by giving <span 
class="cmtt-10x-x-109">AS name </span>after the expression (where
AS is optional). If no name is given, a unique name like <span 
class="cmtt-10x-x-109">Col</span><span 
class="cmtt-10x-x-109">_1 </span>is constructed. After the name a <a 
href="#x1-170004.1">data type
string</a> can be given for the new column. If no data type is given, the expression data type is
used.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-17">
&#x00A0;&#x00A0;select&#x00A0;max(ANTENNA1,ANTENNA2)&#x00A0;AS&#x00A0;ANTENNA&#x00A0;INT&#x00A0;from&#x00A0;3C343
&#x00A0;<br />&#x00A0;&#x00A0;select&#x00A0;means(DATA,1)&#x00A0;from&#x00A0;3C343
</div>
<!--l. 340--><p class="nopar" > Note that unit conversion can be (part of) an expression. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-18">
&#x00A0;&#x00A0;select&#x00A0;TIME&#x00A0;d&#x00A0;AS&#x00A0;TIMEH&#x00A0;from&#x00A0;my.ms
</div>
<!--l. 344--><p class="nopar" > to store the time in unit <span 
class="cmtt-10x-x-109">d </span>(days). Units are discussed in <a 
href="#x1-340004.9">section 4.9</a>.
</p><!--l. 348--><p class="indent" >   Note that for subqueries the GIVING clause offers a better (faster) way of specifying a result
expression. It also makes it possible to use intervals.
</p><!--l. 352--><p class="indent" >   If a column_list is given and if all columns are scalars, the column_list can be preceeded by the word
DISTINCT. It means that the result is made unique by removing the rows with duplicate values in the
columns of the column_list. Instead of DISTINCT the synonym NODUPLICATES or UNIQUE can also
be used. To find duplicate values, some temporary sorting is done, but the original order of the remaining
rows is not changed. <br 
class="newline" />Note that support of this keyword is mainly done for SQL compliance. The same (and more) can be
achieved with the DISTINCT keyword in the <a 
href="#x1-130003.5">ORDERBY</a> clause with the difference that ORDERBY
DISTINCT will change the order. <br 
class="newline" />For full SQL compliance it is also possible to give the keyword ALL which is the opposite of DISTINCT,
thus all values are returned. This is the default. Because there is an ambiguity between the keyword ALL
and function ALL, the first element of the column list cannot be an expression starting with a parenthesis
if the keyword ALL is used.
</p><!--l. 371--><p class="noindent" ><span 
class="cmbx-12">[</span>
AS type]]</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-100003.2"></a>INTO [table] [AS type]</h4>
<!--l. 372--><p class="noindent" >This indicates that the ultimate result of the SELECT command should be written to a table (with the
given name). This table can be a reference table, a plain table, or a memory table.
</p><!--l. 376--><p class="indent" >   The table argument gives the name of the resulting table. It can be omitted if a memory table is
created.
</p><!--l. 379--><p class="indent" >   The type argument is optional and can be one of several values:
     </p><dl class="description"><dt class="description">
<span 
class="cmbx-10x-x-109">MEMORY</span>  </dt><dd 
class="description">to store the result in a memory table.
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">SCRATCH</span>  </dt><dd 
class="description">to store the result in a scratch table, possibly on disk.
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">PLAIN</span>  </dt><dd 
class="description">to store the result in a plain table. Its endian format is determined by the aipsrc definition.
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">PLAIN</span><span 
class="cmbx-10x-x-109">_BIG</span>  </dt><dd 
class="description">to store the result in a plain table in big-endian format.
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">PLAIN</span><span 
class="cmbx-10x-x-109">_LITTLE</span>  </dt><dd 
class="description">to store the result in a plain table in little-endian format.
                                                                                         

                                                                                         
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">PLAIN</span><span 
class="cmbx-10x-x-109">_LOCAL</span>  </dt><dd 
class="description">to store the result in a plain table in native endian format.</dd></dl>
<!--l. 389--><p class="noindent" >If type is not given, the result will be written in a reference table. However, if expressions are given in the
column list of a projection, the result is written in a plain table. <br 
class="newline" />The standard TaQL way to define the output table is the <a 
href="#x1-150003.7">GIVING</a> clause. INTO is available for SQL
compliance.
</p><!--l. 396--><p class="indent" >   If the INTO (or GIVING) clause is not given, the query result will be written into a memory table. In
this way queries done in a readonly directory will not fail because it cannot create a result table. However,
if the result is expected to not fit in memory (which will seldomly be the case), type SCRATCH should be
used to make it fit.
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-110003.3"></a>FROM table_list</h4>
<!--l. 404--><p class="noindent" >The FROM part defines which tables are used in the selection. It is a comma-separated list of table names
which can contain path specification and environment variables or the UNIX <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~</span></span></span> notation. If the tablename
contains a special character, the character can be escaped with a backslash or the table name can be
enclosed in single or double quotes. <br 
class="newline" />The first table in the list is the primary table and is used for all columns in the other clauses. Usually only
one table is used in which case the list consists of only one table name. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-19">
&#x00A0;&#x00A0;SELECT&#x00A0;col1,col2&#x00A0;FROM&#x00A0;mytable
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;col1&#x003E;col2
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;ORDERBY&#x00A0;col1
</div>
<!--l. 418--><p class="nopar" > In this example columns <span 
class="cmtt-10x-x-109">col1 </span>and <span 
class="cmtt-10x-x-109">col2 </span>are taken from <span 
class="cmtt-10x-x-109">mytable</span>.
</p><!--l. 422--><p class="indent" >   However, it is very well possible to specify more tables in the table_list to execute a <a 
href="#x1-590005.1">join</a> or to get a
keyword value from another table. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-20">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable,othertable
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;col1&#x003E;othertable.key
</div>
<!--l. 429--><p class="nopar" > As shown in the example above a qualifying name (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">othertable.</span></span></span>) can be used in the WHERE clause to
specify from which table a keyword has to be taken. If no qualifying name is given, the keyword (or
column) is taken from the primary table (i.e., the first table in the table_list). This means that qualifying
names are only needed in special cases. The qualifying name can not contain special characters
like a slash. Therefore a table_name needs an explicit shorthand alias if it contains special
characters.
</p><!--l. 440--><p class="indent" >   Multiple table lists can also be used to join the tables on row number. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-21">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;t1,othertable&#x00A0;t2
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;not&#x00A0;all(near(t1.data,&#x00A0;t2.data))
</div>
<!--l. 445--><p class="nopar" > Such a command could be used to check if the data in mytable is about equal to the data in othertable. It
checks if both tables have the same number of rows.
</p><!--l. 450--><p class="indent" >   The full table_list syntax is: <br 
class="newline" /><span 
class="cmtt-10x-x-109">table</span><span 
class="cmtt-10x-x-109">_name1 [shorthand1], table</span><span 
class="cmtt-10x-x-109">_name2 [shorthand2], etc. </span><br 
class="newline" />The shorthand defaults to the table_name. A shorthand (alias) is needed if the table name contains
non-alphanumeric characters. In the following example shorthand <span 
class="cmtt-10x-x-109">my </span>is not really needed. Shorthand
<span 
class="cmtt-10x-x-109">other </span>is needed though.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-22">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;my,&#x00A0;~user/othertable&#x00A0;other
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;my.col1&#x003E;other.key
</div>
<!--l. 460--><p class="nopar" > Similar to SQL and OQL the shorthand can also be given using <span 
class="cmtt-10x-x-109">AS </span>or <span 
class="cmtt-10x-x-109">IN</span>. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-23">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;AS&#x00A0;my,&#x00A0;other&#x00A0;IN&#x00A0;~user/othertable
</div>
<!--l. 465--><p class="nopar" > Note that if using <span 
class="cmtt-10x-x-109">IN</span>, the shorthand has to preceed the table name. It can be seen as an iterator
variable.
</p><!--l. 469--><p class="indent" >   There are four special ways to specify a table:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-11002x1">A table name can be taken from a keyword in a previously specified table. This can be useful in a
     <a 
href="#x1-570004.11">subquery</a>. The syntax for this is the same as that for specifying <a 
href="#x1-300004.5">keywords</a> in an expression.
     E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-24">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;tab
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;col1&#x00A0;IN&#x00A0;[SELECT&#x00A0;subcol&#x00A0;FROM&#x00A0;tab.col2::key]
</div>
     <!--l. 481--><p class="nopar" > In this example <span 
class="cmtt-10x-x-109">key </span>is a table keyword of column <span 
class="cmtt-10x-x-109">col2 </span>in table <span 
class="cmtt-10x-x-109">mytable </span>(note that <span 
class="cmtt-10x-x-109">tab </span>is the
     shorthand for <span 
class="cmtt-10x-x-109">mytable </span>and could be left out). <br 
class="newline" />It can also be used for another table in the main query. E.g.
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-25">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable,&#x00A0;::key&#x00A0;subtab
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;col1&#x00A0;&#x003E;&#x00A0;subtab.key1
</div>
     <!--l. 489--><p class="nopar" > In this example the keyword <span 
class="cmtt-10x-x-109">key1 </span>is taken from the subtable given by the table keyword <span 
class="cmtt-10x-x-109">key </span>in the
     main table. <br 
class="newline" />If a keyword is used as the table name, the keyword is searched in one of the tables
     previously given. The search starts at the current query level and proceeds outwards (i.e.,
     up to the main query level). If a shorthand is given, only tables with that shorthand
     are taken into account. If no shorthand is given, only primary tables are taken into
     account.
     </p></li>
     <li 
  class="enumerate" id="x1-11004x2">Opening a subtable using a path name like <span 
class="cmtt-10x-x-109">my.ms/ANTENNA </span>will fail if <span 
class="cmtt-10x-x-109">my.ms </span>is a reference table
     instead of the original table. Therefore the path of a subtable can be given using colons instead of
     slashes like <span 
class="cmtt-10x-x-109">my.ms::ANTENNA </span>which is a slight extension of specifying table names in the previous
     bullet. <br 
class="newline" />In this way a subtable can always be found, no matter where it is located.
     </li>
     <li 
  class="enumerate" id="x1-11006x3">Like in OQL it is possible to use a <a 
href="#x1-570004.11">nested query</a> command in the FROM clause. This is a normal
     query command enclosed in square brackets or parentheses. Besides the SELECT command the
     COUNT command can also be used. It results in a temporary table which can thereafter be used as
     a table in the rest of the query command. A shorthand has to be defined for it in order to be able to
     refer to that table. <br 
class="newline" />Use of a query in the FROM command can be useful to avoid multiple equal subqueries.
     E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-26">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;MS,
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;from&#x00A0;MS&#x00A0;where&#x00A0;sumsqr(UVW[1:2])&#x00A0;&#x003C;&#x00A0;625]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;as&#x00A0;TIMESEL
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;where&#x00A0;TIME&#x00A0;in&#x00A0;[select&#x00A0;distinct&#x00A0;TIME&#x00A0;from&#x00A0;TIMESEL]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;&amp;&#x00A0;&#x00A0;any([ANTENNA1,ANTENNA2]&#x00A0;in
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;from&#x00A0;TIMESEL&#x00A0;giving
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[iif(UVW[3]&#x00A0;&#x003C;&#x00A0;0,&#x00A0;ANTENNA1,&#x00A0;ANTENNA2)]])
</div>
     <!--l. 530--><p class="nopar" > is a command to find shadowed antennas for the VLA. Without the query in the FROM command
     the subqueries in the remainder of the command would have been more complex. Furthermore, it
     would have been necessary to execute that select twice. <br 
class="newline" />The command is quite complex and cannot be fully understood before reading the rest of this note.
     Note, however, that the command uses the shorthand <span 
class="cmtt-10x-x-109">TIMESEL </span>to be able to use the temporary table
     in the subqueries.
     </p></li>
     <li 
  class="enumerate" id="x1-11008x4">Normally only persistent tables (i.e. tables on disk) can be used. However, it is also possible to use
     transient tables in a TaQL command given in <a 
href="#x1-7600011">Python, Glish, or C++</a>. This is done by passing one
     or more table objects to the function executing the TaQL command. In the TaQL command a $-sign
     followed by a sequence number has to be given to indicate the correct object containing the
     transient table. E.g. if two table objects are passed $1 indicates the first table, while $2 indicates the
     second one.</li></ol>
<!--l. 555--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-120003.4"></a>WHERE expression</h4>
<!--l. 556--><p class="noindent" >It defines the selection expression which must have a boolean scalar result. A row in the primary table is
selected if the expression is true for the values in that row. The syntax of the expression is explained in a
<a 
href="#x1-160004">section 4</a>.
</p><!--l. 562--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-130003.5"></a>ORDERBY sort_list</h4>
<!--l. 563--><p class="noindent" >It defines the order in which the result of the selection has to be sorted. The sort_list is a comma
separated list of expressions. <br 
class="newline" />The sort_list can be preceeded by the word <span 
class="cmtt-10x-x-109">ASC </span>or <span 
class="cmtt-10x-x-109">DESC </span>indicating if the given expressions are by default
sorted in ascending or descending order (default is ASC). Each expression in the sort_list can
optionally be followed by <span 
class="cmtt-10x-x-109">ASC </span>or <span 
class="cmtt-10x-x-109">DESC </span>to override the default order for that particular sort key.
                                                                                         

                                                                                         
<br 
class="newline" />To be compliant with SQL whitespace can be used between the words ORDER and BY.
</p><!--l. 575--><p class="indent" >   The word ORDERBY can optionally be followed by DISTINCT which means that only the first row of
multiple rows with equal sort keys is kept in the result. To be compliant with SQL dialects the word
UNIQUE or NODUPLICATES can be used instead of DISTINCT.
</p><!--l. 581--><p class="indent" >   An expression can be a scalar column or a single element from an array column. In these cases some
optimization is performed by reading the entire column directly. <br 
class="newline" />It can also be an arbitrarily complex expression with exactly the same syntax rules as the expressions in
the <a 
href="#x1-160004">WHERE</a> clause. The resulting data type of the expression must be a standard scalar one, thus
it cannot be a Regex or DateTime (see <a 
href="#x1-170004.1">below</a> for a discussion of the available data types).
E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-27">
&#x00A0;&#x00A0;ORDERBY&#x00A0;col1,&#x00A0;col2,&#x00A0;col3
&#x00A0;<br />&#x00A0;&#x00A0;ORDERBY&#x00A0;DESC&#x00A0;col1,&#x00A0;col2&#x00A0;ASC,&#x00A0;col3
&#x00A0;<br />&#x00A0;&#x00A0;ORDERBY&#x00A0;NODUPLICATES&#x00A0;uvw[1]&#x00A0;DESC
&#x00A0;<br />&#x00A0;&#x00A0;ORDERBY&#x00A0;square(uvw[1])&#x00A0;+&#x00A0;square(uvw[2])
&#x00A0;<br />&#x00A0;&#x00A0;ORDERBY&#x00A0;datetime(col)&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;incorrect&#x00A0;data&#x00A0;type
&#x00A0;<br />&#x00A0;&#x00A0;ORDERBY&#x00A0;mjd(datetime(col))&#x00A0;is&#x00A0;correct
</div>
<!--l. 599--><p class="nopar" >
</p><!--l. 601--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.6   </span> <a 
 id="x1-140003.6"></a>LIMIT/OFFSET expression</h4>
<!--l. 602--><p class="noindent" >It indicates which of the matching and sorted rows should be selected. If not given, all of them are
selected. <br 
class="newline" /><span 
class="cmtt-10x-x-109">LIMIT </span>and <span 
class="cmtt-10x-x-109">OFFSET </span>are applied after <span 
class="cmtt-10x-x-109">ORDERBY </span>and <span 
class="cmtt-10x-x-109">SELECT DISTINCT</span>, so they are particularly useful in
combination with those clauses to select, for example, the highest 10 values.
</p><!--l. 609--><p class="indent" >   It can be given in two ways: </p>
     <ul class="itemize1">
     <li class="itemize">In the semi-standard SQL way using <span 
class="cmtt-10x-x-109">LIMIT N </span>to select N rows and/or <span 
class="cmtt-10x-x-109">OFFSET M </span>to skip the
     first M rows. Similar to Python, N and M can be negative meaning they are counted from
     the end. E.g., <span 
class="cmtt-10x-x-109">LIMIT -1 </span>means all rows but the last.
     </li>
     <li class="itemize">As a Python-style range using <span 
class="cmtt-10x-x-109">LIMIT start:end:incr</span>, where the end is exclusive. Start
     defaults to 0, end to the number of rows, and incr to 1. As above, start and end can be
     negative to count from the end. The increment must be positive.</li></ul>
<!--l. 620--><p class="noindent" >For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-28">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;my.tab&#x00A0;ORDERBY&#x00A0;DISTINCT&#x00A0;TIME&#x00A0;LIMIT&#x00A0;2&#x00A0;OFFSET&#x00A0;10
&#x00A0;<br />&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;my.tab&#x00A0;ORDERBY&#x00A0;DISTINCT&#x00A0;TIME&#x00A0;LIMIT&#x00A0;10:12
</div>
<!--l. 624--><p class="nopar" > sorts uniquely by time, skips the first 10 rows, and selects the next two rows.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-29">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;my.tab&#x00A0;LIMIT&#x00A0;::100
</div>
<!--l. 629--><p class="nopar" > selects every 100-th row.
</p><!--l. 632--><p class="noindent" ><span 
class="cmbx-12">[</span>
AS type] <!--l. 632--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo></math>
set]</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7   </span> <a 
 id="x1-150003.7"></a>GIVING [table] [AS type] <!--l. 632--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo></math>
set</h4>
<!--l. 633--><p class="noindent" >It indicates that the ultimate result of the SELECT command should be written to a table (with the given
name). <br 
class="newline" />Another (more SQL compliant) way to define the output table is the <a 
href="#x1-100003.2">INTO</a> clause. See <a 
href="#x1-100003.2">INTO</a> for a more
detailed description including the possible types.
</p><!--l. 639--><p class="indent" >   It is also possible to specify a set in the GIVING clause instead of a table name. This is very
useful if the result of a <a 
href="#x1-570004.11">subquery</a> is used in the main query. Such a <a 
href="#x1-320004.7">set</a> can contain multiple
elements Each element can be a single value, range and/or interval as long as all elements
have the same data type. The parts of each element have to be expressions resulting in a
scalar.
</p><!--l. 647--><p class="indent" >   In the main query and in a query in the FROM command the GIVING clause can only result in a
table and not in a set. <br 
class="newline" />To be compliant with SQL dialects, the word SAVETO can be used instead of GIVING. Whitespace can
be given between SAVE and TO.
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-160004"></a>Expressions</h3>
<!--l. 654--><p class="noindent" >An expression is the basic building block of TaQL. They similar to expressions in other languages. An
expression is formed by applying an operator or a function to operands which can be a table column or
keyword, a constant, or a subexpression. An operand can be a scalar value or an array or set of various
data types. The next subsections discuss them in detail.
</p><!--l. 661--><p class="indent" >   An expression can be used in several places: </p>
     <ul class="itemize1">
     <li class="itemize">In the WHERE clause where the result must be a boolan scalar value. It tells if a table row
     will be selected.
     </li>
     <li class="itemize">As a sort key in the ORDERBY clause where the result must be a scalar value (numeric,
     bool, or string)
                                                                                         

                                                                                         
     </li>
     <li class="itemize">As an element in the set in the GIVING clause. It must be a scalar value of any type except
     regex.
     </li>
     <li class="itemize">As a scalar or array value in the INSERT and UPDATE command.
     </li>
     <li class="itemize">As a column expression in column-list part of the SELECT command. The result can be a
     scalar or array value.
     </li>
     <li class="itemize">As a scalar or array value in the CALC command.</li></ul>
<!--l. 675--><p class="indent" >   The expression in the clause can be as complex as one likes using <a 
href="#x1-310004.6">arithmetic, comparison,
and logical operators</a>, <a 
href="#x1-350004.10">functions</a>, and <a 
href="#x1-340004.9">units</a>. Parentheses can be used to group subexpressions.
<br 
class="newline" />The operands in an expression can be <a 
href="#x1-290004.4">table columns</a>, <a 
href="#x1-300004.5">table keywords</a>, <a 
href="#x1-190004.3">constants</a>, <a 
href="#x1-340004.9">units</a>, <a 
href="#x1-350004.10">functions</a>, <a 
href="#x1-320004.7">sets and
intervals</a>, and <a 
href="#x1-570004.11">subqueries</a>. <br 
class="newline" />The <a 
href="#x1-330004.8">index operator</a> can be used to take a single element or a subsection from an array expression.
<br 
class="newline" />E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-30">
&#x00A0;&#x00A0;column1&#x00A0;&#x003E;&#x00A0;10
&#x00A0;<br />&#x00A0;&#x00A0;column1&#x00A0;+&#x00A0;arraycolumn[index]&#x00A0;&#x003E;=&#x00A0;min&#x00A0;(column2,&#x00A0;column3)
&#x00A0;<br />&#x00A0;&#x00A0;column1&#x00A0;IN&#x00A0;[expr1&#x00A0;=:&#x003C;&#x00A0;expr2]
</div>
<!--l. 694--><p class="nopar" > The last example shows a <a 
href="#x1-320004.7">set</a> with a continuous interval.
</p><!--l. 697--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-170004.1"></a>Data Types</h4>
<!--l. 698--><p class="noindent" >Internally TaQL uses the following data types:
     </p><dl class="description"><dt class="description">
<span 
class="cmbx-10x-x-109">Bool</span>  </dt><dd 
class="description">logical values (true or T or false or F)
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">Integer</span>  </dt><dd 
class="description">integer numbers up to 64 bits
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">Double</span>  </dt><dd 
class="description">64 bit floating point numbers including times/positions
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">Complex</span>  </dt><dd 
class="description">128 bit complex numbers
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">String</span>  </dt><dd 
class="description">string values on which operator + can be used (concatenation).
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">Regex</span>  </dt><dd 
class="description">regular expressions can be used for string matching (see <a 
href="#x1-180004.2">section 4.2</a>). Maximum string
     distances can also be used in a way similar to regular expressions.
     </dd><dt class="description">
<span 
class="cmbx-10x-x-109">DateTime</span>  </dt><dd 
class="description">representing a date/time. There are several functions acting on a date/time. Operator
     + and - can be used on them.</dd></dl>
<!--l. 712--><p class="noindent" >Scalars and arbitrarily shaped arrays of these data types can be used. However, arrays of Regex are not
possible. <br 
class="newline" />If an operand or function argument with a non-matching data type is used, TaQL will do the following
automatic conversions: <br 
class="newline" />- from Integer to Double or Complex. <br 
class="newline" />- from Integer or Double to Complex. <br 
class="newline" />- from String or Double to DateTime.
                                                                                         

                                                                                         
</p><!--l. 720--><p class="indent" >   In this document some special data types are used when describing the functions. <br 
class="newline" />- <span 
class="cmbx-10x-x-109">Real </span>means Integer or Double. <br 
class="newline" />- <span 
class="cmbx-10x-x-109">Numeric </span>means Integer, Double, or Complex. <br 
class="newline" />- <span 
class="cmbx-10x-x-109">DNumeric </span>means Double or Complex.
</p><!--l. 726--><p class="indent" >   TaQL supports any possible data type of a table column or keyword. In some commands (<a 
href="#x1-90003.1">column list</a>
and <a 
href="#x1-650007">CREATE TABLE</a>) columns are created where it is possible to specify the data type of a column. The
following case-insensitive values can be used to specify a type:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-31">
&#x00A0;&#x00A0;B&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;BOOL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;BOOLEAN
&#x00A0;<br />&#x00A0;&#x00A0;U1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UCHAR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;BYTE
&#x00A0;<br />&#x00A0;&#x00A0;I2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SHORT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SMALLINT
&#x00A0;<br />&#x00A0;&#x00A0;U2&#x00A0;&#x00A0;&#x00A0;UI2&#x00A0;&#x00A0;&#x00A0;USHORT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;USMALLINT
&#x00A0;<br />&#x00A0;&#x00A0;I4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;INT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;INTEGER
&#x00A0;<br />&#x00A0;&#x00A0;U4&#x00A0;&#x00A0;&#x00A0;UI4&#x00A0;&#x00A0;&#x00A0;UINT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UINTEGER
&#x00A0;<br />&#x00A0;&#x00A0;R4&#x00A0;&#x00A0;&#x00A0;FLT&#x00A0;&#x00A0;&#x00A0;FLOAT
&#x00A0;<br />&#x00A0;&#x00A0;R8&#x00A0;&#x00A0;&#x00A0;DBL&#x00A0;&#x00A0;&#x00A0;DOUBLE
&#x00A0;<br />&#x00A0;&#x00A0;C4&#x00A0;&#x00A0;&#x00A0;FC&#x00A0;&#x00A0;&#x00A0;&#x00A0;FCOMPLEX&#x00A0;&#x00A0;&#x00A0;COMPLEX
&#x00A0;<br />&#x00A0;&#x00A0;C8&#x00A0;&#x00A0;&#x00A0;DC&#x00A0;&#x00A0;&#x00A0;&#x00A0;DCOMPLEX
&#x00A0;<br />&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;STRING
</div>
<!--l. 743--><p class="nopar" >
</p><!--l. 745--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-180004.2"></a>Regular Expressions and String Distances</h4>
<!--l. 746--><p class="noindent" >TaQL supports the use of extended regular expressions and string distances. They can be specified in
various ways as discussed in <a 
href="#x1-250004.3.6">section 4.3.6</a>. There are three basic types of regular expressions.
</p>
     <ul class="itemize1">
     <li class="itemize">An SQL-style pattern is quite simple. It has 2 special characters. The underscore (_) means a
     single arbitrary character and the percent (%) means zero or more arbitrary characters.
     Special characters can be escaped with a backslash to retain their normal meaning. For
     example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-32">
     &#x00A0;&#x00A0;3c\_%
</div>
     <!--l. 758--><p class="nopar" > matches <span 
class="cmtt-10x-x-109">3c</span><span 
class="cmtt-10x-x-109">_ </span>and <span 
class="cmtt-10x-x-109">3c</span><span 
class="cmtt-10x-x-109">_xx</span>, but not <span 
class="cmtt-10x-x-109">3caxx</span>.
     </p></li>
     <li class="itemize">A UNIX-style pattern, as often used for wildcarded file names, is more powerful than the SQL-style
     pattern. It has a few special characters that can be escaped with a backslash.
          <ul class="itemize2">
          <li class="itemize">The question mark (?) means a single arbitrary character.
          </li>
          <li class="itemize">The asterisk (*) means zero or more arbitrary characters. For example: <span 
class="cmtt-10x-x-109">3c</span><span 
class="cmtt-10x-x-109">_* </span>does the
          same as the SQL-style pattern above.
          </li>
          <li class="itemize">Square brackets indicate a bracket expression (character choice). For example: <span 
class="cmtt-10x-x-109">[ab]</span>
          matches <span 
class="cmtt-10x-x-109">a </span>and <span 
class="cmtt-10x-x-109">b</span>, but not <span 
class="cmtt-10x-x-109">c</span>. A few special characters can be used in a bracket
          expression:
              <ul class="itemize3">
              <li class="itemize">A leading <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">^</span></span></span> or ! means negation. Thus <span 
class="cmtt-10x-x-109">[!ab] </span>matches every character except a and
              b.
              </li>
              <li class="itemize">A minus sign indicates a range. For example <span 
class="cmtt-10x-x-109">[0-9] </span>matches a digit or <span 
class="cmtt-10x-x-109">[a-z] </span>matches
              a lowercase letter. If a minus sign cannot be interpreted as a range, it is a literal
              minus sign like in <span 
class="cmtt-10x-x-109">[-ab] </span>or the second minus sign in <span 
class="cmtt-10x-x-109">[a-z-A]</span>.
              </li>
              <li class="itemize">Posix character classes <span 
class="cmtt-10x-x-109">[:xx:] </span>where xx can be: <br 
class="newline" />- <span 
class="cmbx-10x-x-109">alpha </span>matching any letter <br 
class="newline" />- <span 
class="cmbx-10x-x-109">lower </span>matching any lowercase letter <br 
class="newline" />- <span 
class="cmbx-10x-x-109">upper </span>matching any uppercase letter <br 
class="newline" />- <span 
class="cmbx-10x-x-109">alnum </span>matching any digit or letter <br 
class="newline" />- <span 
class="cmbx-10x-x-109">digit </span>matching any digit <br 
class="newline" />- <span 
class="cmbx-10x-x-109">xdigit </span>matching any hexadecimal digit (0-9a-fA-F) <br 
class="newline" />- <span 
class="cmbx-10x-x-109">space </span>matching any whitespace character <br 
class="newline" />- <span 
class="cmbx-10x-x-109">print </span>matching any printable character (alnum, punct, space) <br 
class="newline" />- <span 
class="cmbx-10x-x-109">punct </span>matching any non-alnum visible character (.,!? etc.) <br 
class="newline" />- <span 
class="cmbx-10x-x-109">graph </span>matching any visible printable character (alnum, punct) <br 
class="newline" />- <span 
class="cmbx-10x-x-109">cntrl </span>matching any control character. <br 
class="newline" />For example <span 
class="cmtt-10x-x-109">[</span><span 
class="cmtt-10x-x-109">_[:isalpha:]][</span><span 
class="cmtt-10x-x-109">_[:isalnum:]]* </span>to match variable names.
              </li>
              <li class="itemize">A bracket expression cannot be empty, thus if ] is the first character in the bracket
              expression, it is interpreted literally. Note that is also true if it is the first character
              after the negation character.
                                                                                         

                                                                                         
              </li>
              <li class="itemize">A backslash in a character class is always interpreted literally, thus special characters
              cannot be escaped. However, as shown above they can always be placed such that
              they are interpreted literally.</li></ul>
          </li>
          <li class="itemize">Braces can be used for a choice between (possible empty) multi-character strings separated by
          commas. Escape a comma or brace with a backslash to treat it literally. For example:
          <br 
class="newline" /><span 
class="cmtt-10x-x-109">*.</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">h,hpp,c,cc,cpp</span><span 
class="cmsy-10x-x-109">}</span><br 
class="newline" />It is fully nestable, thus choice strings can be patterns. For example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">*.</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">[hc]</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">,pp</span><span 
class="cmsy-10x-x-109">}</span><span 
class="cmtt-10x-x-109">,c</span><span 
class="cmsy-10x-x-109">}</span><br 
class="newline" />does the same as the example above. Note that the inner choice is between an empty string and
          <span 
class="cmtt-10x-x-109">pp</span>.</li></ul>
     </li>
     <li class="itemize">An awk/egrep-like extended regular expression is most powerful. A full explanation can be found on
     Wikipedia. Here only a summary of its special characters is given. They can be escaped using
     backslashes.
          <ul class="itemize2">
          <li class="itemize"><span 
class="cmtt-10x-x-109">. </span>matches any character.
          </li>
          <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">^</span></span></span> matches beginning of string.
          </li>
          <li class="itemize">$ matches end of string.
          </li>
          <li class="itemize">Square brackets for a bracket expression. It is the same as described above with the
          exception that ! cannot be used as negation character).
          </li>
          <li class="itemize">* matches zero or more occurrences of previous character or subexpression.
          </li>
          <li class="itemize">+ matches one or more occurrences.
          </li>
          <li class="itemize">? matches zero or one occurrence.
          </li>
          <li class="itemize"><span 
class="cmsy-10x-x-109">{ </span>and <span 
class="cmsy-10x-x-109">} </span>for an interval giving minimum and maximum number of occurrences. For
          example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">[a-z]</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">3,5</span><span 
class="cmsy-10x-x-109">} </span>matches lowercase string with a minimum of 3 and maximum of 5 characters.
          <br 
class="newline" /><span 
class="cmtt-10x-x-109">[a-z]</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">3</span><span 
class="cmsy-10x-x-109">} </span>matches exactly 3 characters. <br 
class="newline" /><span 
class="cmtt-10x-x-109">[a-z]</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">3,</span><span 
class="cmsy-10x-x-109">} </span>matches at least 3 characters. <br 
class="newline" /><span 
class="cmtt-10x-x-109">[a-z]</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">,5</span><span 
class="cmsy-10x-x-109">} </span>matches at most 5 characters.
          </li>
          <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">|</span></span></span> matches left or right substring
                                                                                         

                                                                                         
          </li>
          <li class="itemize">( and ) to form subexpressions for operators like *.
          </li>
          <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\1</span></span></span> till <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\9</span></span></span> mean backreference to a subexpression (first one is <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\1</span></span></span>). A string part matches
          if it is equal to the string part matching that subexpression. E.g. <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">(a*)x\1</span></span></span> matches x,
          axa, aaxaa, etc., but not axaa nor aaxa.</li></ul>
     <!--l. 845--><p class="noindent" >For example:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-33">
     &#x00A0;&#x00A0;.*\.(h|hpp|c|cc|cpp)
     &#x00A0;<br />&#x00A0;&#x00A0;.*\.[hc](pp)?|cc
</div>
     <!--l. 849--><p class="nopar" > do the same as the pattern examples above.</p></li></ul>
<!--l. 852--><p class="noindent" >Furthermore it is possible to specify maximum string distances (known as Levensthein or Edit distance). It is
explained in <a 
href="#x1-250004.3.6">section 4.3.6</a>.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-34">
&#x00A0;&#x00A0;column&#x00A0;~&#x00A0;d/string/ibnn
</div>
<!--l. 858--><p class="nopar" >
</p><!--l. 860--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-190004.3"></a>Constants</h4>
<!--l. 861--><p class="noindent" >Scalar constants of the various data types can be formed in a way similar to Python and Glish. Array
constants can be formed from scalar constants.
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.1   </span> <a 
 id="x1-200004.3.1"></a>Bool</h5>
<!--l. 865--><p class="noindent" >A Bool constant is the value <span 
class="cmtt-10x-x-109">T </span>or <span 
class="cmtt-10x-x-109">F </span>(both in uppercase) or the value <span 
class="cmtt-10x-x-109">true </span>or <span 
class="cmtt-10x-x-109">false </span>(any
case).
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.2   </span> <a 
 id="x1-210004.3.2"></a>Integer</h5>
<!--l. 868--><p class="noindent" >An integer constant is a numeric value without decimal point or exponent. It can also be given as a
hexadecimal value like <span 
class="cmtt-10x-x-109">0xffff</span>.
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.3   </span> <a 
 id="x1-220004.3.3"></a>Double (and time/position)</h5>
<!--l. 871--><p class="noindent" >A floating-point constant is given with a decimal point and/or exponent. Both E and D as well as their
lowercase versions can be used to specify an exponent. An integer number followed by a unit is also
regarded as a double constant. <br 
class="newline" />Another way to define a Double constant is by means of a Time or Position. Such a constant is always
converted to radians. It can be given in several ways: </p>
     <ul class="itemize1">
     <li class="itemize">An integer or floating-point number immediately followed by a simple unit (thus without
     whitespace). E.g. <span 
class="cmtt-10x-x-109">12.43deg </span><br 
class="newline" />Some valid units are deg, arcmin, arcsec (or as), rad. The units can be scaled by preceeding
     them with a letter (e.g. mrad is millirad).
     </li>
     <li class="itemize">A time/position in HMS format. Minutes and/or seconds can be left out. E.g. <span 
class="cmtt-10x-x-109">12h34m34.5</span>
     or <span 
class="cmtt-10x-x-109">8h</span>
                                                                                         

                                                                                         
     </li>
     <li class="itemize">A position in DMS format. Only seconds can be left out because <span 
class="cmtt-10x-x-109">12d3 </span>is the floating point
     constant 12000. E.g. <span 
class="cmtt-10x-x-109">12d34m34.5 </span>or <span 
class="cmtt-10x-x-109">8d0m</span>
     </li>
     <li class="itemize">A position as DMS in dot format. Note that the dots for degrees and minutes must always
     be present. E.g. <span 
class="cmtt-10x-x-109">12.34.34.5 </span>or <span 
class="cmtt-10x-x-109">8..34.5</span></li></ul>
<!--l. 895--><p class="noindent" >Note that DMS positions and units have an ambiguity. <span 
class="cmtt-10x-x-109">2d3m </span>will be seen as a position and not as 2000
meter (note that 2d3 is a floating point constant). Use <span 
class="cmtt-10x-x-109">2.d3m </span>or <span 
class="cmtt-10x-x-109">2d3 m </span>to indicate the meters
case.
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.4   </span> <a 
 id="x1-230004.3.4"></a>Complex</h5>
<!--l. 900--><p class="noindent" >The imaginary part of a Complex constant is formed by an Integer or Double constant immediately
followed by a lowercase <span 
class="cmbx-10x-x-109">i </span>or <span 
class="cmbx-10x-x-109">j</span>. A full Complex constant is formed by adding another Integer or Double
constant as the real part. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-35">
&#x00A0;&#x00A0;1.5&#x00A0;+&#x00A0;2j
&#x00A0;<br />&#x00A0;&#x00A0;2i+1.5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;is&#x00A0;identical
&#x00A0;<br />&#x00A0;&#x00A0;
</div>
<!--l. 908--><p class="nopar" > Note that a full Complex constant has to be enclosed in parentheses if, say, a multiplication is performed
on it. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-36">
&#x00A0;&#x00A0;2&#x00A0;*&#x00A0;(1.5+2i)
&#x00A0;<br />&#x00A0;&#x00A0;
</div>
<!--l. 913--><p class="nopar" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.5   </span> <a 
 id="x1-240004.3.5"></a>String</h5>
<!--l. 915--><p class="noindent" >A String constant has to be enclosed in &#8221; or &#8217; and can be concatenated (as in C++). E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-37">
&#x00A0;&#x00A0;"this&#x00A0;is&#x00A0;a&#x00A0;string&#x00A0;constant"
&#x00A0;<br />&#x00A0;&#x00A0;&#8217;this&#x00A0;is&#x00A0;a&#x00A0;string&#x00A0;constant&#x00A0;containing&#x00A0;a&#x00A0;"&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;"ab&#8217;cd"&#8217;ef"gh&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;which&#x00A0;results&#x00A0;in:&#x00A0;&#x00A0;&#x00A0;ab&#8217;cdef"gh
&#x00A0;<br />&#x00A0;&#x00A0;
</div>
<!--l. 922--><p class="nopar" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.6   </span> <a 
 id="x1-250004.3.6"></a>Regular expression and String distance</h5>
<!--l. 924--><p class="noindent" >A <a 
href="#x1-180004.2">regular expression</a> constant can be given directly or using a function. </p>
     <ul class="itemize1">
     <li class="itemize">An SQL-style pattern can be given directly as a string constant preceeded by operator LIKE
     or NOT LIKE.
     </li>
     <li class="itemize">A pattern or regular expression can be given like <span 
class="cmtt-10x-x-109">x/expr/q </span>preceeded by operator <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">!~</span></span></span>. Instead of
     a slash, the characters % and # can also be used as delimiter, as long as the same delimiter is used
     on both sides. The delimiter can not be part of the expression (not even escaped with a backslash).
     <br 
class="newline" />The x denotes the type: <br 
class="newline" />- <span 
class="cmbx-10x-x-109">p </span>means a pattern matching the full string. <br 
class="newline" />- <span 
class="cmbx-10x-x-109">f </span>means a regular expression matching the full string. <br 
class="newline" />- <span 
class="cmbx-10x-x-109">m </span>means a regular expression matching part of the string (a la Perl). <br 
class="newline" />The q denotes optional qualifiers. Currently only <span 
class="cmbx-10x-x-109">i </span>is supported meaning a case-insensitive match.
     For example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-38">
     &#x00A0;&#x00A0;name~p/3[cC]*/
     &#x00A0;<br />&#x00A0;&#x00A0;name&#x00A0;~&#x00A0;p%3c*%i
     &#x00A0;<br />&#x00A0;&#x00A0;lower(name)&#x00A0;~&#x00A0;p%3c*%
     &#x00A0;<br />&#x00A0;&#x00A0;name&#x00A0;~&#x00A0;m/^3c/i
     &#x00A0;<br />&#x00A0;&#x00A0;name&#x00A0;~&#x00A0;f/3c.*/i
     &#x00A0;<br />&#x00A0;&#x00A0;filename&#x00A0;!~&#x00A0;p#/usr/*.{h,cc}#
</div>
     <!--l. 948--><p class="nopar" > All examples but the last one do the same: matching a name starting with 3c or 3C.
     <br 
class="newline" />The last example shows a glob-style pattern to find files on <span 
class="cmtt-10x-x-109">/usr </span>not ending in <span 
class="cmtt-10x-x-109">.h </span>or
     <span 
class="cmtt-10x-x-109">.cc</span>.
     </p></li>
     <li class="itemize">Apart from these Perl-like specifications, a regular expression can also be formed by
     applying a function to a string constant. The operator = or != has to be applied to
     it.
          <ul class="itemize2">
          <li class="itemize">Function <span 
class="cmtt-10x-x-109">sqlpattern </span>treats its argument as an SQL-style pattern. For example:
                                                                                         

                                                                                         
          <div class="verbatim" id="verbatim-39">
          &#x00A0;&#x00A0;lower(name)&#x00A0;LIKE&#x00A0;&#8217;3c%&#8217;
          &#x00A0;<br />&#x00A0;&#x00A0;lower(name)&#x00A0;=&#x00A0;sqlpattern(&#8217;3c%&#8217;)
</div>
          <!--l. 962--><p class="nopar" > do the same.
          </p></li>
          <li class="itemize">Function <span 
class="cmtt-10x-x-109">pattern </span>treats its argument as a UNIX-style pattern.
          </li>
          <li class="itemize">Function <span 
class="cmtt-10x-x-109">regex </span>treats its argument as a full regular expression.</li></ul>
     <!--l. 967--><p class="noindent" >Case-insensitive matching can only be done as shown in the example above by downcasing the string
     to be matched. <br 
class="newline" />Please note that these functions are not limited to constants. They can also be used to form regular
     expressions from variables.</p></li></ul>
<!--l. 973--><p class="indent" >   A maximum string distance constant can be specified in a similar way. Such a distance is known as the
Levensthein or Edit distance. It is a measure of the similarity of strings by counting the minimum number
of edits (deletions, insertions, substitutions, and swaps of adjacent characters) that need to be done to
make the strings equal.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-40">
&#x00A0;&#x00A0;column&#x00A0;~&#x00A0;d/string/ibnn
</div>
<!--l. 981--><p class="nopar" > This tests if the strings in the given column are within the maximum distance of the string given in the
constant. The following qualifiers can be given (in any order): </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmbx-10x-x-109">i </span>means a case insensitive test.
     </li>
     <li class="itemize"><span 
class="cmbx-10x-x-109">b </span>means that blanks in the strings are ignored.
     </li>
     <li class="itemize"><span 
class="cmbx-10x-x-109">nn  </span>is  an  integer  value  giving  the  maximum  distance.  If  not  given  it  defaults  to  <span 
class="cmtt-10x-x-109">1 +</span>
     <span 
class="cmtt-10x-x-109">len(string) / 3</span>.</li></ul>
<!--l. 992--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.7   </span> <a 
 id="x1-260004.3.7"></a>Date/time</h5>
<!--l. 993--><p class="noindent" >DateTime constant can be formed in 2 ways:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-26002x1">From a String constant using the <span 
class="cmtt-10x-x-109">datetime </span>function. In this way all possible formats as explained in
     class <a 
href="../html/classcasa_1_1MVTime.html" >MVTime</a> are supported. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-41">
     &#x00A0;&#x00A0;datetime&#x00A0;("11-Dec-1972")
</div>
     <!--l. 1001--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-26004x2">A more convenient way is to specify it directly. Since this makes use of the delimiters space, - or /, it
     conflicts with the expression grammar as such. However, such conflicts can be solved by using
     whitespace in a expression and it is believed that in practice the convenience surpasses the possible
     conflicts. <br 
class="newline" />A large subset of the MVTime formats is supported. A DateTime has to be specified as <span 
class="cmtt-10x-x-109">date/time</span>
     or <span 
class="cmtt-10x-x-109">date-time</span>, where the time part (including the space, -, or / delimiter) is optional. The possible
     date formats are: <br 
class="newline" />- YYYY/MM/DD or DD-MM-YYYY <br 
class="newline" />- DD-MMMMMMMM-YY where the - is optional and MMMMMMM is the case-insensitive name of
     the month (at least 3 letters). <br 
class="newline" />- YYYY//DDD or DDD&#8211;YYYY where DDD is the day number in the year. <br 
class="newline" />In  the  DMY  format,  2000  is  added  if
     year<!--l. 1018--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>50 and 1900 is added if
     50<!--l. 1019--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math>year<!--l. 1019--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>100.
     <br 
class="newline" />If MM<!--l. 1020--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>12,
     YYYY will be incremented accordingly. <br 
class="newline" />The general time format in a DateTime constant is: <br 
class="newline" />- hh:mm:ss.s <br 
class="newline" />where the delimiter <span 
class="cmbx-10x-x-109">h </span>or <span 
class="cmbx-10x-x-109">H </span>can be used for the first colon and <span 
class="cmbx-10x-x-109">m </span>or <span 
class="cmbx-10x-x-109">M </span>for the second. Trailing parts
     can be omitted. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-42">
     &#x00A0;&#x00A0;10-2-97
     &#x00A0;<br />&#x00A0;&#x00A0;10-02-1997
     &#x00A0;<br />&#x00A0;&#x00A0;10-February-97
     &#x00A0;<br />&#x00A0;&#x00A0;10feb97
     &#x00A0;<br />&#x00A0;&#x00A0;1997/2/10&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;are&#x00A0;all&#x00A0;identical
     &#x00A0;<br />
     &#x00A0;<br />&#x00A0;&#x00A0;1May96/3:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;(or&#x00A0;h)&#x00A0;is&#x00A0;mandatory
     &#x00A0;<br />&#x00A0;&#x00A0;1May96-3:0
     &#x00A0;<br />&#x00A0;&#x00A0;1May96&#x00A0;3:0:0
     &#x00A0;<br />&#x00A0;&#x00A0;1May96-3h&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;h&#x00A0;(or&#x00A0;:)&#x00A0;is&#x00A0;mandatory
     &#x00A0;<br />&#x00A0;&#x00A0;1May96&#x00A0;3H0
     &#x00A0;<br />&#x00A0;&#x00A0;1May96/3h0M
     &#x00A0;<br />&#x00A0;&#x00A0;1May96/3hm0.0
</div>
     <!--l. 1040--><p class="nopar" > A DateTime constant with the current date/time can be made by using the function <span 
class="cmtt-10x-x-109">datetime</span>
     without arguments.</p></li></ol>
<!--l. 1045--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.8   </span> <a 
 id="x1-270004.3.8"></a>Arrays</h5>
<!--l. 1046--><p class="noindent" >N-dimensional arrays of all data types can be created with the exception of regular expressions.
<br 
class="newline" />It is possible to form a 1-dimensional array from a constant bounded discrete <a 
href="#x1-320004.7">set</a>. When needed such a set
is automatically transformed to an array. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-43">
&#x00A0;&#x00A0;[1:10]
&#x00A0;<br />&#x00A0;&#x00A0;[&#8217;str1&#8217;,&#x00A0;&#8217;str2&#8217;,&#x00A0;&#8217;str3&#8217;]
&#x00A0;<br />&#x00A0;&#x00A0;&#8217;str&#8217;&#x00A0;+&#x00A0;[&#8217;1&#8217;,&#x00A0;&#8217;2&#8217;,&#x00A0;&#8217;3&#8217;]
</div>
<!--l. 1055--><p class="nopar" > The first example results in an integer array of 10 elements with values 1..10. The others result in a string
array of 3 elements. The second version already shows that strings can be concatenated (as explained
further on).
</p><!--l. 1060--><p class="indent" >   Furthermore it is possible to use the <span 
class="cmtt-10x-x-109">array </span>function to create an array of any shape. The values are
given in the first argument as a scalar, srt, or another array. The shape is given in the latter arguments as
scalars or as a set. The array is initialized to the values given which are wrapped if the array has more
elements.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-44">
&#x00A0;&#x00A0;array([1:10],10,4)
&#x00A0;<br />&#x00A0;&#x00A0;array([1:10],&#x00A0;[10,4])
&#x00A0;<br />&#x00A0;&#x00A0;array(F,shape(DATA))
</div>
<!--l. 1069--><p class="nopar" > The first examples create an array with shape [10,4] containing the values 1..10 in each line. The
latter results in a boolean array having the same shape as the DATA array and filled with
False.
</p><!--l. 1075--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.9   </span> <a 
 id="x1-280004.3.9"></a>Masked Arrays</h5>
<!--l. 1076--><p class="noindent" >An array can have an optional mask. Similar to numpy&#8217;s masked array, a mask value True means that the
value is masked off, thus not taken into account in reduction functions like calculating the mean.
<br 
class="newline" />Note that this definition is the same as the FLAG column in a MeasurementSet, but is different from a
mask in a casacore Image where True means good and False means bad.
</p><!--l. 1083--><p class="indent" >   All operations on arrays will take the possible mask into account. Reduction functions like <span 
class="cmtt-10x-x-109">median </span>only
use the unmasked array elements. Furthermore, partial reduction functions like <span 
class="cmtt-10x-x-109">medians </span>will set an
output mask element to True if the corresponding input array part has no unmasked elements.
<br 
class="newline" />Operators like + and functions like <span 
class="cmtt-10x-x-109">cos </span>operate on all array elements. The mask in the resulting array is
the logical OR of the input masks. Of course, the result has no mask if no input array has a
mask.
</p><!--l. 1093--><p class="indent" >   A masked array is created by applying a boolean array to an array using the square brackets operator.
For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-45">
&#x00A0;&#x00A0;DATA[FLAG]
&#x00A0;<br />&#x00A0;&#x00A0;DATA[DATA&#x00A0;&#x003E;&#x00A0;3*median(DATA)]
</div>
<!--l. 1098--><p class="nopar" > The first example applies the FLAG column in a MeasurementSet to the DATA column. The second
example masks off high DATA values.
</p><!--l. 1103--><p class="indent" >   The function <span 
class="cmtt-10x-x-109">arraydata</span>, <span 
class="cmtt-10x-x-109">arraymask</span>, and <span 
class="cmtt-10x-x-109">flatten </span>can be used to get the array data or mask. The last
one flattens the array to a vector while removing all masked elements.
</p><!--l. 1108--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-290004.4"></a>Table Columns</h4>
<!--l. 1109--><p class="noindent" >A table column can be used in a query by giving its name in the expression. Note that only columns in the
primary table can be handled directly. A column in another table can be used via a subquery.
E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-46">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;tab&#x00A0;WHERE&#x00A0;col&#x00A0;&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean([SELECT&#x00A0;othercol&#x00A0;FROM&#x00A0;othertab])
</div>
<!--l. 1116--><p class="nopar" > An expression has to contain at least one column, since columns are the only variable part
in it. That is, a row can only be selected or sorted by means of the column values in each
row.
</p><!--l. 1121--><p class="indent" >   A column can contain a scalar or an array value of any data type supported by the table system. It
will be mapped to the available TaQL <a 
href="#x1-170004.1">data types</a>.
</p><!--l. 1125--><p class="indent" >   If the column keywords define a <a 
href="#x1-340004.9">unit</a> for the column, the unit will be used by TaQL.
</p><!--l. 1128--><p class="indent" >   The name of a column can contain alphanumeric characters and underscores. It should start with an
alphabetic character or underscore. A column name is case-sensitive. <br 
class="newline" />It is possible to use other characters in the name by escaping them with a backslash. E.g. <span 
class="cmtt-10x-x-109">DATE</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">-OBS</span>.
<br 
class="newline" />In the same way a numeric character can be used as the first character of the column name. E.g. <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">1stDay</span>.
<br 
class="newline" />A <a 
href="#x1-70002.4">reserved word</a> cannot be used directly as column name. It can, however, be used as a column name by
escaping it with a backslash. E.g. <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">IN</span>. <br 
class="newline" />Note that in programming languages like C++ and Python a backslash itself has to be escaped by another backslash. E.g. in Python:
<span 
class="cmtt-10x-x-109">tab.query(&#8217;DATE</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\\</span></span></span><span 
class="cmtt-10x-x-109">-OBS</span><!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math><span 
class="cmtt-10x-x-109">10MAR1996&#8217;)</span>.
</p><!--l. 1144--><p class="indent" >   If a column contains a record, one has to specify a field in it using the dot operator; e.g. <span 
class="cmtt-10x-x-109">col.fld</span>
means use field <span 
class="cmtt-10x-x-109">fld </span>in the column. It is fully recursive, so <span 
class="cmtt-10x-x-109">col.fld.subfld </span>can be used if field <span 
class="cmtt-10x-x-109">fld </span>is a
record in itself. <br 
class="newline" />Alas records in columns are not really supported yet. One can specify fields, but thereafter an error
message will be given.
</p><!--l. 1152--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-300004.5"></a>Table Keywords</h4>
<!--l. 1153--><p class="noindent" >It is possible to use table or column keywords, which can have a scalar or an array value. A table
keyword has to be specified as <span 
class="cmtt-10x-x-109">::key</span>. In an expression the <span 
class="cmtt-10x-x-109">:: </span>part can be omitted if there
is no column with the same name. A column keyword has to be specified as <span 
class="cmtt-10x-x-109">column::key</span>.
<br 
class="newline" />Note that the <span 
class="cmtt-10x-x-109">:: </span>syntax is chosen, because it is similar to the scope operator in C++. <br 
class="newline" />As explained in the <a 
href="#x1-110003.3">FROM clause</a> of the syntax section, keywords from the primary table and from
secondary tables can be used. If used from a secondary table, it has to be qualified with the (shorthand)
name of the table. E.g. <br 
class="newline" /><span 
class="cmtt-10x-x-109">sh.key </span>or <span 
class="cmtt-10x-x-109">sh.::key </span><br 
class="newline" />takes table keyword <span 
class="cmtt-10x-x-109">key </span>from the table with the shorthand name <span 
class="cmtt-10x-x-109">sh</span>.
</p><!--l. 1169--><p class="indent" >   If a keyword value is a record, it is possible to use a field in it using the dot operator. E.g. <span 
class="cmtt-10x-x-109">::key.fld</span>
to use field <span 
class="cmtt-10x-x-109">fld</span>. It is fully recursive, so if the field is a record in itself, a subfield can be used like
                                                                                         

                                                                                         
<span 
class="cmtt-10x-x-109">col::key.fld.subfld</span>
</p><!--l. 1175--><p class="indent" >   A keyword can be used in any expression. It is evaluated immediately and transformed to a constant
value.
</p><!--l. 1178--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.6   </span> <a 
 id="x1-310004.6"></a>Operators</h4>
<!--l. 1179--><p class="noindent" >TaQL has a fair amount of operators which have the same meaning as their C and Python counterparts.
The operator precedence order is:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-47">
&#x00A0;&#x00A0;**
&#x00A0;<br />&#x00A0;&#x00A0;!&#x00A0;&#x00A0;~&#x00A0;&#x00A0;+&#x00A0;&#x00A0;-&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(unary&#x00A0;operators)
&#x00A0;<br />&#x00A0;&#x00A0;*&#x00A0;&#x00A0;/&#x00A0;&#x00A0;//&#x00A0;%
&#x00A0;<br />&#x00A0;&#x00A0;+&#x00A0;&#x00A0;-
&#x00A0;<br />&#x00A0;&#x00A0;&amp;
&#x00A0;<br />&#x00A0;&#x00A0;^
&#x00A0;<br />&#x00A0;&#x00A0;|
&#x00A0;<br />&#x00A0;&#x00A0;==&#x00A0;!=&#x00A0;&#x003E;&#x00A0;&#x00A0;&#x003E;=&#x00A0;&#x003C;&#x00A0;&#x00A0;&#x003C;=&#x00A0;&#x00A0;~=&#x00A0;!~=&#x00A0;IN&#x00A0;INCONE&#x00A0;BETWEEN&#x00A0;EXISTS&#x00A0;LIKE&#x00A0;&#x00A0;~&#x00A0;&#x00A0;!~
&#x00A0;<br />&#x00A0;&#x00A0;&amp;&amp;
&#x00A0;<br />&#x00A0;&#x00A0;||
</div>
<!--l. 1193--><p class="nopar" > Operator names are case-insensitive. For SQL compliancy some operators have a synonym.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-48">
&#x00A0;&#x00A0;==&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=
&#x00A0;<br />&#x00A0;&#x00A0;!=&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&amp;&amp;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AND
&#x00A0;<br />&#x00A0;&#x00A0;||&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OR
&#x00A0;<br />&#x00A0;&#x00A0;!&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;NOT
&#x00A0;<br />&#x00A0;&#x00A0;^&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;XOR
</div>
<!--l. 1203--><p class="nopar" > All operators can be used for scalars and arrays and a mix of them. Note that arrays of regular
expressions cannot be used.
</p><!--l. 1207--><p class="indent" >   The following table shows all available operators and the data types that can be used with
them.
</p>
                                                                                         

                                                                                         
   <div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /><col 
id="TBL-2-2" /><col 
id="TBL-2-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-1"  
class="td11">Operator                                                                                                                                                                                                                                                      </td><td  style="text-align:left;" id="TBL-2-1-2"  
class="td11"><!--l. 1211--><p class="noindent" >Data Type </p></td><td  style="text-align:left;" id="TBL-2-1-3"  
class="td11"><!--l. 1211--><p class="noindent" >Description                                                               </p></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-1"  
class="td11"><span 
class="cmtt-10x-x-109">**                                                                                                                                                                   </span></td><td  style="text-align:left;" id="TBL-2-2-2"  
class="td11"><!--l. 1212--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-2-3"  
class="td11"><!--l. 1212--><p class="noindent" >power. It is right associative, thus <span 
class="cmtt-10x-x-109">2**1**2 </span>results in <span 
class="cmtt-10x-x-109">2</span>.     </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-1"  
class="td11"><span 
class="cmtt-10x-x-109">*                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-3-2"  
class="td11"><!--l. 1214--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-3-3"  
class="td11"><!--l. 1214--><p class="noindent" >multiplication                                                            </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-4-1"  
class="td11"><span 
class="cmtt-10x-x-109">/                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-4-2"  
class="td11"><!--l. 1215--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-4-3"  
class="td11"><!--l. 1215--><p class="noindent" >non-truncated division, thus <span 
class="cmtt-10x-x-109">1/2 </span>results in <span 
class="cmtt-10x-x-109">0.5</span>          </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-5-1"  
class="td11"><span 
class="cmtt-10x-x-109">//                                                                                                                                                                   </span></td><td  style="text-align:left;" id="TBL-2-5-2"  
class="td11"><!--l. 1217--><p class="noindent" >real           </p></td><td  style="text-align:left;" id="TBL-2-5-3"  
class="td11"><!--l. 1217--><p class="noindent" >truncated division (a la Python) resulting in an integer, thus
<span 
class="cmtt-10x-x-109">1./2. </span>results in <span 
class="cmtt-10x-x-109">0</span>                                   </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-6-1"  
class="td11"><span 
class="cmtt-10x-x-109">%                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-6-2"  
class="td11"><!--l. 1219--><p class="noindent" >real           </p></td><td  style="text-align:left;" id="TBL-2-6-3"  
class="td11"><!--l. 1219--><p class="noindent" >modulo; <span 
class="cmtt-10x-x-109">3.5%1.2 </span>results in <span 
class="cmtt-10x-x-109">1.1</span>; <span 
class="cmtt-10x-x-109">-5%3 </span>results in <span 
class="cmtt-10x-x-109">-2</span>       </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-7-1"  
class="td11"><span 
class="cmtt-10x-x-109">+                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-7-2"  
class="td11"><!--l. 1221--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-7-3"  
class="td11"><!--l. 1221--><p class="noindent" >addition. If a date is used, only a real (converted to unit day)
can be added to it. String addition means concatenation.   </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-8-1"  
class="td11"><span 
class="cmtt-10x-x-109">-                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-8-2"  
class="td11"><!--l. 1224--><p class="noindent" >numeric,date </p> </td> <td  style="text-align:left;" id="TBL-2-8-3"  
class="td11"><!--l. 1224--><p class="noindent" >subtraction. Substracting a date from a date results in a real
(with unit day). Subtracting a real (converted to unit day)
from a date results in a date.                                        </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-9-1"  
class="td11"><span 
class="cmtt-10x-x-109">&amp;                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-9-2"  
class="td11"><!--l. 1227--><p class="noindent" >integer       </p></td><td  style="text-align:left;" id="TBL-2-9-3"  
class="td11"><!--l. 1227--><p class="noindent" >bitwise and                                                               </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-10-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">|</span></span></span>                                                                                                                                                                    </td><td  style="text-align:left;" id="TBL-2-10-2"  
class="td11"><!--l. 1228--><p class="noindent" >integer       </p></td><td  style="text-align:left;" id="TBL-2-10-3"  
class="td11"><!--l. 1228--><p class="noindent" >bitwise or                                                                 </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-11-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">^</span></span></span>, XOR                                                                                                                                                                                                                                                         </td><td  style="text-align:left;" id="TBL-2-11-2"  
class="td11"><!--l. 1229--><p class="noindent" >integer       </p></td><td  style="text-align:left;" id="TBL-2-11-3"  
class="td11"><!--l. 1229--><p class="noindent" >bitwise xor                                                                </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-12-1"  
class="td11"><!--l. 1230--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-rel">=</mo></math>, <!--l. 1230--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo></math></td><td  style="text-align:left;" id="TBL-2-12-2"  
class="td11"><!--l. 1230--><p class="noindent" >all            </p></td><td  style="text-align:left;" id="TBL-2-12-3"  
class="td11"><!--l. 1230--><p class="noindent" >comparison for equal. The norm is used when comparing
complex numbers.                                                      </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-13-1"  
class="td11"><!--l. 1232--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>                                                                                                               </td><td  style="text-align:left;" id="TBL-2-13-2"  
class="td11"><!--l. 1232--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-13-3"  
class="td11"><!--l. 1232--><p class="noindent" >comparison for greater                                                </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-14-1"  
class="td11"><!--l. 1233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo><mo 
class="MathClass-rel">=</mo></math>                                                                                                                                   </td><td  style="text-align:left;" id="TBL-2-14-2"  
class="td11"><!--l. 1233--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-14-3"  
class="td11"><!--l. 1233--><p class="noindent" >comparison for greater or equal                                     </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-15-1"  
class="td11"><!--l. 1234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>                                                                                                               </td><td  style="text-align:left;" id="TBL-2-15-2"  
class="td11"><!--l. 1234--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-15-3"  
class="td11"><!--l. 1234--><p class="noindent" >comparison for less                                                     </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-16-1"  
class="td11"><!--l. 1235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math>                                                                                                                                   </td><td  style="text-align:left;" id="TBL-2-16-2"  
class="td11"><!--l. 1235--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-16-3"  
class="td11"><!--l. 1235--><p class="noindent" >comparison for less or equal                                         </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-17-1"  
class="td11"><!--l. 1236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-punc">!</mo> <mo 
class="MathClass-rel">=</mo></math>, <!--l. 1236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">&#x003E;</mo></math></td><td  style="text-align:left;" id="TBL-2-17-2"  
class="td11"><!--l. 1236--><p class="noindent" >all            </p></td><td  style="text-align:left;" id="TBL-2-17-3"  
class="td11"><!--l. 1236--><p class="noindent" >comparison for not equal                                             </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-18-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~=</span></span></span>                                                                                                                                                                   </td><td  style="text-align:left;" id="TBL-2-18-2"  
class="td11"><!--l. 1237--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-18-3"  
class="td11"><!--l. 1237--><p class="noindent" >shorthand for the <a 
href="#x1-400004.10.5">NEAR function</a> with a tolerance of 1e-5  </p></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-19-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">!~=</span></span></span> </td> <td  style="text-align:left;" id="TBL-2-19-2"  
class="td11"><!--l. 1240--><p class="noindent" >numeric </p> </td> <td  style="text-align:left;" id="TBL-2-19-3"  
class="td11"><!--l. 1240--><p class="noindent" >shorthand for NOT <a 
href="#x1-400004.10.5">NEAR</a> with a tolerance of 1e-5</p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-20-1"  
class="td11"><span 
class="cmtt-10x-x-109">&amp;&amp;</span>, AND                                                                                                                                                                                                                                                       </td><td  style="text-align:left;" id="TBL-2-20-2"  
class="td11"><!--l. 1243--><p class="noindent" >bool          </p></td><td  style="text-align:left;" id="TBL-2-20-3"  
class="td11"><!--l. 1243--><p class="noindent" >logical and                                                                </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-21-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">||</span></span></span>, OR                                                                                                                                                                                                                                                          </td><td  style="text-align:left;" id="TBL-2-21-2"  
class="td11"><!--l. 1244--><p class="noindent" >bool          </p></td><td  style="text-align:left;" id="TBL-2-21-3"  
class="td11"><!--l. 1244--><p class="noindent" >logical or                                                                  </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-22-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-22-1"  
class="td11"><span 
class="cmtt-10x-x-109">!</span>, NOT                                                                                                                                                                                                                                                         </td><td  style="text-align:left;" id="TBL-2-22-2"  
class="td11"><!--l. 1245--><p class="noindent" >bool          </p></td><td  style="text-align:left;" id="TBL-2-22-3"  
class="td11"><!--l. 1245--><p class="noindent" >logical not                                                                </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-23-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-23-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~</span></span></span>                                                                                                                                                                    </td><td  style="text-align:left;" id="TBL-2-23-2"  
class="td11"><!--l. 1246--><p class="noindent" >integer       </p></td><td  style="text-align:left;" id="TBL-2-23-3"  
class="td11"><!--l. 1246--><p class="noindent" >bitwise negation                                                         </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-24-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-24-1"  
class="td11"><span 
class="cmtt-10x-x-109">+                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-24-2"  
class="td11"><!--l. 1247--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-24-3"  
class="td11"><!--l. 1247--><p class="noindent" >unary plus                                                                </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-25-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-25-1"  
class="td11"><span 
class="cmtt-10x-x-109">-                                                                                                                                                                    </span></td><td  style="text-align:left;" id="TBL-2-25-2"  
class="td11"><!--l. 1248--><p class="noindent" >numeric     </p></td><td  style="text-align:left;" id="TBL-2-25-3"  
class="td11"><!--l. 1248--><p class="noindent" >unary minus                                                              </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-26-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-26-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">~</span></span></span>                                                                                                                                                                    </td><td  style="text-align:left;" id="TBL-2-26-2"  
class="td11"><!--l. 1249--><p class="noindent" >string        </p></td><td  style="text-align:left;" id="TBL-2-26-3"  
class="td11"><!--l. 1249--><p class="noindent" >test if string matches a regular expression <a 
href="#x1-190004.3">constant</a>.          </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-27-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-27-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">!~</span></span></span>                                                                                                                                                                   </td><td  style="text-align:left;" id="TBL-2-27-2"  
class="td11"><!--l. 1251--><p class="noindent" >string        </p></td><td  style="text-align:left;" id="TBL-2-27-3"  
class="td11"><!--l. 1251--><p class="noindent" >test if string does not match a regular expression constant. </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-28-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-28-1"  
class="td11">LIKE                                                                                                                                                                                                                                                            </td><td  style="text-align:left;" id="TBL-2-28-2"  
class="td11"><!--l. 1253--><p class="noindent" >string        </p></td><td  style="text-align:left;" id="TBL-2-28-3"  
class="td11"><!--l. 1253--><p class="noindent" >test if a string matches an SQL pattern.                         </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-29-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-29-1"  
class="td11">NOT LIKE                                                                                                                                                                                                                                                    </td><td  style="text-align:left;" id="TBL-2-29-2"  
class="td11"><!--l. 1254--><p class="noindent" >string        </p></td><td  style="text-align:left;" id="TBL-2-29-3"  
class="td11"><!--l. 1254--><p class="noindent" >test if string does not match SQL pattern.                      </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-30-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-30-1"  
class="td11">IN                                                                                                                                                                                                                                                                </td><td  style="text-align:left;" id="TBL-2-30-2"  
class="td11"><!--l. 1255--><p class="noindent" >all            </p></td><td  style="text-align:left;" id="TBL-2-30-3"  
class="td11"><!--l. 1255--><p class="noindent" >test if a value is present in a set of values, ranges, and/or
intervals. (See the discussion of <a 
href="#x1-320004.7">sets</a>).                             </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-31-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-31-1"  
class="td11">NOT IN                                                                                                                                                                                                                                                        </td><td  style="text-align:left;" id="TBL-2-31-2"  
class="td11"><!--l. 1258--><p class="noindent" >all            </p></td><td  style="text-align:left;" id="TBL-2-31-3"  
class="td11"><!--l. 1258--><p class="noindent" >negation of IN                                                           </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-32-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-32-1"  
class="td11">BETWEEN                                                                                                                                                                                                                                                   </td><td  style="text-align:left;" id="TBL-2-32-2"  
class="td11"><!--l. 1259--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-32-3"  
class="td11"><!--l. 1259--><p class="noindent" ><span 
class="cmtt-10x-x-109">a BETWEEN b AND c </span>is similar to <span 
class="cmtt-10x-x-109">a&#x003E;=b AND a&#x003C;=c </span>and <span 
class="cmtt-10x-x-109">a IN</span>
<span 
class="cmtt-10x-x-109">[b=:=c]</span>                                          </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-33-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-33-1"  
class="td11">NOT BETWEEN                                                                                                                                                                                                                                            </td><td  style="text-align:left;" id="TBL-2-33-2"  
class="td11"><!--l. 1261--><p class="noindent" >no bool      </p></td><td  style="text-align:left;" id="TBL-2-33-3"  
class="td11"><!--l. 1261--><p class="noindent" ><span 
class="cmtt-10x-x-109">a NOT BETWEEN b AND c </span>is negation of above.                 </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-34-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-34-1"  
class="td11">INCONE                                                                                                                                                                                                                                                       </td><td  style="text-align:left;" id="TBL-2-34-2"  
class="td11"><!--l. 1263--><p class="noindent" >          </p></td><td  style="text-align:left;" id="TBL-2-34-3"  
class="td11"><!--l. 1263--><p class="noindent" >cone search. (See the discussion of <a 
href="#x1-490004.10.14">cone search functions</a>).  </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-35-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-35-1"  
class="td11">NOT INCONE                                                                                                                                                                                                                                               </td><td  style="text-align:left;" id="TBL-2-35-2"  
class="td11"><!--l. 1265--><p class="noindent" >          </p></td><td  style="text-align:left;" id="TBL-2-35-3"  
class="td11"><!--l. 1265--><p class="noindent" >negation of INCONE                                                  </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-36-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-36-1"  
class="td11">EXISTS                                                                                                                                                                                                                                                        </td><td  style="text-align:left;" id="TBL-2-36-2"  
class="td11"><!--l. 1266--><p class="noindent" >          </p></td><td  style="text-align:left;" id="TBL-2-36-3"  
class="td11"><!--l. 1266--><p class="noindent" >test if a subquery finds at least N matching rows. The value
for N is taken from its LIMIT clause; if LIMIT is not given it
defaults to 1. The subquery loop stops as soon as N matching
rows   are   found.   E.g.   <span 
class="cmtt-10x-x-109">EXISTS(select from ::ANTENNA</span>
<span 
class="cmtt-10x-x-109">where NAME=&#8217;&#8217;somename&#8217;&#8217; LIMIT 2) </span>results in true if at
least 2 matching rows in the ANTENNA table were found. </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-37-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-37-1"  
class="td11">NOT EXISTS                                                                                                                                                                                                                                                 </td><td  style="text-align:left;" id="TBL-2-37-2"  
class="td11"><!--l. 1274--><p class="noindent" >          </p></td><td  style="text-align:left;" id="TBL-2-37-3"  
class="td11"><!--l. 1274--><p class="noindent" >negation of EXISTS                                                   </p></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-38-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-38-1"  
class="td11">                                                                                                                                                                     </td> </tr></table>
</div>
<!--l. 1277--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.7   </span> <a 
 id="x1-320004.7"></a>Sets and intervals</h4>
                                                                                         

                                                                                         
<!--l. 1278--><p class="noindent" >As in SQL the operator <span 
class="cmtt-10x-x-109">IN </span>can be used to do a selection based on a set. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-49">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;table&#x00A0;WHERE&#x00A0;column&#x00A0;IN&#x00A0;[1,2,3]
</div>
<!--l. 1282--><p class="nopar" > The result of operator <span 
class="cmtt-10x-x-109">IN </span>is true if the column value matches one of the values in the set. A set can
contain any data type except a regex.
</p><!--l. 1288--><p class="indent" >   This example shows that (in its simplest form) a set consists of one or more values (which can be
arbitrary expressions) separated by commas and enclosed in square brackets. The elements in a set have
to be scalars and their data types have to be the same or convertible to a common data type. The square
brackets can be left out if the set consists of only one element. For SQL compliance parentheses can be
used instead of square brackets.
</p><!--l. 1297--><p class="indent" >   An array is also a set, so <span 
class="cmtt-10x-x-109">IN </span>can also be used on an array like:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-50">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;table&#x00A0;WHERE&#x00A0;column&#x00A0;IN&#x00A0;expr1
</div>
<!--l. 1301--><p class="nopar" > where <span 
class="cmtt-10x-x-109">expr1 </span>is the array result of some expression. It is also possible to use a scalar as the
righthand of operator <span 
class="cmtt-10x-x-109">IN</span>. So if <span 
class="cmtt-10x-x-109">expr1 </span>is a scalar, operator <span 
class="cmtt-10x-x-109">IN </span>gives the same result as operator
<span 
class="cmtt-10x-x-109">==</span>.
</p><!--l. 1308--><p class="indent" >   The lefthand operand of the <span 
class="cmtt-10x-x-109">IN </span>operator can also be an array or set. In that case its reult is a
boolean array telling for each element in the lefthand operand if it is found in the righthand
operand.
</p><!--l. 1313--><p class="indent" >   An element in a set can be more complicated than a single value. It can define multiple values or an
interval. The possible forms of a set element are:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32002x1">A single value as shown in the example above.
     </li>
     <li 
  class="enumerate" id="x1-32004x2"><span 
class="cmtt-10x-x-109">start:end:incr</span>. This is similar to the way an array index is specified. Incr defaults to 1. End
     defaults to an open end (i.e., no upper bound) and results in an unbounded set. Start and end can
     be a real or a datetime. Incr has to be a real. Some examples:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-51">
     &#x00A0;&#x00A0;1:10&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1,2,...,9,10&#x00A0;&#x00A0;(10&#x00A0;only&#x00A0;when&#x00A0;using&#x00A0;glish&#x00A0;style)
     &#x00A0;<br />&#x00A0;&#x00A0;1:10:2&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1,3,5,7,9
     &#x00A0;<br />&#x00A0;&#x00A0;1::2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;all&#x00A0;odd&#x00A0;numbers
     &#x00A0;<br />&#x00A0;&#x00A0;1:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;all&#x00A0;positive&#x00A0;integer&#x00A0;numbers
     &#x00A0;<br />&#x00A0;&#x00A0;date(&#8217;18Aug97&#8217;)::2&#x00A0;&#x00A0;&#x00A0;means&#x00A0;every&#x00A0;other&#x00A0;day&#x00A0;from&#x00A0;18Aug97&#x00A0;on
</div>
     <!--l. 1329--><p class="nopar" > These examples show constants only, but <span 
class="cmtt-10x-x-109">start</span>, <span 
class="cmtt-10x-x-109">end</span>, and <span 
class="cmtt-10x-x-109">incr </span>can be any expression.
     <br 
class="newline" />Note that :: used here can conflict with the :: in the <a 
href="#x1-300004.5">keywords</a>. E.g. <span 
class="cmtt-10x-x-109">a::b </span>is scanned as a keyword
     specification. If the intention is <span 
class="cmtt-10x-x-109">start::incr </span>it should be specified as <span 
class="cmtt-10x-x-109">a: :b</span>. In practice this conflict
     will hardly ever occur.
     </p></li>
     <li 
  class="enumerate" id="x1-32006x3">Continuous intervals can be specified for data type real, string, and datetime. The specification
     of an interval resembles the mathematical notation <span 
class="cmtt-10x-x-109">1&#x003C;x&#x003C;5</span>, where x is replaced by :.
     An open interval side is indicated by <span 
class="cmtt-10x-x-109">&#x003C;</span>, while a closed interval side is indicated by <span 
class="cmtt-10x-x-109">=</span>.
     <br 
class="newline" />Another way to specify intervals is using curly and/or angle brackets. A curly bracket is a closed
     side, the angle bracket is an open side. The following examples show how bounded and
     half-bounded, (half-)open and closed intervals can be specified.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-52">
     &#x00A0;&#x00A0;1=:=5&#x00A0;&#x00A0;&#x00A0;{1,5}&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;=x&#x003C;=5&#x00A0;&#x00A0;&#x00A0;bounded&#x00A0;closed
     &#x00A0;<br />&#x00A0;&#x00A0;1&#x003C;:&#x003C;5&#x00A0;&#x00A0;&#x00A0;&#x003C;1,5&#x003E;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;x&#x003C;5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bounded&#x00A0;open
     &#x00A0;<br />&#x00A0;&#x00A0;1=:&#x003C;5&#x00A0;&#x00A0;&#x00A0;{1,5&#x003E;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;=x&#x003C;5&#x00A0;&#x00A0;&#x00A0;&#x00A0;bounded&#x00A0;right-open
     &#x00A0;<br />&#x00A0;&#x00A0;1&#x003C;:=5&#x00A0;&#x00A0;&#x00A0;&#x003C;1,5}&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;x&#x003C;=5&#x00A0;&#x00A0;&#x00A0;&#x00A0;bounded&#x00A0;left-open
     &#x00A0;<br />&#x00A0;&#x00A0;1=:&#x00A0;&#x00A0;{1,}&#x00A0;&#x00A0;{1,&#x003E;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;=x&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;left-bounded&#x00A0;closed
     &#x00A0;<br />&#x00A0;&#x00A0;1&#x003C;:&#x00A0;&#x00A0;&#x003C;1,}&#x00A0;&#x00A0;&#x003C;1,&#x003E;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;1&#x003C;x&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;left-bounded&#x00A0;open
     &#x00A0;<br />&#x00A0;&#x00A0;:=5&#x00A0;&#x00A0;{,5}&#x00A0;&#x00A0;&#x003C;,5}&#x00A0;&#x00A0;&#x00A0;means&#x00A0;x&#x003C;=5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;right-bounded&#x00A0;closed
     &#x00A0;<br />&#x00A0;&#x00A0;:&#x003C;5&#x00A0;&#x00A0;{,5&#x003E;&#x00A0;&#x00A0;&#x003C;,5&#x003E;&#x00A0;&#x00A0;&#x00A0;means&#x00A0;x&#x003C;5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;right-bounded&#x00A0;open
</div>
     <!--l. 1355--><p class="nopar" ></p></li></ol>
<!--l. 1357--><p class="noindent" >It is very important to note that the 2nd form of set specification results in discrete values, while the 3rd form
results in a continuous interval.
</p><!--l. 1360--><p class="indent" >   Each element in a set can have its own form, i.e., one element can be a single value while another can
be an interval. If a set consists of single or bounded discrete <span 
class="cmtt-10x-x-109">start:end:incr </span>values only, the set will be
expanded to an array. This makes it possible for array operators and functions (like <span 
class="cmtt-10x-x-109">mean</span>) to be applied to
such sets. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-53">
&#x00A0;&#x00A0;WHERE&#x00A0;column&#x00A0;&#x003E;&#x00A0;mean([10,30:100:5])
</div>
<!--l. 1369--><p class="nopar" >
</p><!--l. 1371--><p class="indent" >   Another form of constructing a set is using a <a 
href="#x1-570004.11">subquery</a> as described in section 4.11.
</p><!--l. 1374--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.8   </span> <a 
 id="x1-330004.8"></a>Array Index Operator</h4>
<!--l. 1375--><p class="noindent" >It is possible to take a subsection or a single element from an array column, keyword or expression using
the index operator <span 
class="cmtt-10x-x-109">[index1,index2,...]</span>. This syntax is similar to that used in Python or Glish. Taking
a single element can be done as:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-54">
&#x00A0;&#x00A0;array[1,&#x00A0;2]
&#x00A0;<br />&#x00A0;&#x00A0;array[1,&#x00A0;some_expression]
</div>
<!--l. 1384--><p class="nopar" > Taking a subsection can be done as:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-55">
&#x00A0;&#x00A0;array[start1:end1:incr1,&#x00A0;start2:end2:incr2,&#x00A0;...]
</div>
<!--l. 1388--><p class="nopar" > If a start value is left out it defaults to the beginning of that axis. An end value defaults to the end of the
axis and an increment defaults to one. If an entire axis is left out, it defaults to the entire axis.
<br 
class="newline" />E.g. an array with shape [10,15,20] can be subsectioned as:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-56">
&#x00A0;&#x00A0;[,,3]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;resulting&#x00A0;in&#x00A0;an&#x00A0;array&#x00A0;of&#x00A0;shape&#x00A0;[10,15,1]
&#x00A0;<br />&#x00A0;&#x00A0;[2:4,&#x00A0;::3,&#x00A0;2:15:2]&#x00A0;&#x00A0;resulting&#x00A0;in&#x00A0;an&#x00A0;array&#x00A0;of&#x00A0;shape&#x00A0;[3,5,7]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(NB.&#x00A0;shape&#x00A0;is&#x00A0;[2,5,7]&#x00A0;for&#x00A0;python&#x00A0;style)
</div>
<!--l. 1398--><p class="nopar" > The examples show that an index can be a simple constant (as it will usually be). It can also be an
expression which can be as complex as one likes. The expression has to result in a positive real value
which will be truncated to an integer length. <br 
class="newline" />For fixed shaped arrays checking if array bounds are exceeded is done at parse time. For variable shaped
arrays it can only be done per row. If array bounds are exceeded, an exception is thrown. In the future a
special undefined value will be assigned if bounds of variable shaped arrays are exceeded to prevent the
selection process from aborting due to the exception.
</p><!--l. 1411--><p class="indent" >   Note that the index operator will be applied directly to a column. This results in reading only the
required part of the array from the table column on disk. It is, however, also possible to apply it to a
subexpression (enclosed in parentheses) resulting in an array. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-57">
&#x00A0;&#x00A0;arraycolumn[2,3,4]&#x00A0;+&#x00A0;1
&#x00A0;<br />&#x00A0;&#x00A0;(arraycolumn&#x00A0;+&#x00A0;1)[2,3,4]
</div>
<!--l. 1420--><p class="nopar" > can both be used and have the same result. However, the first form is much faster, because only a single
element is read (resulting in a scalar) and 1 is added to it. The second form results in reading
the entire array. 1 is added to all elements and only then the requested element is taken.
<br 
class="newline" />From this example it should be clear that indexing an array expression has to be done with
care.
</p><!--l. 1429--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.9   </span> <a 
 id="x1-340004.9"></a>Units</h4>
<!--l. 1430--><p class="noindent" >Units can be given at many places in an expression; in fact, each subexpression can be ended with a unit
meaning that the subexpression result gets that unit or will be converted to that unit. A simple unit (only
letters) can always be given literally. A non-simple unit can be given literally if only containing digits,
underscores and/or dots (e.g. <span 
class="cmtt-10x-x-109">m2</span>, <span 
class="cmtt-10x-x-109">fl</span><span 
class="cmtt-10x-x-109">_oz</span>. or <span 
class="cmtt-10x-x-109">m.m</span>). Otherwise the unit has to be enclosed in single or double
quotes (e.g. <span 
class="cmtt-10x-x-109">&#8217;m/s&#8217;</span>) or the backslash has to be used as escape character (e.g. <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">in </span>or <span 
class="cmtt-10x-x-109">m</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">\</span></span></span><span 
class="cmtt-10x-x-109">/s</span>).
<br 
class="newline" />Arguments to functions like <span 
class="cmtt-10x-x-109">sin </span>will be converted to the appropriate unit (radians) as needed. In a similar
way, the units of operands to operators like addition, will be converted as needed. An exception is thrown
if a unit conversion is not possible.
</p><!--l. 1444--><p class="indent" >   All units supported by module <a 
href="../html/group__Quanta__module.html" >Quanta</a> can be used. Note that the units are case sensitive. Most
common units use lowercase characters. A unit can be preceeded by a scaling prefix (like <span 
class="cmtt-10x-x-109">k </span>for kilo). In
glish one can use <span 
class="cmtt-10x-x-109">dq.map() </span>to see the available units and prefixes. Compound units are created when
multiplying or dividing values with units.
</p><!--l. 1453--><p class="indent" >   Units can be given as follows: </p>
     <ul class="itemize1">
     <li class="itemize">If a column has a unit defined in column keyword <span 
class="cmtt-10x-x-109">QuantumUnits </span>or <span 
class="cmtt-10x-x-109">UNIT</span>, it automatically
     gets that unit.
     </li>
     <li class="itemize">A constant can immediately be followed by a simple unit.. E.g. <span 
class="cmtt-10x-x-109">2deg</span>.
     </li>
     <li class="itemize">The result of several expressions have an implicit unit. <br 
class="newline" />Constants given as positions are in radians (rad). <br 
class="newline" />Difference of 2 dates is in days (d). <br 
class="newline" />Inverse trigonometric functions like <span 
class="cmtt-10x-x-109">asin </span>give radians.
                                                                                         

                                                                                         
     </li>
     <li class="itemize">When combining values with different units in e.g. an interval, a set, an addition, or a function like
     <span 
class="cmtt-10x-x-109">min</span>, the values are converted to the unit of the first operand or argument with a unit.
     Values without a unit have by default the unit of the first operand or argument with a
     unit.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-58">
     &#x00A0;&#x00A0;3mm-7cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;-67&#x00A0;mm
     &#x00A0;<br />&#x00A0;&#x00A0;3+3mm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;6&#x00A0;mm
     &#x00A0;<br />&#x00A0;&#x00A0;3mm&#x003C;:&#x003C;3cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;interval&#x00A0;&#x003C;3mm,30mm&#x003E;
     &#x00A0;<br />&#x00A0;&#x00A0;[3,4cm,5]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;[3cm,&#x00A0;4cm,&#x00A0;5cm]
     &#x00A0;<br />&#x00A0;&#x00A0;[5,&#x00A0;7cm,&#x00A0;8mm]&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;[5cm,&#x00A0;7cm,&#x00A0;0.8cm]
     &#x00A0;<br />&#x00A0;&#x00A0;[5,&#x00A0;7mm,&#x00A0;8cm]&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;[5mm,&#x00A0;7mm,&#x00A0;80mm]
     &#x00A0;<br />&#x00A0;&#x00A0;max(3mm,2cm)&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;20&#x00A0;mm
     &#x00A0;<br />&#x00A0;&#x00A0;5&#x00A0;&#8217;km/h&#8217;&#x00A0;+&#x00A0;1&#x00A0;&#8217;m/s&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;is&#x00A0;8.6&#x00A0;km/h
     &#x00A0;<br />&#x00A0;&#x00A0;iif(F,3min,30sec)&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;is&#x00A0;0.5&#x00A0;min
</div>
     <!--l. 1479--><p class="nopar" >
     </p></li>
     <li class="itemize">Similarly operands of comparison operators and arguments of comparison functions (like <span 
class="cmtt-10x-x-109">near</span>) are
     converted to the unit of the first operand or argument with a unit.
     </li>
     <li class="itemize">The result of a multiplication and division is a compound unit if both operands have a unit.
     Otherwise it is the unit of the argument with a unit. <br 
class="newline" />Before TaQL supported units, it was needed to divide the TIME column in a MeasurementSet by
     86400 to convert it to days, so it could be compared with a given date/time. So, for
     backward compatibility, a division of a value with unit <span 
class="cmtt-10x-x-109">s </span>by a constant 86400 results in unit
     <span 
class="cmtt-10x-x-109">d</span>.
     </li>
     <li class="itemize">The result of functions like <span 
class="cmtt-10x-x-109">SUMSQR </span>and <span 
class="cmtt-10x-x-109">SQRT </span>is a compound unit if the argument has a unit. Note
     that <span 
class="cmtt-10x-x-109">sqrt(2m) </span>will fail, because the square root of a meter does not exist.
     </li>
     <li class="itemize">A (sub)expression can be followed by a simple or compound unit. If the subexpression has
     no unit, it gets the given unit. Otherwise the resulting value is converted to the unit.
     <br 
class="newline" />Note that some units can be the same as a <a 
href="#x1-70002.4">reserved word</a> (e.g. <span 
class="cmtt-10x-x-109">as </span>or <span 
class="cmtt-10x-x-109">in</span>). In that case it has to be
     escaped or enclosed in quotes.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-59">
     &#x00A0;&#x00A0;COL&#x00A0;\in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;set/convert&#x00A0;column&#x00A0;COL&#x00A0;to&#x00A0;inch
     &#x00A0;<br />&#x00A0;&#x00A0;3&#x00A0;cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;3&#x00A0;cm
     &#x00A0;<br />&#x00A0;&#x00A0;3&#x00A0;&#8217;km/s&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;3&#x00A0;km/second
     &#x00A0;<br />&#x00A0;&#x00A0;3mm&#x00A0;cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;0.3&#x00A0;cm
     &#x00A0;<br />&#x00A0;&#x00A0;(3mm&#x00A0;cm)m&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;0.003&#x00A0;m
     &#x00A0;<br />&#x00A0;&#x00A0;(3+3)&#x00A0;cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;6&#x00A0;cm
     &#x00A0;<br />&#x00A0;&#x00A0;(3+3mm)&#x00A0;cm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;0.6&#x00A0;cm
     &#x00A0;<br />&#x00A0;&#x00A0;[3,4,5]mm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;[3mm,&#x00A0;4mm,&#x00A0;5mm]
     &#x00A0;<br />&#x00A0;&#x00A0;[3,4cm,5]mm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;[30mm,&#x00A0;40mm,&#x00A0;50mm]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Note:&#x00A0;all&#x00A0;values&#x00A0;in&#x00A0;the&#x00A0;set&#x00A0;first&#x00A0;get&#x00A0;the&#x00A0;same&#x00A0;unit&#x00A0;cm
     &#x00A0;<br />&#x00A0;&#x00A0;asin(1)&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;pi/2&#x00A0;radians
     &#x00A0;<br />&#x00A0;&#x00A0;asin(1)&#x00A0;deg&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;90&#x00A0;degrees
     &#x00A0;<br />&#x00A0;&#x00A0;(3mm+7cm)&#x00A0;m&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;result&#x00A0;is&#x00A0;0.073&#x00A0;m
</div>
     <!--l. 1516--><p class="nopar" >
     </p></li>
     <li class="itemize">If a function argument is expected in a certain unit, values are converted as needed.
     For example, arguments to functions <span 
class="cmtt-10x-x-109">sin </span>and <span 
class="cmtt-10x-x-109">anycone </span>are automatically converted to
     radians.
     </li>
     <li class="itemize">When adding or subtracting a value from a date, that value is converted to unit <span 
class="cmtt-10x-x-109">d </span>(days).</li></ul>
<!--l. 1524--><p class="noindent" >Units will probably mostly be used in an expression in the WHERE clause or in a CALC command. However,
it is also possible to use a unit in the selection of a column in the SELECT clause. For example:
<br 
class="newline" /><span 
class="cmtt-10x-x-109">select TIME d as TIMED from my.ms </span>In such a case the selection is an expression and the unit is stored
in the column keywords. Thus in this example, TIME is stored in a column <span 
class="cmtt-10x-x-109">TIMED </span>with keyword
<span 
class="cmtt-10x-x-109">QuantumUnits=d </span>and the values are converted to days.
</p><!--l. 1533--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.10   </span> <a 
 id="x1-350004.10"></a>Functions</h4>
<!--l. 1534--><p class="noindent" >More than 100 functions exist to operate on scalar and/or array values. Some functions have two names.
One name is the CASA/Glish name, while the other is the name as used in SQL. In the following tables
the function names are shown in uppercase, while the result and argument types are shown in lowercase.
Note, however, that function names are case-insensitive. <br 
class="newline" />Furthermore it is possible to have <a 
href="#x1-500004.10.15">user defined functions</a> that are dynamically loaded from a shared
library. In section <a 
href="#x1-8400012">Writing user defined functions</a> it is explained how to write user defined functions.
<br 
class="newline" />A set of standard UDFs exists dealing with <a 
href="#x1-540004.10.17">Measure conversions</a>, for example to convert J2000 to
apparent. Another set of UDFs deals with measures in <a 
href="#x1-510004.10.16">MeasurementSets and Calibration
Tables</a>.
</p><!--l. 1549--><p class="indent" >   <a 
href="#x1-320004.7">Sets</a>, and in particular <a 
href="#x1-570004.11">subqueries</a>, can result in a 1-dim array. This means that the functions accepting
an array argument can also be used on a set or the result of a subquery.
</p><!--l. 1554--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.1   </span> <a 
 id="x1-360004.10.1"></a>String functions</h5>
<!--l. 1555--><p class="noindent" >These functions can be used on a scalar or an array argument.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer STRLENGTH(string), integer LEN(string)</span><br 
class="newline" />Returns the number of characters in a string (trailing whitespace is significant).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string UPCASE(string), string UPPER(string) </span><br 
class="newline" />Convert to uppercase.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string DOWNCASE(string), string LOWER(string)</span><br 
class="newline" />Convert to lowercase.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CAPITALIZE(string)</span><br 
class="newline" />Capitalize a string (make first letter uppercase).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string LTRIM(string)</span><br 
class="newline" />Removes leading whitespace.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string RTRIM(string)</span><br 
class="newline" />Removes trailing whitespace.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string TRIM(string)</span><br 
class="newline" />Removes leading and trailing whitespace.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string SUBSTR(string, integer ST, integer N)</span><br 
class="newline" />Returns a substring starting at the 0-based position <span 
class="cmtt-10x-x-109">ST </span>with a length of at most <span 
class="cmtt-10x-x-109">N </span>characters.
     If the string argument is an array of strings, an array with the substring of each string is
     returned. The arguments N and ST have to be scalar values. They will be set to 0 if negative.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string REPLACE(string SRC, PATTERN, string REPL)</span><br 
class="newline" />Replaces all occurrences of PATTERN in SRC by REPL and returns the result. REPL can
     be omitted and defaults to the empty string. If the first argument is an array of strings, each
     element in the array is replaced. The arguments PATTERN and REPL have to be scalar
     values. PATTERN can be a string or a regular expression (see below). For example: <br 
class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">REPLACE("abcdab",</span><span 
class="cmtt-10x-x-109">&#x00A0;"ab")</span></span></span> results in <span 
class="cmtt-10x-x-109">cd </span><br 
class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">REPLACE("abcdab",</span><span 
class="cmtt-10x-x-109">&#x00A0;REGEX("^ab"),</span><span 
class="cmtt-10x-x-109">&#x00A0;"xyz")</span></span></span> results in <span 
class="cmtt-10x-x-109">xyzcdab</span></dd></dl>
<!--l. 1589--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.2   </span> <a 
 id="x1-370004.10.2"></a>Regex functions</h5>
<!--l. 1590--><p class="noindent" >Apart from using <a 
href="#x1-250004.3.6">regex/pattern constants</a>, it is possible to use functions to form a regex or pattern. These
functions can only be used on a scalar argument.
</p><!--l. 1594--><p class="indent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">regex REGEX(string)</span><br 
class="newline" />Handle the given string as a regular expression.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">regex PATTERN(string)</span><br 
class="newline" />Handle the given string as a UNIX filename-like pattern and convert it to a regular expression.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">regex SQLPATTERN(string)</span><br 
class="newline" />Handle the given string as an SQL-style pattern and convert it to a regular expression.</dd></dl>
<!--l. 1604--><p class="noindent" >A regex formed this way can only be used in a comparison == or !=. E.g. <br 
class="newline" /><span 
class="cmtt-10x-x-109">object == pattern(&#8217;3C*&#8217;) </span><br 
class="newline" />to find all 3C objects in a catalogue.
</p><!--l. 1608--><p class="indent" >   A few remarks:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-37002x1">The regex/pattern functions and operator LIKE work on any string, thus they can be used
     with any string expression.
     </li>
     <li 
  class="enumerate" id="x1-37004x2">A Regex is case sensitive. One should use function <span 
class="cmtt-10x-x-109">upcase </span>or <span 
class="cmtt-10x-x-109">downcase </span>on the string to test
     to make it case insensitive or use the <span 
class="cmti-10x-x-109">i </span>qualifier on a regex constant.
     </li>
     <li 
  class="enumerate" id="x1-37006x3">Usually a regex/pattern must match the full string, thus not part of it. However, one can use
     the <span 
class="cmtt-10x-x-109">m// </span>regex constant to do partial matching. Thus something like <span 
class="cmtt-10x-x-109">m/xx/ </span>matches all strings
     containing <span 
class="cmtt-10x-x-109">xx</span>. Of course, <span 
class="cmtt-10x-x-109">regex(&#8217;.*xx.*&#8217;) </span>can also be used. In this way the <span 
class="cmtt-10x-x-109">m// </span>regex works
     the same as in languages like Perl, Python, and Glish.</li></ol>
                                                                                         

                                                                                         
<!--l. 1623--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.3   </span> <a 
 id="x1-380004.10.3"></a>Date/time functions</h5>
<!--l. 1624--><p class="noindent" >These functions make it possible to handle dates/times and can be used on a scalar or an array argument.
The syntax of a date/time string or constant is explained in <a 
href="#x1-260004.3.7">section 4.3.7</a>.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">DateTime DATETIME(string)</span><br 
class="newline" />Parse the string and convert it to a DateTime value.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">DateTime MJDTODATE(real)</span><br 
class="newline" />The real value, which has to be a MJD (ModifiedJulianDate), is converted to a DateTime.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MJD(DateTime)</span><br 
class="newline" />Get the DateTime as MJD (ModifiedJulianDate) in days.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">DateTime DATE(DateTime)</span><br 
class="newline" />Get the date (i.e., remove the time part). This function is needed in something like: <br 
class="newline" /><span 
class="cmtt-10x-x-109">DATE(column) == 12Feb1997 </span><br 
class="newline" />if the column contains date/times with times<!--l. 1640--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>0.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double TIME(DateTime)</span><br 
class="newline" />Get the time part of the day. It is converted to radians to be compatible with the internal
     representation of times/positions. In that way the function can easily be used as in: <br 
class="newline" /><span 
class="cmtt-10x-x-109">TIME(date) </span><!--l. 1645--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>
     <span 
class="cmtt-10x-x-109">12h</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer YEAR(DateTime)</span><br 
class="newline" />Get the year (which includes the century).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer MONTH(DateTime)</span><br 
class="newline" />Get the month number (1-12).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer DAY(DateTime)</span><br 
class="newline" />Get the day number (1-31).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer WEEK(DateTime)</span><br 
class="newline" />Get the week number in the year (0 ... 53). <br 
class="newline" />Note that week 1 is the week containing Jan 4th.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer WEEKDAY(DateTime), integer DOW(DateTime)</span><br 
class="newline" />Get the weekday number (1=Monday, ..., 7=Sunday).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CDATETIME(DateTime), string CTOD(DateTime)</span><br 
class="newline" />Get the DateTime as a string like YYYY/MM/DD/HH:MM:SS.SSS.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CDATE(DateTime)</span><br 
class="newline" />Get the date part of a DateTime as a string like DD-MMM-YYYY.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CTIME(DateTime)</span><br 
class="newline" />Get the time part of a DateTime as a string like HH:MM:SS.SSS.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CMONTH(DateTime)</span><br 
class="newline" />Get the abbreviated name of the month (Jan ... Dec).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string CWEEKDAY(DateTime), string CDOW(DateTime)</span><br 
class="newline" />Get the abbreviated name of the weekday (Mon ... Sun).</dd></dl>
<!--l. 1668--><p class="noindent" >All functions can be used without an argument in which case the current date/time is used. E.g. <span 
class="cmtt-10x-x-109">DATE()</span>
results in the current date. <br 
class="newline" />It is possible to give a string argument instead of a date. In this case the string is parsed and converted to
a date (i.e., the function DATETIME is used implicitly).
</p><!--l. 1674--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.4   </span> <a 
 id="x1-390004.10.4"></a>Pretty printing functions</h5>
<!--l. 1675--><p class="noindent" >Angles (scalar or array) can be returned as strings in HMS and/or DMS format. Currently, they are
always formatted with 3 decimals in the seconds.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string HMS(real)</span><br 
class="newline" />Return angle(s) like 12h34m56.789
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string DMS(real)</span><br 
class="newline" />Return angle(s) like 12d34m56.789
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string HDMS(realarray)</span><br 
class="newline" />Return angles like 12h34m56.789 (even elements) and 12d34m56.789 (odd elements). It is
     useful for arrays containing RA,DEC values.</dd></dl>
                                                                                         

                                                                                         
<!--l. 1686--><p class="noindent" >The functions mentioned above and the date/time functions in the previous subsection can format a value in
a predefined way only. <br 
class="newline" />The <span 
class="cmtt-10x-x-109">string </span>(shorthand <span 
class="cmtt-10x-x-109">str</span>) function makes it possible to convert values to strings using an optional
format string or width.precision value. It also makes it possible to format dates, times, and angles in a
variety of ways.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">string STRING(value, [format]), string STR(value, [format])</span></dd></dl>
<!--l. 1695--><p class="noindent" >The value can be of any type (except Regex) and can be a scalar or array. The optional format must be a
scalar string or numeric value. If no format is given, an appropriate default format will be used.
</p>
     <ul class="itemize1">
     <li class="itemize">A numeric format value defines the width and/or precision. For example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-60">
     &#x00A0;&#x00A0;8&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;defines&#x00A0;width&#x00A0;8&#x00A0;and&#x00A0;default&#x00A0;precision
     &#x00A0;<br />&#x00A0;&#x00A0;20.12&#x00A0;&#x00A0;&#x00A0;&#x00A0;defines&#x00A0;width&#x00A0;20&#x00A0;and&#x00A0;precision&#x00A0;12
     &#x00A0;<br />&#x00A0;&#x00A0;.8&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;defines&#x00A0;precision&#x00A0;8&#x00A0;and&#x00A0;default&#x00A0;width
</div>
     <!--l. 1704--><p class="nopar" > In this way precision represents all digits, not only the ones behind the decimal point. A default
     width or precision is used if not given.
     </p></li>
     <li class="itemize">A string format value can contain a <span 
class="cmtt-10x-x-109">printf</span>-style format string, which must include the %-sign. Note
     that the real and imaginary part of a complex value are formatted separately, so such a format
     string needs to contain a format specifier for both parts. See <a 
href="http://www.cplusplus.com/reference/cstdio/printf" >printf reference</a> for possible format
     specifiers. For example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-61">
     &#x00A0;&#x00A0;%10d&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;decimal&#x00A0;with&#x00A0;width&#x00A0;10
     &#x00A0;<br />&#x00A0;&#x00A0;%010d&#x00A0;&#x00A0;&#x00A0;&#x00A0;decimal&#x00A0;with&#x00A0;width&#x00A0;10&#x00A0;and&#x00A0;filled&#x00A0;with&#x00A0;zeroes
     &#x00A0;<br />&#x00A0;&#x00A0;%f+%fi&#x00A0;&#x00A0;&#x00A0;to&#x00A0;format&#x00A0;a&#x00A0;complex&#x00A0;value&#x00A0;as&#x00A0;a+bi
</div>
     <!--l. 1720--><p class="nopar" > Apart from a <span 
class="cmtt-10x-x-109">printf</span>-style format string, it is also possible to define a string to format date/time
     and angle values (which are automatically converted to radians if containing units).
     <br 
class="newline" />Such a format string contains one or more format values as defined in class <a 
href="../html/classcasa_1_1MVTime.html" >MVTime</a>. A vertical bar
     (with optional whitespace) must be used as separator. A string part can be a numeric value defining
     the precision of the time/angle. For example:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-62">
     &#x00A0;&#x00A0;YMD&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;format&#x00A0;as&#x00A0;YYYY/MM/DD/HH:MM:SS
     &#x00A0;<br />&#x00A0;&#x00A0;DMY|NO_TIME&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;format&#x00A0;as&#x00A0;DD-MMM-YYYY
     &#x00A0;<br />&#x00A0;&#x00A0;DMY&#x00A0;|&#x00A0;DAY&#x00A0;|&#x00A0;8&#x00A0;&#x00A0;&#x00A0;format&#x00A0;as&#x00A0;Thu-DD-MMM-YYY/HH:MM:SS.SS
     &#x00A0;<br />&#x00A0;&#x00A0;TIME&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;format&#x00A0;a&#x00A0;date&#x00A0;or&#x00A0;angle&#x00A0;as&#x00A0;HH:MM:SS
     &#x00A0;<br />&#x00A0;&#x00A0;ANGLE|9&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;format&#x00A0;an&#x00A0;angle&#x00A0;as&#x00A0;DD.MM.SS.SSS
</div>
     <!--l. 1735--><p class="nopar" > If such a format string contains an invalid part, it is assumed that the entire string is a <span 
class="cmtt-10x-x-109">printf</span>-style
     format string.</p></li></ul>
<!--l. 1740--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.5   </span> <a 
 id="x1-400004.10.5"></a>Comparison functions</h5>
<!--l. 1741--><p class="noindent" >The exact comparison of floating point values is quite tricky. Two functions make it possible to compare 2
double or complex values with a tolerance. They can be used on scalar and array arguments (and a mix of
them). The tolerance must be a scalar though.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool NEAR(numeric val1, numeric val2, double tol)</span><br 
class="newline" />Tests in a relative way if a value is near another. Relative means that the magnitude of the
     numbers is taken into account. <br 
class="newline" />It returns <span 
class="cmtt-10x-x-109">abs(val2 - val1)/max(abs(val1),abs(val2)) &#x003C; tol</span>. <br 
class="newline" />If <span 
class="cmtt-10x-x-109">tol&#x003C;=0</span>, it returns <span 
class="cmtt-10x-x-109">val1==val2</span>. If either val is 0.0, it takes care of area around the minimum
     number that can be represented. The default tolerance is 1.0e-13.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool NEARABS(numeric val1, numeric val2, double tol)</span><br 
class="newline" />Tests in an absolute way if a value is near another. Absolute means that the magnitude of
     the numbers is not taken into account. <br 
class="newline" />It returns <span 
class="cmtt-10x-x-109">abs(val2 - val1) &#x003C; tol</span>. The default tolerance is 1.0e-13.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ISNAN(numeric val)</span><br 
class="newline" />Tests if a numeric value is a NaN (not-a-number).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ISINF(numeric val)</span><br 
class="newline" />Tests if a numeric value is infinite (positive or negative).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ISFINITE(numeric val)</span><br 
class="newline" />Tests if a numeric value is a finite number (not NaN or infinite).</dd></dl>
                                                                                         

                                                                                         
<!--l. 1771--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.6   </span> <a 
 id="x1-410004.10.6"></a>Mathematical functions</h5>
<!--l. 1772--><p class="noindent" >Standard mathematical can be used on scalar and array arguments (and a mix of them).
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double PI()</span><br 
class="newline" />Return the value of <span 
class="cmbx-10x-x-109">pi</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double E()</span><br 
class="newline" />Return the value of <span 
class="cmbx-10x-x-109">e </span>(is equal to <span 
class="cmtt-10x-x-109">EXP(1)</span>).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double C()</span><br 
class="newline" />Return the value of the speed of light (with unit m/s).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric SIN(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric SINH(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ASIN(real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric COS(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric COSH(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ACOS(real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double TAN(real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double TANH(real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ATAN(real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ATAN2(real y, real x)</span><br 
class="newline" />Return <span 
class="cmtt-10x-x-109">ATAN(y/x) </span>in correct quadrant.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric EXP(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric LOG(numeric)</span><br 
class="newline" />Natural logarithm.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric LOG10(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric POW(numeric, numeric)</span><br 
class="newline" />The same as operator <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">**</span></span></span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric SQUARE(numeric), numeric SQR(numeric)</span><br 
class="newline" />The same as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">**</span></span></span>2, but much faster.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric SQRT(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">complex COMPLEX(real, real)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">dnumeric CONJ(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double REAL(numeric)</span><br 
class="newline" />Real part of a complex number. Returns argument if real.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double IMAG(numeric)</span><br 
class="newline" />Imaginary part of a complex number. Returns 0 if argument is real.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real NORM(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real ABS(numeric), real AMPLITUDE(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ARG(numeric), double PHASE(numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric MIN(numeric, numeric)</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric MAX(numeric, numeric)</span>
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real SIGN(real)</span><br 
class="newline" />Return -1 for a negative value, 0 for zero, 1 for a positive value.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real ROUND(real)</span><br 
class="newline" />Return the rounded value of the number. Negative numbers are rounded in an absolute way.
     E.g. <span 
class="cmtt-10x-x-109">ROUND(-1.6) = -2.</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real FLOOR(real)</span><br 
class="newline" />Works towards negative infinity. E.g. <span 
class="cmtt-10x-x-109">FLOOR(-1.2) = -2.</span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real CEIL(real)</span><br 
class="newline" />Works towards positive infinity.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real FMOD(real, real)</span><br 
class="newline" />The same as operator %.</dd></dl>
<!--l. 1825--><p class="noindent" >Note that the trigonometric functions need their arguments in radians.
</p><!--l. 1827--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.7   </span> <a 
 id="x1-420004.10.7"></a>Array to scalar reduction functions</h5>
<!--l. 1828--><p class="noindent" >The following functions reduce an array to a scalar. They are meant for an array, but can also be used for
a scalar.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ANY(bool)</span><br 
class="newline" />Is any element true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ALL(bool)</span><br 
class="newline" />Are all elements true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NTRUE(bool)</span><br 
class="newline" />Return number of true elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NFALSE(bool)</span><br 
class="newline" />Return number of false elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric SUM(numeric)</span><br 
class="newline" />Return sum of all elements.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric SUMSQUARE(numeric), numeric SUMSQR(numeric)</span><br 
class="newline" />Return sum of all squared elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric PRODUCT(numeric)</span><br 
class="newline" />Return product of all elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real MIN(real)</span><br 
class="newline" />Return minimum of all elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real MAX(real)</span><br 
class="newline" />Return maximum of all elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MEAN(real)</span><br 
class="newline" />Return mean of all elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double VARIANCE(real)</span><br 
class="newline" />Return variance (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i) - mean(a))**2/(nelements(a) - 1)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double STDDEV(real)</span><br 
class="newline" />Return standard deviation (the square root of the variance).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double AVDEV(real)</span><br 
class="newline" />Return average deviation. (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">abs(a[i] - mean(a))/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RMS(real)</span><br 
class="newline" />Return root-mean-squares. (the square root of the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i)**2)/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MEDIAN(real)</span><br 
class="newline" />Return median (the middle element). If the array has an even number of elements, the mean
     of the two middle elements is returned.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double FRACTILE(real, doublescalar fraction)</span><br 
class="newline" />Return the value of the element at the given fraction. Fraction 0.5 is the same as the median.</dd></dl>
                                                                                         

                                                                                         
<!--l. 1871--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.8   </span> <a 
 id="x1-430004.10.8"></a>Array to array reduction functions</h5>
<!--l. 1872--><p class="noindent" >These functions reduce an array to a smaller array by collapsing the given axes using the given function.
The axes are the last argument(s). They can be given in two ways: <br 
class="newline" />- As a single set argument; for example, <span 
class="cmtt-10x-x-109">maxs(ARRAY,[1,2]) </span><br 
class="newline" />- As individual scalar arguments; for example, <span 
class="cmtt-10x-x-109">maxs(ARRAY,1,2) </span><br 
class="newline" />For example, using <span 
class="cmtt-10x-x-109">MINS(array,1,2) </span>for a 3-dim array results in a 1-dim array where each value is the
minimum of each plane in the cube. <br 
class="newline" />It is important to note that the interpretation of the axes numbers depends on the style being used. E.g.
when using glish style, axes numbers are 1-based and in Fortran order, thus axis 1 is the
most rapidly varying axis. When using python style, axis 0 is the most slowly varying axis.
<br 
class="newline" />Axes numbers exceeding the dimensionality of the array are ignored. For example, <span 
class="cmtt-10x-x-109">maxs(ARRAY,[2:10])</span>
works for arrays of virtually any dimensionality and results in a 1-dim array. <br 
class="newline" />The function names are the &#8217;plural&#8217; forms of the functions in the previous section. They can only be used
for arrays, thus not for scalars.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ANYS(bool)</span><br 
class="newline" />Is any element true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ALLS(bool)</span><br 
class="newline" />Are all elements true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NTRUES(bool)</span><br 
class="newline" />Return number of true elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NFALSES(bool)</span><br 
class="newline" />Return number of false elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric SUMS(numeric)</span><br 
class="newline" />Return sum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric SUMSQUARES(numeric), numeric SUMSQRS(numeric)</span><br 
class="newline" />Return sum of squared elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">numeric PRODUCTS(numeric)</span><br 
class="newline" />Return product of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real MINS(real)</span><br 
class="newline" />Return minimum of elements.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">real MAXS(real)</span><br 
class="newline" />Return maximum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MEANS(real)</span><br 
class="newline" />Return mean of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double VARIANCES(real)</span><br 
class="newline" />Return variance (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i) - mean(a))**2/(nelements(a) - 1)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double STDDEVS(real)</span><br 
class="newline" />Return standard deviation (the square root of the variance).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double AVDEVS(real)</span><br 
class="newline" />Return average deviation. (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">abs(a(i) - mean(a))/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RMSS(real)</span><br 
class="newline" />Return root-mean-squares. (the square root of the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i)**2)/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MEDIANS(real)</span><br 
class="newline" />Return median (the middle element). If the array has an even number of elements, the mean
     of the two middle elements is returned.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double FRACTILES(real, doublescalar fraction)</span><br 
class="newline" />Return the value of the element at the given fraction. Fraction 0.5 is the same as the median.</dd></dl>
<!--l. 1931--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.9   </span> <a 
 id="x1-440004.10.9"></a>Array downsampling functions</h5>
<!--l. 1932--><p class="noindent" >These functions are a generalization of the functions in the previous section. They downsample an array
by taking, say, the mean of every n*m elements. The functions in the previous section downsample by
taking the mean of a full line or plane, etc. The most useful one is probably calculating the boxed mean,
but the other ones can be used similarly. The width of each window axis has to be given. Missing axes
default to 1. Similarly to the partial reduction functions described above, the axes can be given as scalars
or as a set. <br 
class="newline" />For example, <span 
class="cmtt-10x-x-109">BOXEDMEAN(array,3,3) </span>calculates the mean in each 3x3 box. At the end of an axis the box
                                                                                         

                                                                                         
used will be smaller if it does not fit integrally. <br 
class="newline" />The functions can only be used for arrays, thus not for scalars.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool BOXEDANY(bool)</span><br 
class="newline" />Is any element true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool BOXEDALL(bool)</span><br 
class="newline" />Are all elements true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDMIN(real)</span><br 
class="newline" />Return minimum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDMAX(real)</span><br 
class="newline" />Return maximum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDMEAN(real)</span><br 
class="newline" />Return mean of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDVARIANCE(real)</span><br 
class="newline" />Return variance (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i) - mean(a))**2/(nelements(a) - 1)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDSTDDEV(real)</span><br 
class="newline" />Return standard deviation (the square root of the variance).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDAVDEV(real)</span><br 
class="newline" />Return average deviation. (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">abs(a(i) - mean(a))/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDRMS(real)</span><br 
class="newline" />Return root-mean-squares. (the square root of the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i)**2)/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double BOXEDMEDIAN(real)</span><br 
class="newline" />Return median (the middle element).</dd></dl>
                                                                                         

                                                                                         
<!--l. 1972--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.10   </span> <a 
 id="x1-450004.10.10"></a>Array functions operating in running windows</h5>
<!--l. 1973--><p class="noindent" >These functions transform an array into an array with the same shape by operating on a rectangular
window around each array element. The most useful one is probably calculating the running median, but
the other ones can be used similarly. The half-width of each window axis has to be given;
the full width is <span 
class="cmtt-10x-x-109">2*halfwidth + 1</span>. Missing axes default to a half-width of 0. Similarly to
the partial reduction functions described above, the axes can be given as scalars or as a set.
<br 
class="newline" />For example, <span 
class="cmtt-10x-x-109">RUNNINGMEDIAN(array,1,1) </span>calculates the median in a 3x3 box around each array element.
See the <a 
href="#x1-7300010.2.1">examples</a> how it is applied to an image. <br 
class="newline" />In the result the edge elements (i.e. the elements where no full window can be applied) are set to 0 (or
false). <br 
class="newline" />The functions can only be used for arrays, thus not for scalars.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool RUNNINGANY(bool)</span><br 
class="newline" />Is any element true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool RUNNINGALL(bool)</span><br 
class="newline" />Are all elements true?
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGMIN(real)</span><br 
class="newline" />Return minimum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGMAX(real)</span><br 
class="newline" />Return maximum of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGMEAN(real)</span><br 
class="newline" />Return mean of elements.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGVARIANCE(real)</span><br 
class="newline" />Return variance (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i) - mean(a))**2/(nelements(a) - 1)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGSTDDEV(real)</span><br 
class="newline" />Return standard deviation (the square root of the variance).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGAVDEV(real)</span><br 
class="newline" />Return average deviation. (the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">abs(a(i) - mean(a))/nelements(a)</span>.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGRMS(real)</span><br 
class="newline" />Return root-mean-squares. (the square root of the sum of <br 
class="newline" /><span 
class="cmtt-10x-x-109">(a(i)**2)/nelements(a)</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RUNNINGMEDIAN(real)</span><br 
class="newline" />Return median (the middle element).</dd></dl>
<!--l. 2014--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.11   </span> <a 
 id="x1-460004.10.11"></a>Type conversion functions</h5>
<!--l. 2015--><p class="noindent" >Explicit type conversions can be done using one of the functions below. They can operate on scalars and
arrays.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer INT(numeric or bool or string)</span><br 
class="newline" />Convert the argument to an integer. A real number is truncated (-10.9 results in -10). For a
     complex number the truncated real part is taken. A bool is converted to 0 (False) or 1 (True).
     It does not check if a string represent a valid integer. It is interpreted until the first non-valid
     character, so a string containing a floating point value is truncated.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double REAL(numeric or bool or string)</span><br 
class="newline" />Convert the argument to a real number. For a complex number the real part is taken. A bool
     is converted to 0 (False) or 1 (True). It does not check if a string represent a valid floating
     point value. A string is interpreted until the first non-valid character.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">complex COMPLEX(real,real)</span><br 
class="newline" />Form a complex number from the given real and imaginary part.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">complex COMPLEX(string)</span><br 
class="newline" />Convert the string to a complex number. The number can be given like <span 
class="cmtt-10x-x-109">(1,2) </span>or <span 
class="cmtt-10x-x-109">1+2i</span>. In
     fact, any separator (except whitespace) between real and imaginary part is possible. It does
     not check if a string represent a valid complex value. The string is interpreted until the first
     non-valid character, so the last character can be any character (e.g., also <span 
class="cmtt-10x-x-109">j</span>).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool BOOL(anytype)</span><br 
class="newline" />Convert the value to a bool. A numeric type (or date) results in False if the value is 0,
     otherwise True. A string is case-insensitive. False, F, No, N, -, or 0 results in False, otherwise
     True.</dd></dl>
                                                                                         

                                                                                         
<!--l. 2045--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.12   </span> <a 
 id="x1-470004.10.12"></a>Array creation functions</h5>
<!--l. 2046--><p class="noindent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytypearray ARRAY(anytype,shape)</span><br 
class="newline" />This function creates an unmasked array of the given type and shape. The shape is given in
     the last argument(s). It can be given in two ways: <br 
class="newline" />- As a single set argument; for example, <span 
class="cmtt-10x-x-109">array(0,[3,4]) </span><br 
class="newline" />- As individual scalar arguments; for example, <span 
class="cmtt-10x-x-109">array(0,3,4) </span><br 
class="newline" />The first argument gives the values the array is filled with. It can be a scalar or an array
     of any shape. To initialize the created array, the value array is flattened to a 1D array. Its
     successive values are stored in the created array. If the new array has more values than the
     value array, the value array is reset to its beginning and the process continues. <br 
class="newline" />Note that a masked array can be created from an (unmasked) array and a mask using the
     brackets operator like <span 
class="cmtt-10x-x-109">ARRAY[MASK]</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytypearray TRANSPOSE(anytypearray[,axes])</span><br 
class="newline" />This function transposes an N-dim array. If no axes are given, the array is fully transposed
     (thus all axes are reversed). Axes can be specified meaning that those axes will become the
     first axes in the output array. Non-given axes follow thereafter in their natural order. <br 
class="newline" />A possible mask is transposed as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytypearray DIAGONAL(anytypearray[,firstaxis[,diag]])</span><br 
class="newline" />This function takes the diagonal of 2-dim subarrays in an N-dim array resulting in an array
     with 1 dimension less. For a 2-dim array, it is simply the diagonal of the matrix. For a
     higher dimensional array, it takes the diagonal of each matrix defined by <span 
class="cmtt-10x-x-109">firstaxis </span>and
     <span 
class="cmtt-10x-x-109">firstaxis+1</span>. E.g. in a 3-dim array the diagonals of each XY-plane can be taken. The default
     for firstaxis is 0. <br 
class="newline" />The <span 
class="cmtt-10x-x-109">diag </span>argument tells which diagonal has to be taken. The default 0 means the main
     diagonal. A value 0 means below the main diagonal, while 0 means above the main diagonal.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytypearray ARRAYDATA(anytype)</span><br 
class="newline" />This function returns the array without a mask, thus removes the mask. If the operand is a
     scalar, it returns a 1-dim array with 1 element.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">boolarray ARRAYMASK(anytype), boolarray MASK(anytype)</span><br 
class="newline" />This function returns the mask of an array. If the array has no mask, it returns an empty
     array. If the operand is a scalar, it returns an empty array.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytypearray FLATTEN(anytype)</span><br 
class="newline" />This function flattens an N-dim array to a 1-dim array keeping the unmasked elements only.
     If the operand is a scalar, it returns a 1-dim array with 1 element.</dd></dl>
<!--l. 2092--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.13   </span> <a 
 id="x1-480004.10.13"></a>Miscellaneous functions</h5>
<!--l. 2093--><p class="noindent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ISDEFINED(anytype)</span><br 
class="newline" />Return false if the value in the current row is undefined. Is useful to test if a cell in a column
     with variable shaped arrays contains an array. It can also be used to test if a field in a record
     is defined.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NELEMENTS(anytype), integer COUNT(anytype)</span><br 
class="newline" />Return number of elements in an array (1 for a scalar).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer NDIM(anytype)</span><br 
class="newline" />Return dimensionality of an array (0 for a scalar).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integerarray SHAPE(anytype)</span><br 
class="newline" />Return shape of an array (returns an empty array for a scalar).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer ROWNUMBER(), integer ROWNR()</span><br 
class="newline" />Return the row number being tested (first row is row number 0 or 1 depending on the style
     used). <br 
class="newline" />In combination with function RAND it can, for instance, be used to select arbitrary rows
     from a table.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer ROWID()</span><br 
class="newline" />Return the row number in the original table. This is especially useful for returning the result
     of a selection of a subtable of a Casacore measurement set (see also <a 
href="#x1-570004.11">subqueries in section 4.11</a>
     and <a 
href="#x1-6900010.1">examples in section 9</a>).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double RAND()</span><br 
class="newline" />Return (per table row) a uniformly distributed random number between 0 and 1 using a
     Multiplicative Linear Congruential Generator. The seeds for the generator are deduced from
     the current date and time, so the results are different from run to run. <br 
class="newline" />The function can, for instance, be used to select a random subset from a table.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ANGDIST(arg1,arg2)</span>, <span 
class="cmtt-10x-x-109">double ANGULARDISTANCE(arg1,arg2)</span><br 
class="newline" />Return the angular distance (in radians) between the positions in <span 
class="cmtt-10x-x-109">arg1 </span>and <span 
class="cmtt-10x-x-109">arg2</span>. Both
     arguments have to be numeric arrays containing an even number of values. Two subsequent
     values give the RA and DEC (or longitude and latitude) of positions on a sphere. The result
     is a 1-dim array containing the angular distance between corresponding positions in <span 
class="cmtt-10x-x-109">arg1</span>
     and <span 
class="cmtt-10x-x-109">arg2</span>. If either array contains only one position, the result is the distance between that
     position and each position in the other array. If both arguments contain only 2 values, the
     result is a scalar. For example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">angdist(PHASE</span><span 
class="cmtt-10x-x-109">_DIR[0,], [12h13m45,4d21m39.4, 12h13m49,10d8m4]) </span><br 
class="newline" />returns an array with shape [2] containing the angular distance between the phase center of
     the field and the two positions given.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double ANGDISTX(arg1,arg2)</span>, <span 
class="cmtt-10x-x-109">double ANGULARDISTANCEX(arg1,arg2)</span><br 
class="newline" />Same as above, but the result is a 2-dim array giving the distance between each position in
     the first argument and each position in the second argument. Only if both arguments contain
     a single position, the result is a scalar.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">anytype IIF(cond,arg1,arg2)</span><br 
class="newline" />This is a special funtion which operates like the ternary <span 
class="cmtt-10x-x-109">?: </span>operator in C++. If all arguments
     are  scalars,  the  result  is  a  scalar,  otherwise  an  array.  In  the  latter  case  possible  scalar
     arguments are virtually expanded to arrays. IIF evaluates the condition for each element. If
     True, it takes the corresponding element of <span 
class="cmtt-10x-x-109">arg1</span>, otherwise of <span 
class="cmtt-10x-x-109">arg2</span>. <br 
class="newline" />If one of the input arrays has a mask, the output array will also have a mask. Each output
     mask element value is the logical OR of the condition mask element value and the mask value
     of the element taken from arg1 or arg2.</dd></dl>
<!--l. 2160--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.14   </span> <a 
 id="x1-490004.10.14"></a>Cone search functions</h5>
<!--l. 2161--><p class="noindent" >Cone search functions make it possible to test if a source is within a given distance of a given sky position.
The expression
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-63">
&#x00A0;&#x00A0;cos(0d1m)&#x00A0;&#x003C;&#x00A0;sin(52deg)&#x00A0;*&#x00A0;sin(DEC)&#x00A0;+
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cos(52deg)&#x00A0;*&#x00A0;cos(DEC)&#x00A0;*&#x00A0;cos(3h30m&#x00A0;-&#x00A0;RA)
</div>
<!--l. 2166--><p class="nopar" > could be used to test if sources with their sky position defined in columns <span 
class="cmtt-10x-x-109">RA </span>and <span 
class="cmtt-10x-x-109">DEC </span>are within 1 arcmin
of the given sky position. <br 
class="newline" />The cone search functions implement this expression making life much easier for the user. Because they
can also operate on arrays of positions, searching in multiple cones can be done simultaneously. That
makes it possible to find matching source positions in two catalogues as shown in an example at the end of
this section.
</p><!--l. 2177--><p class="indent" >   The arguments of all functions are described below. All of them have to be given in radians. However,
usually one does not need to bother because TaQL makes it possible to specify positions in many formats
automatically converted to radians.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">SOURCES</span><br 
class="newline" />is a set or array giving the positions of one or more sources (e.g. in equatorial coordinates) to
     be tested. Normally these are columns in a table. Where argument name <span 
class="cmtt-10x-x-109">SOURCE </span>is mentioned
     below, only a single source can be used, otherwise multiple sources. <br 
class="newline" />For example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">[RA,DEC] </span>for scalar columns RA and DEC. <br 
class="newline" /><span 
class="cmtt-10x-x-109">SKYPOS </span>for a column SKYPOS containing 2-element vectors with RA and DEC.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">CONES</span><br 
class="newline" />is  a  set  or  array  giving  the  center  positions  and  radii  of  one  or  more  cones  (e.g.  as
     RA,DEC,radius). Usually the user will specify it as constants. <br 
class="newline" />For example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">[12h13m54, -5.3.34, 0d1m] </span>for a single cone. <br 
class="newline" /><span 
class="cmtt-10x-x-109">[12h13m54, -5.3.34, 0d1m, 1h2m3, 4.5.6, 0d1m] </span>for two cones.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">CONEPOS</span><br 
class="newline" />is a set or array giving the positions of one or more cone centers (e.g. as RA,DEC).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">RADII</span><br 
class="newline" />is a scalar, set or array giving one or more radii. Each radius is applied to all positions in
     <span 
class="cmtt-10x-x-109">CONEPOS</span>. Specifying a cone as <span 
class="cmtt-10x-x-109">CONEPOS,RADIUS </span>is easier than specifying it as <span 
class="cmtt-10x-x-109">CONES </span>if the
     same radius has to be used for multiple cones. <br 
class="newline" />For example: <br 
class="newline" /><span 
class="cmtt-10x-x-109">[12h13m54, -5.3.34, 1h2m3, 4.5.6], 0d1m </span>is  the  same  as  the  second  <span 
class="cmtt-10x-x-109">CONES </span>example
     above.</dd></dl>
                                                                                         

                                                                                         
<!--l. 2213--><p class="noindent" >The following cone search functions are available.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ANYCONE(SOURCE,CONES)</span><br 
class="newline" />Return <span 
class="cmtt-10x-x-109">T </span>if the source is contained in at least one of the cones. Operator <span 
class="cmtt-10x-x-109">INCONE </span>is a synonym.
     So <span 
class="cmtt-10x-x-109">ANYCONE(SOURCE,CONES) </span>is the same as <span 
class="cmtt-10x-x-109">SOURCE INCONE CONES</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool ANYCONE(SOURCE,CONEPOS,RADII)</span><br 
class="newline" />It does the same as above.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer FINDCONE(SOURCES,CONES)</span><br 
class="newline" />Return the index of the first cone containing the source. If a single source is given, the result
     is a scalar. If multiple sources are given, the result is an array with the same shape as the
     source array.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">integer FINDCONE(SOURCES,CONEPOS,RADII)</span><br 
class="newline" />It does the same as above. Note that in this case each radius is applied to each cone, so the
     resulting index array is a combination of the two input arrays (with the radius as the most
     rapidly varying axis).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool CONES(SOURCES,CONES)</span><br 
class="newline" />Return a 2-dim bool array. The length of the most rapidly varying axis is the number of
     cones. The length of the other axis is the number of sources. When using glish style, element
     <span 
class="cmtt-10x-x-109">(i,j) </span>in the resulting array is <span 
class="cmtt-10x-x-109">T </span>if source <span 
class="cmtt-10x-x-109">j </span>is contained in cone <span 
class="cmtt-10x-x-109">i</span>.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">bool CONES(SOURCES,CONEPOS,RADII)</span><br 
class="newline" />It does the same as above. However, the result is a 3-dim array with the radii as the most
     rapidly varying axis, cones as the next axis, and sources as the slowest axis.</dd></dl>
<!--l. 2244--><p class="noindent" >Please note that <span 
class="cmtt-10x-x-109">ANYCONE(SOURCE,CONES) </span>does the same as <span 
class="cmtt-10x-x-109">any(CONES(SOURCE,CONES))</span>, but is faster
because it stops as soon as a cone is found. <br 
class="newline" />Function <span 
class="cmtt-10x-x-109">CONES </span>makes it possible to do catalogue matching. For example, to find sources matching other
sources in the same catalogue (within a radius of 10 arcseconds):
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-64">
&#x00A0;&#x00A0;CALC&#x00A0;CONES([RA,DEC],
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;FROM&#x00A0;table.cat&#x00A0;GIVING&#x00A0;[RA,DEC]],&#x00A0;0d0m10)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;table.cat
</div>
<!--l. 2254--><p class="nopar" > Note that in this example the SELECT clause returns an array with positions which are used as the cone
centers. So each source in the catalogue is tested against every source. It makes it an N-square operation,
thus potentially very expensive. The result is a 4-dim boolean array with shape (in glish style)
<span 
class="cmtt-10x-x-109">[1,nrow,1,nrow] </span>which can be processed in Glish. Please note that the <span 
class="cmtt-10x-x-109">CONES </span>function results for each
row in a array with shape <span 
class="cmtt-10x-x-109">[1,nrow,1]</span>. <br 
class="newline" />The query can be done with multiple radii, for example also with 1 arcsecond and 1 arcminute.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-65">
&#x00A0;&#x00A0;CALC&#x00A0;CONES([RA,DEC],
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;FROM&#x00A0;table.cat&#x00A0;GIVING&#x00A0;[RA,DEC]],&#x00A0;[0d0m1,&#x00A0;0d0m10,&#x00A0;0d1m])
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;table.cat
</div>
<!--l. 2269--><p class="nopar" > resulting in an array with glish shape <span 
class="cmtt-10x-x-109">[3,nrow,1,nrow]</span>. In this way one can get a better indication how
close sources are to the cone centers.
</p><!--l. 2274--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.15   </span> <a 
 id="x1-500004.10.15"></a>User defined functions</h5>
<!--l. 2275--><p class="noindent" >User defined functions (UDF) have to exist in a dynamically loadable library. In TaQL the name of a UDF
consists of the name of the library (without lib prefix and extension) followed by a dot and the function
name. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-66">
&#x00A0;&#x00A0;derivedmscal.pa1
</div>
<!--l. 2281--><p class="nopar" > denotes function <span 
class="cmtt-10x-x-109">pa1 </span>in shared library <span 
class="cmtt-10x-x-109">libderivedmscal.so </span>or <span 
class="cmtt-10x-x-109">libcasa</span><span 
class="cmtt-10x-x-109">_derivedmscal.so</span>. On OS-X
the extension <span 
class="cmtt-10x-x-109">.dylib </span>is used. <br 
class="newline" />The library and function name are case-insensitive.
</p><!--l. 2287--><p class="indent" >   In section <a 
href="#x1-8400012">Writing user defined functions</a> it is explained how to write user defined functions.
</p><!--l. 2291--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.16   </span> <a 
 id="x1-510004.10.16"></a>Special MeasurementSet functions</h5>
<!--l. 2292--><p class="noindent" >The casacore package comes with several predefined UDFs in library <span 
class="cmtt-10x-x-109">libcasa</span><span 
class="cmtt-10x-x-109">_derivedmscal</span>. The
functions can be used on a MeasurementSet or a CASA calibration table (both old and new format). All
angles are returned in radians. For calibration tables, where a row contains a single antenna, functions like
PA1 are the same as PA2. <br 
class="newline" />For ease of use it is possible to use the alias <span 
class="cmtt-10x-x-109">mscal</span>.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HA()</span><br 
class="newline" />gives the hourangle of the array center (observatory position).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HA1()</span><br 
class="newline" />gives the hourangle of ANTENNA1.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HA2()</span><br 
class="newline" />gives the hourangle of ANTENNA2.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HADEC()</span><br 
class="newline" />gives the hourangle/declination of the array center (observatory position).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HADEC1()</span><br 
class="newline" />gives the hourangle/declination of ANTENNA1.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.HADEC2()</span><br 
class="newline" />gives the hourangle/declination of ANTENNA2.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.LAST()</span><br 
class="newline" />gives the local sidereal time of the array center.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.LAST1()</span><br 
class="newline" />gives the local sidereal time of ANTENNA1.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.LAST2()</span><br 
class="newline" />gives the local sidereal time of ANTENNA2.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.PA1()</span><br 
class="newline" />gives the parallactic angle of ANTENNA1.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">double MSCAL.PA2()</span><br 
class="newline" />gives the parallactic angle of ANTENNA2.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MSCAL.AZEL1()</span><br 
class="newline" />gives the azimuth/elevation of ANTENNA1.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MSCAL.AZEL2()</span><br 
class="newline" />gives the azimuth/elevation of ANTENNA2.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MSCAL.UVW()</span><br 
class="newline" />gives the UVW coordinates in J2000 (in meters).</dd></dl>
<!--l. 2329--><p class="noindent" >By default all these functions will use the direction given in column PHASE_DIR of the FIELD subtable. It is
possible to use another column by giving its name as a string argument (e.g., &#8217;HA(DELAY_DIR)&#8217;).
<br 
class="newline" />It is also possible to use an explicit direction which must be given as [RA,DEC] in J2000 or
as a case-insensitive name of a planetary object (as defined by the casacore Measures). For
example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-67">
&#x00A0;&#x00A0;&#x00A0;derivedmscal.azel1([5h23m32.76,&#x00A0;10d15m56.49])
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;derivedmscal.azel1(&#8217;MOON&#8217;)
</div>
<!--l. 2339--><p class="nopar" > These examples give the azimuth and elevation of the given directions for each selected row in the
MeasurementSet, thus using the position of ANTENNA1 and the times in these rows.
</p><!--l. 2344--><p class="indent" >   If a string value is given, it is first tried as a planetary object. Theoretically it is possible that a
column has the same name as a planetary object. In such a case the name can be escaped by a backslash
to indicate that a column name is meant. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-68">
&#x00A0;&#x00A0;&#x00A0;derivedmscal.azel1(&#8217;\SUN&#8217;)
</div>
<!--l. 2351--><p class="nopar" > means that column SUN in the FIELD table has to be used.
</p>
<!--l. 2354--><p class="noindent" ><span class="likeparagraphHead"><a 
 id="x1-520004.10.16"></a></span>
   The <span 
class="cmtt-10x-x-109">STOKES </span>function makes it possible to convert the Stokes parameters of a DATA column in a
MeasurementSet, for instance from linear or circular to iquv. It is also possible to convert the weights or
flags, i.e., to combine them in the same way as the data would be combined.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">complexarray MSCAL.STOKES(complexarray, string)</span><br 
class="newline" />converts the data.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MSCAL.STOKES(doublearray, string)</span><br 
class="newline" />combines the weights.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">boolarray MSCAL.STOKES(boolarray, string)</span><br 
class="newline" />combines the flags.</dd></dl>
<!--l. 2367--><p class="noindent" >In all cases the case-insensitive string argument defines the output Stokes axes. It must be a comma separated
list of Stokes names. All values defined in the casacore class <span 
class="cmtt-10x-x-109">Stokes </span>are possible. Most important are:
</p>
     <ul class="itemize1">
     <li class="itemize">XX, XY, YX, and/or YY. <br 
class="newline" />LINEAR or LIN means XX,XY,YX,YY.
     </li>
     <li class="itemize">RR, RL, LR, and/or LL. <br 
class="newline" />CIRCULAR or CIRC means RR,RL,LR,LL.
     </li>
     <li class="itemize">I, Q, U, and/or V. <br 
class="newline" />IQUV or STOKES means I,Q,U,V.
     </li>
     <li class="itemize">PTOTAL is the polarized intensity (sqrt(Q**2+U**2+V**2))
     </li>
     <li class="itemize">PLINEAR is the linearly polarized intensity (sqrt(Q**2+U**2))
                                                                                         

                                                                                         
     </li>
     <li class="itemize">PFTOTAL is the polarization fraction (Ptotal/I)
     </li>
     <li class="itemize">PFLINEAR is the linear polarization fraction (Plinear/I)
     </li>
     <li class="itemize">PANGLE is the linear polarization angle (0.5*arctan(U/Q)) (in radians)</li></ul>
<!--l. 2381--><p class="noindent" >If not given, the string argument defaults to &#8217;IQUV&#8217;. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-69">
&#x00A0;&#x00A0;select&#x00A0;mscal.stokes(DATA,&#8217;circ&#8217;)&#x00A0;as&#x00A0;CIRCDATA&#x00A0;from&#x00A0;my.ms
</div>
<!--l. 2385--><p class="nopar" > creates a table with column CIRCDATA containing the circular polarization data.
</p>
<!--l. 2389--><p class="noindent" ><span class="likeparagraphHead"><a 
 id="x1-530004.10.16"></a></span>
   The <span 
class="cmtt-10x-x-109">BASELINE </span>function makes it possible to do selection on baselines in a MeasurementSet or CalTable
using the special <a 
href="http://www.aoc.nrao.edu/~sbhatnag/misc/msselection/msselection.html" >CASA baseline selection syntax</a>
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-70">
&#x00A0;&#x00A0;select&#x00A0;from&#x00A0;my.ms&#x00A0;where&#x00A0;mscal.baseline(&#8217;RT[2-4]&#8217;)
</div>
<!--l. 2396--><p class="nopar" > selects the baselines containing an antenna whose name matches the pattern in the function argument.
Note that autocorrelations are not selected this way.
</p><!--l. 2401--><p class="indent" >   Similar functions <span 
class="cmtt-10x-x-109">TIME, FIELD, SCAN, SPW, UVDIST, STATE, OBS</span>, and <span 
class="cmtt-10x-x-109">ARRAY </span>use the CASA
selection syntax to select on the corresponding fields. The aforementioned document also describes these
syntaxes. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-71">
&#x00A0;&#x00A0;select&#x00A0;from&#x00A0;my.ms&#x00A0;where&#x00A0;mscal.field(&#8217;1~4&#8217;)
</div>
<!--l. 2408--><p class="nopar" >
</p><!--l. 2410--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.10.17   </span> <a 
 id="x1-540004.10.17"></a>Special Measures functions</h5>
<!--l. 2411--><p class="noindent" >These functions make it possible to convert measures like directions, epochs, and positions from one
reference frame to another. All conversions supported by casacore&#8217;s <a 
href="../html/group__Measures__module.html" >Measures</a> are possible. For
example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-72">
&#x00A0;&#x00A0;meas.galactic&#x00A0;(-6h52m36.7,&#x00A0;34d25m56.1,&#x00A0;"J2000")
&#x00A0;<br />&#x00A0;&#x00A0;meas.azel&#x00A0;("MOON",&#x00A0;date(),&#x00A0;"WSRT")
</div>
<!--l. 2420--><p class="nopar" > The first example converts a J2000 position to galactic coordinates. The second example gives the moon&#8217;s
azimuth/elevation at the WSRT at the current date/time.
</p>
<!--l. 2425--><p class="noindent" ><span class="likeparagraphHead"><a 
 id="x1-550004.10.17"></a></span>
   The following basic functions are available. Most functions return double angle values with unit rad.
Only the RISESET function returns date/time values. <br 
class="newline" />Note that all names used below are case-insensitive.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.DIR(toref, direction, epoch, position)</span><br 
class="newline" />converts a direction to the reference type given by the &#8217;toref&#8217; string. The epoch and position
     arguments  only  need  to  be  given  if  the  conversion  needs  frame  information  (e.g.  when
     converting to apparent).<br 
class="newline" />Function name MEAS.DIRECTION can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">DateTimearray MEAS.RISESET(direction, epoch, position)</span><br 
class="newline" />returns the rise and set date/times (UTC) of the sources given in the direction argument for
     the given dates and positions. Note that the TIME or CTIME function can be used on the
     result to get the time part only (as double or string).
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.EPOCH(toref, epoch, position)</span><br 
class="newline" />converts an epoch to the reference type given by the &#8217;toref&#8217; string. The position argument
     only needs to be given if the conversion needs frame information.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.POS(toref, position)</span><br 
class="newline" />converts a position to the reference type given by the &#8217;toref&#8217; string.<br 
class="newline" />Function name MEAS.POSITION can be used as well.</dd></dl>
<!--l. 2450--><p class="indent" >   For ease of use several specialized functions are defined with an implicit &#8217;toref&#8217; argument.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.J2000(direction, epoch, position)</span><br 
class="newline" />converts a direction to J2000.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.B1950(direction, epoch, position)</span><br 
class="newline" />converts a direction to B1950.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.APP(direction, epoch, position)</span><br 
class="newline" />converts a direction to apparent coordinates. <br 
class="newline" />Function name MEAS.APPARENT can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.HADEC(direction, epoch, position)</span><br 
class="newline" />converts a direction to hourangle/declination.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.AZEL(direction, epoch, position)</span><br 
class="newline" />converts a direction to azimuth/elevation.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.ECL(direction, epoch, position)</span><br 
class="newline" />converts a direction to ecliptic coordinates. <br 
class="newline" />Function name MEAS.ECLIPTIC can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.GAL(direction, epoch, position)</span><br 
class="newline" />converts a direction to galactic coordinates. <br 
class="newline" />Function name MEAS.GALACTIC can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.SGAL(direction, epoch, position)</span><br 
class="newline" />converts a direction to supergalactic coordinates. <br 
class="newline" />Function name MEAS.SUPERGAL or MEAS.SUPERGALACTIC can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.LAST(epoch, position)</span><br 
class="newline" />converts an epoch to local sidereal time. <br 
class="newline" />Function name MEAS.LST can be used as well.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.ITRF(toref, position)</span><br 
class="newline" />converts a position to ITRF coordinates.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">doublearray MEAS.WGS(toref, position)</span><br 
class="newline" />converts a position to WGS84 coordinates.</dd></dl>
<!--l. 2481--><p class="noindent" >The name of the last two functions can have a suffix indicating how positions are returned. <br 
class="newline" />- XYZ means as x,y,z <br 
class="newline" />- LL or LONLAT means as lon,lat <br 
class="newline" />- H or HEIGHT means as height It defaults to XYZ.
                                                                                         

                                                                                         
</p>
<!--l. 2488--><p class="noindent" ><span class="likeparagraphHead"><a 
 id="x1-560004.10.17"></a></span>
   The function arguments can be given in a variety of ways. </p>
     <ul class="itemize1">
     <li class="itemize">&#8217;toref&#8217; is a constant scalar string giving the reference type to convert to. See the Measure
     classes <a 
href="../html/classcasa_1_1MDirection.html" >MDirection</a>, <a 
href="../html/classcasa_1_1MEpoch.html" >MEpoch</a>, and <a 
href="../html/classcasa_1_1MPosition.html" >MPosition</a>, for an overview of the types.
     </li>
     <li class="itemize">&#8217;direction&#8217; gives one or more directions to convert. They can be given in several ways.
          <ul class="itemize2">
          <li class="itemize">As a constant scalar or array of strings giving one or more planetary objects like MOON
          or VENUS and/or giving the name of standard sources (CasA, CygA, TauA, VirA,
          HerA, HydA, or PerA). In the future support for comets might be added. <br 
class="newline" />The names are case-insensitive.
          </li>
          <li class="itemize">As 2 constant double scalar arguments giving ra and dec (or longitude and latitude).
          </li>
          <li class="itemize">As a double array with an even number of elements giving ra/dec or longitude/latitude
          of one or more directions. It can be a constant array, but it can also be a column or an
          expression using a column.</li></ul>
     <!--l. 2512--><p class="noindent" >If a column or a column slice is given, the reference type stored in the column keywords will be
     recognized. In other cases the reference type should be given in the next string argument. If not
     given, it defaults to J2000. <br 
class="newline" />For example:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-73">
     &#x00A0;&#x00A0;[&#8217;MOON&#8217;,&#8217;sun&#8217;,&#x00A0;&#8217;venus&#8217;]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;3&#x00A0;planetary&#x00A0;objects
     &#x00A0;<br />&#x00A0;&#x00A0;12h23m17.5,&#x00A0;23d56m43.8,&#x00A0;&#8217;B1950&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;2&#x00A0;scalar&#x00A0;constants&#x00A0;(as&#x00A0;B1950)
     &#x00A0;<br />&#x00A0;&#x00A0;[12h23m17.5,&#x00A0;23d56m43.8]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;constant&#x00A0;array&#x00A0;(default&#x00A0;J2000)
     &#x00A0;<br />&#x00A0;&#x00A0;PHASE_DIR[0,]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;1st&#x00A0;direction&#x00A0;in&#x00A0;given&#x00A0;column
</div>
     <!--l. 2522--><p class="nopar" >
     </p></li>
     <li class="itemize">&#8217;epoch&#8217; gives one or more epochs to use. Similar to directions the reference type is taken
     from the column keywords or can be given in the next argument. It defaults to UTC.
     <br 
class="newline" />Epochs can be given in three ways:
          <ul class="itemize2">
          <li class="itemize">As  a  scalar  or  array  containing  double  values.  It  can  be  a  constant  or  a  column
          (expression).
          </li>
          <li class="itemize">As a scalar or array containing DateTime values.
          </li>
          <li class="itemize">As  a  scalar  or  array  containing  String  values  representing  date/time.  They  will
          automatically be converted to DateTime values using function <span 
class="cmtt-10x-x-109">datetime</span>.</li></ul>
     <!--l. 2536--><p class="noindent" >For example:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-74">
     &#x00A0;&#x00A0;datetime()&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;current&#x00A0;date/time
     &#x00A0;<br />&#x00A0;&#x00A0;&#8217;today&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;current&#x00A0;date/time
     &#x00A0;<br />&#x00A0;&#x00A0;[select&#x00A0;unique&#x00A0;TIME&#x00A0;from&#x00A0;my.ms]&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;all&#x00A0;times&#x00A0;from&#x00A0;some&#x00A0;MS
     &#x00A0;<br />&#x00A0;&#x00A0;9Oct2011/12:00:00,&#x00A0;&#8217;UTC&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;given&#x00A0;UTC&#x00A0;time
</div>
     <!--l. 2542--><p class="nopar" > Note that in the last example &#8217;UTC&#8217; is not necessary, because it is the default.
     </p></li>
     <li class="itemize">&#8217;position&#8217; gives one or more directions to use. They can be given as x,y,z or as lon,lat with an
     optional height. Usually the unit of the first value defines if x,y,z or lon,lat is used. It is,
     however. also possible to use suffices like XYZ or LL in the reference type given in the next
     argument.
          <ul class="itemize2">
          <li class="itemize">As a scalar or array of observatory names to use their positions in the Observatory table.
          </li>
          <li class="itemize">As 2 or 3 constant double scalar values giving xyz, lonlat, or lonlat/height.
          </li>
          <li class="itemize">As a double array giving one or more positions in xyz or lonlat. Similar to directions
          it can be a column (expression) where the reference type is taken from the column
          keywords.
          </li>
          <li class="itemize">As two constant double arrays giving lonlat and height of one or more positions. The
          array sizes have to match (thus the size of the lonlat array must be twice the size of the
          height array).</li></ul>
     <!--l. 2563--><p class="noindent" >If needed, the reference type (with optional suffix) can be given in the next argument. The reference
     type defaults to ITRF if xyz is used, otherwise to WGS. <br 
class="newline" />For example:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-75">
     &#x00A0;&#x00A0;&#8217;WSRT&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;WSRT&#x00A0;position
     &#x00A0;<br />&#x00A0;&#x00A0;5deg,&#x00A0;52deg&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;2&#x00A0;scalar&#x00A0;constants&#x00A0;(WGS84)
     &#x00A0;<br />&#x00A0;&#x00A0;(5deg,&#x00A0;52deg]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;same,&#x00A0;but&#x00A0;as&#x00A0;array
     &#x00A0;<br />&#x00A0;&#x00A0;5deg,&#x00A0;52deg,&#x00A0;5m&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;WGS84&#x00A0;with&#x00A0;height
     &#x00A0;<br />&#x00A0;&#x00A0;[5deg,&#x00A0;52deg],&#x00A0;[5m]&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;same,&#x00A0;but&#x00A0;as&#x00A0;array
     &#x00A0;<br />&#x00A0;&#x00A0;3.8288e+06m,&#x00A0;442449,&#x00A0;5.0649e+06&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;xyz&#x00A0;as&#x00A0;scalars&#x00A0;(ITRF)
     &#x00A0;<br />&#x00A0;&#x00A0;[41.84m,&#x00A0;4.835,&#x00A0;55.722],&#x00A0;&#8217;WGS&#8217;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;xyz&#x00A0;as&#x00A0;array&#x00A0;(WGS84)
     &#x00A0;<br />&#x00A0;&#x00A0;POSITION&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;POSITION&#x00A0;column
</div>
     <!--l. 2576--><p class="nopar" ></p></li></ul>
<!--l. 2578--><p class="noindent" >A few more elaborate examples are given below.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-76">
&#x00A0;&#x00A0;meas.last&#x00A0;(date(&#8217;15Oct2011/15:34&#8217;),&#x00A0;5deg,&#x00A0;52deg)
&#x00A0;<br />&#x00A0;&#x00A0;meas.last&#x00A0;(date(&#8217;15Oct2011/15:34&#8217;),&#x00A0;5deg,&#x00A0;52deg)&#x00A0;d
</div>
<!--l. 2582--><p class="nopar" > It calculates the local apparent sidereal time for the given date and position. Note that the first
example returns the value in seconds, while the second returns it in days (because unit &#8217;d&#8217; was
given).
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-77">
&#x00A0;&#x00A0;meas.azel&#x00A0;("JUPITER",&#x00A0;[select&#x00A0;unique&#x00A0;TIME&#x00A0;from&#x00A0;~/GER1.MS],
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;["WSRT","VLA"])
</div>
<!--l. 2589--><p class="nopar" > It calculates Jupiter&#8217;s azimuth/elevation for WSRT and VLA for all times returned by the subquery (see
next section for subqueries).
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-78">
&#x00A0;&#x00A0;calc&#x00A0;meas.b1950(PHASE_DIR[0,])&#x00A0;from&#x00A0;~/GER1.MS/FIELD&#8217;
</div>
<!--l. 2594--><p class="nopar" > It converts the PHASE_DIR directions in the FIELD table to B1950. Note that no frame information is
needed for such a conversion.
</p><!--l. 2599--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.11   </span> <a 
 id="x1-570004.11"></a>Subqueries</h4>
<!--l. 2600--><p class="noindent" >As in SQL it is possible to create a set from a subquery. A subquery has the same syntax as
a main query, but has to be enclosed in square brackets or parentheses. Basically it looks
like:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-79">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;time&#x00A0;IN
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;time&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5]
</div>
<!--l. 2606--><p class="nopar" > The subquery on <span 
class="cmtt-10x-x-109">othertable </span>results in a constant set containing the times for which the windspeed
matches. Subsequently the main query is executed and selects all rows from the main table with times in
that set. Note that like other bounded sets this set is transformed to a constant array, so it is possible to
apply functions to it (e.g. min, mean).
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-80">
&#x00A0;&#x00A0;SELECT&#x00A0;[SELECT&#x00A0;NAME&#x00A0;FROM&#x00A0;::ANTENNA][ANTENNA1]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;~/GER1.MS
</div>
<!--l. 2619--><p class="nopar" > This example shows how a subquery is used to join the main table of a MeasurementSet with
its ANTENNA subtable. The subquery returns a list with the names of all antennae, which
subsequently is indexed with the antenna number to get the antenna name for each row in the main
table.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-81">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;time&#x00A0;IN
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;time&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean([SELECT&#x00A0;windspeed&#x00A0;FROM&#x00A0;othertable])]
</div>
<!--l. 2629--><p class="nopar" > This example contains another subquery to get all windspeeds and to take the mean of them. So
the first subquery selects all times where the windspeed is less than the average windspeed.
<br 
class="newline" />A subquery result should contain only one column, otherwise an exception is thrown.
</p><!--l. 2636--><p class="indent" >   It may happen that a subquery has to be executed twice because 2 columns from the other table are
needed. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-82">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;any(time&#x00A0;&#x003E;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;starttime&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;&amp;&#x00A0;time&#x00A0;&#x003C;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;endtime&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5])
</div>
<!--l. 2643--><p class="nopar" > In this case the other table contains the time range for each windspeed. For big tables it is expensive to
execute the subquery twice. A better solution is to store the result of the subquery in a temporary table
and reuse it.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-83">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5&#x00A0;GIVING&#x00A0;tmptab
&#x00A0;<br />&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;any(time&#x00A0;&#x003E;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;starttime&#x00A0;FROM&#x00A0;tmptab]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;&amp;&#x00A0;time&#x00A0;&#x003C;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;endtime&#x00A0;FROM&#x00A0;tmptab])
</div>
<!--l. 2654--><p class="nopar" > However, this has the disadvantage that the table <span 
class="cmtt-10x-x-109">tmptab </span>still exists after the query and has to be deleted
explictly by the user. Below a better solution for this problem is shown.
</p><!--l. 2659--><p class="indent" >   TaQL has a few extensions to support tables better, in particular the Casacore measurement
sets.
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-57002x1">The temporary problem above can be circumvented by using the ability to use a <span 
class="cmtt-10x-x-109">SELECT </span>expression
     in the <span 
class="cmtt-10x-x-109">FROM </span>clause. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-84">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable,
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5]&#x00A0;tmptab
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;any(time&#x00A0;&#x003E;=&#x00A0;[SELECT&#x00A0;starttime&#x00A0;FROM&#x00A0;tmptab]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;&amp;&#x00A0;time&#x00A0;&#x003C;=&#x00A0;[SELECT&#x00A0;endtime&#x00A0;FROM&#x00A0;tmptab])
</div>
     <!--l. 2671--><p class="nopar" > However, below a even nicer solution is given.
     </p></li>
     <li 
  class="enumerate" id="x1-57004x2">The time range problem above can be solved elegantly by using a set as the result of the subquery.
     Instead of a table name, it is possible to give an expression in the GIVING clause (as mentioned in
     <a 
href="#x1-150003.7">section 3.8</a>). E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-85">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;MY.MS&#x00A0;where&#x00A0;TIME&#x00A0;in
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;FROM&#x00A0;OTHERTABLE&#x00A0;where&#x00A0;WINDSPEED&#x00A0;&#x003C;&#x00A0;5
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;giving&#x00A0;[TIME-INTERVAL/2&#x00A0;=:=&#x00A0;TIME+INTERVAL/2]]
</div>
     <!--l. 2683--><p class="nopar" > The set expression in the GIVING clause is filled with the results from the subquery and used in
     the main query. So if the subquery results in 5 rows, the resulting set contains 5 intervals. Thereafter
     the resulting intervals are sorted and combined where possible. In this way the minimum number of
     intervals have to be examined by the main query.
     </p></li>
     <li 
  class="enumerate" id="x1-57006x3">In Casacore the other table will often be the name of a subtable, which is stored in a table or
     column keyword of the main table. The standard <a 
href="#x1-300004.5">keyword syntax</a> can be used to indicate
     that the other table is the table in the given keyword. Note that for a table keyword
     the <span 
class="cmtt-10x-x-109">:: </span>part has to be given, otherwise the name is treated as an ordinary table name.
     E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-86">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;MY.MS&#x00A0;where&#x00A0;TIME&#x00A0;in
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;TIME&#x00A0;from&#x00A0;::WEATHER&#x00A0;where&#x00A0;WINDSPEED&#x00A0;&#x003C;&#x00A0;5]
</div>
     <!--l. 2701--><p class="nopar" > In this example the other table is a subtable of table <span 
class="cmtt-10x-x-109">my.ms</span>. Its name is given by keyword <span 
class="cmtt-10x-x-109">WEATHER</span>
     of <span 
class="cmtt-10x-x-109">my.ms</span>.
     </p></li>
     <li 
  class="enumerate" id="x1-57008x4">Often the result of a query on a subtable of a measurement set is used to select columns from the
     main table. However, several subtables do not have an explicit key, but use the row number as an
     implicit key. The function <span 
class="cmtt-10x-x-109">ROWID() </span>can be used to return the row number as the subtable query
     result. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-87">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;MY.MS&#x00A0;where&#x00A0;DATA_DESC_ID&#x00A0;in
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;from&#x00A0;::DATA_DESCRIPTION&#x00A0;where
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SPECTRAL_WINDOW_ID&#x00A0;in&#x00A0;[0,2,4]&#x00A0;giving&#x00A0;[ROWID()]]
</div>
     <!--l. 2715--><p class="nopar" > Note that the function <span 
class="cmtt-10x-x-109">ROWNUMBER </span>cannot be used here, because it will give the row number in the
     selection and not (as <span 
class="cmtt-10x-x-109">ROWID </span>does) the row number in the original table. Furthermore, <span 
class="cmtt-10x-x-109">ROWID </span>gives a
     0-relative row number which is needed to be able to use it as a selection criterium on the 0-relative
     values in the measurement set.
     </p></li>
     <li 
  class="enumerate" id="x1-57010x5">Select if any channel has a UV distance  100 wavelengths.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-88">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;MY.MS&#x00A0;where&#x00A0;any(sqrt(sumsqr(UVW[:2]))&#x00A0;/&#x00A0;c()&#x00A0;*
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[select&#x00A0;CHAN_FREQ&#x00A0;from&#x00A0;::SPECTRAL_WINDOW][DATA_DESC_ID,]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;&#x00A0;100)
     &#x00A0;<br />
</div>
     <!--l. 2730--><p class="nopar" > In a MeasurementSet the UVW coordinates are stored in meters, so they have to be
     multiplied with the frequency and divided by speed of light to get them in wavelengths.
     <br 
class="newline" />Because TaQL has no proper join operation, it is not possible to select directly on the
     DATA_DESC_ID. However, using a nested query and indexing the result with the DATA_DESC_ID
     has the same effect. It only requires that CHAN_FREQ has the same length in all rows in the
     subtable.
     </p></li>
     <li 
  class="enumerate" id="x1-57012x6">Calculate the angular distance between the sun and the moon as seen from the WSRT for the
     coming 30 days.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-89">
     &#x00A0;&#x00A0;calc&#x00A0;angdist(meas.app(&#8217;SUN&#8217;,&#x00A0;&#x00A0;date()+[0:31],&#x00A0;&#8217;WSRT&#8217;),
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;meas.app(&#8217;MOON&#8217;,&#x00A0;date()+[0:31],&#x00A0;&#8217;WSRT&#8217;))
</div>
     <!--l. 2746--><p class="nopar" ></p></li></ol>
<!--l. 2750--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-580005"></a>Some further remarks</h3>
<!--l. 2751--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-590005.1"></a>Joining tables</h4>
<!--l. 2752--><p class="noindent" >As discussed in some previous sections it is possible to join tables on row number. Two examples show
how to do it.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-90">
&#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;t1,othertable&#x00A0;t2
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;WHERE&#x00A0;not&#x00A0;all(near(t1.data,&#x00A0;t2.data))
</div>
<!--l. 2758--><p class="nopar" > This command can be used to check if the data in mytable is about equal to the data in othertable. Both
tables have to have the same number of rows. <br 
class="newline" />The join is done on row number, thus the data of the same rows are compared.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-91">
&#x00A0;&#x00A0;SELECT&#x00A0;[SELECT&#x00A0;NAME&#x00A0;FROM&#x00A0;::ANTENNA][ANTENNA1]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;~/GER1.MS
</div>
<!--l. 2768--><p class="nopar" > This example shows how a subquery is used to join the main table of a MeasurementSet with its
ANTENNA subtable. The subquery returns a list with the names of all antennae, which subsequently is
indexed with the antenna number to get the antenna name for each row in the main table.
<br 
class="newline" />The join is done using the ANTENNA1 column which gives the row number in the subtable, thus the
index in the subquery result.
</p><!--l. 2776--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-600005.2"></a>Optimization</h4>
<!--l. 2777--><p class="noindent" >A lot of development work can be done to improve the query optimization. At this stage only a few simple
optimizations are done. </p>
     <ul class="itemize1">
     <li class="itemize">Constant subexpressions are calculated only once. E.g. <br 
class="newline" />in <span 
class="cmtt-10x-x-109">COL*sin(180/pi) </span>the part <span 
class="cmtt-10x-x-109">sin(180/pi) </span>is evaluated once.
     </li>
     <li class="itemize">If a subquery generates intervals of reals or dates, overlapping intervals are combined and
     eliminated. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-92">
     &#x00A0;&#x00A0;select&#x00A0;from&#x00A0;GER.MS&#x00A0;where&#x00A0;TIME&#x00A0;in&#x00A0;[select&#x00A0;from&#x00A0;::POINTING&#x00A0;where
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;sumsqr(DIRECTION[1])&#x003E;0&#x00A0;giving&#x00A0;[TIME-INTERVAL/2=:=TIME+INTERVAL/2]]
</div>
     <!--l. 2788--><p class="nopar" > can generate many identical or overlapping intervals. They are sorted and combined where possible
     to make the set as small as possible.</p></li></ul>
<!--l. 2793--><p class="indent" >   TaQL does not recognize common subexpressions nor does it attempt to optimize the query. It means
that the user can optimize a query by specifying the expression carefully. When using operator
<!--l. 2796--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">&#x2223;</mo><mo 
class="MathClass-rel">&#x2223;</mo></math> or &amp;&amp;,
attention should be paid to the contents of the left and right branches. Both operators evaluate the right
branch only if needed, so if possible the left branch should be the shortest one, i.e., the fastest to
evaluate.
</p><!--l. 2802--><p class="indent" >   The user should also use functions, operators, and subqueries in a careful way. </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10x-x-109">SQUARE(COL) </span>is (much) faster than <span 
class="cmtt-10x-x-109">COL</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">**</span></span></span><span 
class="cmtt-10x-x-109">2 </span>or <span 
class="cmtt-10x-x-109">POW(COL,2)</span>, because SQUARE is faster. It is
     also faster than <span 
class="cmtt-10x-x-109">COL*COL</span>, because it accesses column <span 
class="cmtt-10x-x-109">COL </span>only once. <br 
class="newline" />Similarly <span 
class="cmtt-10x-x-109">SQRT(COL) </span>is faster than <span 
class="cmtt-10x-x-109">COL</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">**</span></span></span><span 
class="cmtt-10x-x-109">0.5 </span>or <span 
class="cmtt-10x-x-109">POW(COL,0.5)</span>
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">SQUARE(U) + SQUARE(V) </span><!--l. 2814--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>
     <span 
class="cmtt-10x-x-109">1000</span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-10x-x-109">**</span></span></span><span 
class="cmtt-10x-x-109">2 </span>is considerably faster than <br 
class="newline" /><span 
class="cmtt-10x-x-109">SQRT(SQUARE(U) + SQUARE(V)) </span><!--l. 2816--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>
     <span 
class="cmtt-10x-x-109">1000</span>, because the <span 
class="cmtt-10x-x-109">SQRT </span>function does not need to be evaluated for each row.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">TIME IN [</span><!--l. 2820--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn> <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-punc">:</mo><mo 
class="MathClass-rel">&#x003C;</mo> <mn>4</mn></math><span 
class="cmtt-10x-x-109">]</span>
     is faster than <span 
class="cmtt-10x-x-109">TIME</span><!--l. 2821--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math><span 
class="cmtt-10x-x-109">0</span>
     <span 
class="cmtt-10x-x-109">&amp;&amp; TIME</span><!--l. 2821--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math><span 
class="cmtt-10x-x-109">4</span>,
     because in the first way the column is accessed only once.
     </li>
     <li class="itemize">Returning a column from a subquery can be done directly or as a set. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-93">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;time&#x00A0;IN
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;time&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5]
</div>
     <!--l. 2830--><p class="nopar" > could also be expressed as
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-94">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;time&#x00A0;IN
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5&#x00A0;GIVING&#x00A0;[time]]
</div>
     <!--l. 2835--><p class="nopar" > The latter (as a set) is slower. So, if possible, the column should be returned directly. This is also
     easier to write. <br 
class="newline" />An even more important optimization for this query is writing it as:
                                                                                         

                                                                                         
</p>
     <div class="verbatim" id="verbatim-95">
     &#x00A0;&#x00A0;SELECT&#x00A0;FROM&#x00A0;maintable&#x00A0;WHERE&#x00A0;time&#x00A0;IN
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[SELECT&#x00A0;DISTINCT&#x00A0;time&#x00A0;FROM&#x00A0;othertable&#x00A0;WHERE&#x00A0;windspeed&#x00A0;&#x003C;&#x00A0;5]
</div>
     <!--l. 2842--><p class="nopar" > Using the DISTINCT qualifier has the effect that duplicates are removed which often results in a
     much smaller set.
     </p></li>
     <li class="itemize">Testing if a subquery contains at least N elements can be done in two ways:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-96">
     &#x00A0;&#x00A0;count([select&#x00A0;column&#x00A0;from&#x00A0;table&#x00A0;where&#x00A0;expression])&#x00A0;&#x003E;=&#x00A0;N
     &#x00A0;<br />and
     &#x00A0;<br />&#x00A0;&#x00A0;exists&#x00A0;(select&#x00A0;from&#x00A0;table&#x00A0;where&#x00A0;expression&#x00A0;limit&#x00A0;N)
</div>
     <!--l. 2853--><p class="nopar" > The second form is by far the best, because in that case the subquery will stop the matching
     process as soon as N matching rows are found. The first form will do the subquery for the entire
     table. <br 
class="newline" />Furthermore in the first form a column has to be selected, which is not needed in the second
     form.
     </p></li>
     <li class="itemize">Sometimes operator <span 
class="cmtt-10x-x-109">IN </span>and function <span 
class="cmtt-10x-x-109">ANY </span>can be used to test if an element in an array matches a
     value. E.g.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-97">
     &#x00A0;&#x00A0;WHERE&#x00A0;any(arraycolumn&#x00A0;==&#x00A0;value)
     &#x00A0;<br />and
     &#x00A0;<br />&#x00A0;&#x00A0;WHERE&#x00A0;value&#x00A0;IN&#x00A0;arraycolumn
</div>
     <!--l. 2867--><p class="nopar" > give the same result. Operator <span 
class="cmtt-10x-x-109">IN </span>is faster because it stops when it finds a match. If
     using <span 
class="cmtt-10x-x-109">ANY </span>all elements are compared first and thereafter <span 
class="cmtt-10x-x-109">ANY </span>tests the resulting bool
     array.
     </p></li>
     <li class="itemize">It was already shown in the <a 
href="#x1-330004.8">section 4.8</a> that indexing arrays should be done with care.</li></ul>
<!--l. 2879--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-610006"></a>Modifying a table</h3>
<!--l. 2880--><p class="noindent" >Usually TaQL will be used to get a subset from a table. However, as described in the first sections, it can
also be used to change the contents of a table using the UPDATE, INSERT, or DELETE
command. Note that a table has to be writable, otherwise those commands exit with an error
message.
</p><!--l. 2886--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-620006.1"></a>UPDATE</h4>
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-98">
&#x00A0;&#x00A0;UPDATE&#x00A0;table_list&#x00A0;SET&#x00A0;update_list&#x00A0;[WHERE&#x00A0;...]&#x00A0;[ORDERBY&#x00A0;...]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[LIMIT&#x00A0;...]&#x00A0;[OFFSET&#x00A0;...]
</div>
<!--l. 2890--><p class="nopar" > updates all or some rows in the first table of the table list. Other tables can be used in clauses like SET
and WHERE. <br 
class="newline" /><span 
class="cmtt-10x-x-109">update</span><span 
class="cmtt-10x-x-109">_list </span>is a comma-separated list of <span 
class="cmtt-10x-x-109">column=expression </span>parts. Each part tells to update the given
column using the expression. Both scalar and array columns are supported. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-99">
&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;ANTENNA1=ANTENNA1-1,&#x00A0;ANTENNA2=ANTENNA2-1
</div>
<!--l. 2900--><p class="nopar" > to make the antenna numbers zero-based if accidently they were written one-based.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-100">
&#x00A0;&#x00A0;UPDATE&#x00A0;this.ms,&#x00A0;that.ms&#x00A0;t2&#x00A0;set&#x00A0;DATA=t2.DATA,&#x00A0;FLAG=t2.FLAG
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;where&#x00A0;all(FLAG)
</div>
<!--l. 2907--><p class="nopar" > to copy the DATA and FLAG column of that.ms to this.ms for rows where all data are flagged. Note the
use of the shorthand (alias) <span 
class="cmtt-10x-x-109">t2</span>.
</p><!--l. 2911--><p class="indent" >   If an array gets an array value, the shape of the array can be changed (provided it is allowed for that
table column). Arrays can also be updated with a scalar value causing all elements in the array to be set
to that scalar value.
</p><!--l. 2916--><p class="indent" >   It is also possible to update part of an array using <a 
href="#x1-330004.8">array indexing</a>. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-101">
&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;FLAG[1,1]=T
&#x00A0;<br />&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;FLAG[1,]=T
&#x00A0;<br />&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;FLAG=F
</div>
<!--l. 2922--><p class="nopar" > The first example sets only a single array element, while the second one sets an entire row
in the array. The second and third example show it is possible to set an array to a scalar
value.
</p><!--l. 2927--><p class="indent" >   Type promotion and demotion will be done as much as possible. For example, an integer column can
get the value of a double expression (the result will be truncated). <br 
class="newline" />Unit conversion will be done as needed. Thus if a column and its expression have different units, the
expression result is automatically converted to the column&#8217;s unit. Of course, the units must be of the same
type to be able to convert the data.
</p><!--l. 2935--><p class="indent" >   Note that if multiple <span 
class="cmtt-10x-x-109">column=expression </span>parts are given, the columns are changed in
the order as specified in the update-list. It means that if an updated column is used in an
expression for a later column, the new value is used when evaluating the expression. E.g.
in
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-102">
&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;DATA=DATA+1,&#x00A0;SUMD=sum(DATA)
</div>
<!--l. 2942--><p class="nopar" > the <span 
class="cmtt-10x-x-109">SUMD </span>update uses the new <span 
class="cmtt-10x-x-109">DATA </span>values.
</p><!--l. 2945--><p class="indent" >   Thus to swap the values of the ANTENNA1 and ANTENNA2 column, one can <span 
class="cmbx-10x-x-109">not </span>do:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-103">
&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;ANTENNA1=ANTENNA2,&#x00A0;ANTENNA2=ANTENNA1
</div>
<!--l. 2949--><p class="nopar" > TaQL does not have temporary variables to solve the problem. However, the following could be
used:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-104">
&#x00A0;&#x00A0;UPDATE&#x00A0;vla.ms&#x00A0;SET&#x00A0;ANTENNA1=ANTENNA1+ANTENNA2,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ANTENNA2=ANTENNA1-ANTENNA2,&#x00A0;&#x00A0;#A2&#x00A0;is&#x00A0;old&#x00A0;A1
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ANTENNA1=ANTENNA1-ANTENNA2&#x00A0;&#x00A0;&#x00A0;#A1&#x00A0;is&#x00A0;old&#x00A0;A2
</div>
<!--l. 2956--><p class="nopar" >
</p><!--l. 2959--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-630006.2"></a>INSERT</h4>
<!--l. 2960--><p class="noindent" >The <span 
class="cmtt-10x-x-109">INSERT </span>command adds rows to the table. It can take two forms:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-105">
&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;table_list&#x00A0;[(column_list)]&#x00A0;VALUES&#x00A0;(expr_list)
&#x00A0;<br />&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;table_list&#x00A0;[(column_list)]&#x00A0;SELECT_command
</div>
<!--l. 2964--><p class="nopar" > The first form adds one row to the table and puts the values given in the expression list into the columns
given in the column list. If the column list is not given, it defaults to all stored columns in the table in the
order as they appear in the table description. Each expression in the expression list can be as complex as
needed; for example, a subquery can also be given. Note that a subquery is evaluated before the new row
is added, so the new row is not taken into account if the subquery is done on the table being modified.
<br 
class="newline" />It should be clear that the number of columns has to match the number of expressions. <br 
class="newline" />Note that row cells not mentioned in the column list, are not written, thus may contain rubbish.
<br 
class="newline" />The data types and units of expressions and columns have to conform in the same way as for
the UPDATE command; values have to be convertible to the column data type and unit.
<br 
class="newline" />For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-106">
&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;my.ms&#x00A0;(ANTENNA1,ANTENNA2)&#x00A0;VALUES&#x00A0;(0,1)
</div>
<!--l. 2984--><p class="nopar" > adds one row, puts 0 in ANTENNA1 and 1 in ANTENNA2.
</p><!--l. 2987--><p class="indent" >   The second form evaluates the SELECT command and copies the rows found in the selection to the
table being modified (which is given in the INTO part). The columns used in the modified table are
defined in the column list. As above, they default to all stored columns. The columns used in the selection
have to be defined in the column-list part of the SELECT command. They also default to all stored
columns. <br 
class="newline" />For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-107">
&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;my.ms&#x00A0;select&#x00A0;FROM&#x00A0;my.ms
</div>
<!--l. 2997--><p class="nopar" > appends all rows and columns of <span 
class="cmtt-10x-x-109">my.ms </span>to itself. Please note that only the original number of rows is
copied.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-108">
&#x00A0;&#x00A0;INSERT&#x00A0;INTO&#x00A0;my.ms&#x00A0;(ANTENNA1,ANTENNA2)&#x00A0;select&#x00A0;ANTENNA2,ANTENNA1
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;other.ms&#x00A0;WHERE&#x00A0;ANTENNA1&#x003E;0
</div>
<!--l. 3003--><p class="nopar" > copies rows from <span 
class="cmtt-10x-x-109">other.ms </span>where ANTENNA1<!--l. 3004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>0.
It swaps the values of ANTENNA1 and ANTENNA2. All other columns are not written, thus may
contain rubbish.
</p><!--l. 3008--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-640006.3"></a>DELETE</h4>
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-109">
&#x00A0;&#x00A0;DELETE&#x00A0;FROM&#x00A0;table_list
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[WHERE&#x00A0;...]&#x00A0;[ORDERBY&#x00A0;...]&#x00A0;[LIMIT&#x00A0;...]&#x00A0;[OFFSET&#x00A0;...]
</div>
<!--l. 3012--><p class="nopar" > deletes some or all rows from a table.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-110">
&#x00A0;&#x00A0;DELETE&#x00A0;FROM&#x00A0;my.ms&#x00A0;WHERE&#x00A0;ANTENNA1&#x003E;13&#x00A0;OR&#x00A0;ANTENNA2&#x003E;13
</div>
<!--l. 3016--><p class="nopar" > deletes the rows matching the WHERE expression. <br 
class="newline" />If no selection is done, all rows will be deleted. <br 
class="newline" />It is possible to specify more than one table in the FROM clause to be able to use, for example,
keywords from other tables. Rows will be deleted from the first table mentioned in the FROM
part.
</p><!--l. 3023--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-650007"></a>Creating a new table</h3>
<!--l. 3024--><p class="noindent" >TaQL can be used to create a new table. The data managers to be used can be given in full
detail.
</p><!--l. 3027--><p class="indent" >   The syntax is:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-111">
&#x00A0;&#x00A0;CREATE&#x00A0;TABLE&#x00A0;tablename&#x00A0;colspec&#x00A0;DMINFO&#x00A0;datamans
</div>
<!--l. 3030--><p class="nopar" > The columns are defined in the <span 
class="cmtt-10x-x-109">colspec </span>part. If not given, an empty table is created. <br 
class="newline" />Data managers can be defined in the <span 
class="cmtt-10x-x-109">datamans </span>part.
</p><!--l. 3035--><p class="indent" >   The <span 
class="cmtt-10x-x-109">colspec </span>part can optionally be enclosed in square brackets or parentheses (for SQL
compatibility). It is a comma separated list of column specifications. Each specification looks
like:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-112">
&#x00A0;&#x00A0;columnname&#x00A0;datatype&#x00A0;[NDIM=n,&#x00A0;SHAPE=[d1,d2,...],&#x00A0;UNIT=&#8217;s&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DMTYPE=&#8217;s&#8217;,DMGROUP=&#8217;s&#8217;,COMMENT=&#8217;s&#8217;]
</div>
<!--l. 3042--><p class="nopar" > The possible data type strings are given in <a 
href="#x1-170004.1">section 4.1</a>. The part enclosed in square brackets is optional.
Zero or more of these keywords can be used. It makes it possible to define array columns and/or default
data manager to be used. The square brackets are optional if only one such keyword is used.
</p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10x-x-109">NDIM=n </span>defines if the column contains scalars or arrays. <br 
class="newline" />A negative value means a scalar (unless shape is also given). A value 0 means an array of any
     dimensionality. A positive value means an array with the given dimensionality.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">SHAPE=[d1,d2,...] </span>makes it possible to define the exact array shape. <br 
class="newline" />If given and if NDIM is positive, they should be consistent.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">UNIT=&#8217;s&#8217; </span>defines the unit to be used for the column. <br 
class="newline" />It can be any valid unit (simple or compound). It is a string, thus must always be enclosed
     in quotes.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">COMMENT </span>defines comments for the column. <br 
class="newline" />It has a string value, thus quotes have to be used.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">DMTYPE, DMGROUP </span>are rather specific and are for the expert user. <br 
class="newline" />They have a string value, thus quotes have to be used.</li></ul>
<!--l. 3068--><p class="indent" >   The <span 
class="cmtt-10x-x-109">dataman </span>part makes it possible for the expert user to define the data managers to be used by
columns. It is a comma separated list of data manager specifications looking like the output of the
<span 
class="cmtt-10x-x-109">table.getdminfo </span>command in Python or Glish. Each specification has to be enclosed in square brackets.
For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-113">
&#x00A0;&#x00A0;dminfo&#x00A0;[NAME="ISM1",TYPE="IncrementalStMan",COLUMNS=["col1"]],
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[NAME="SSM1",TYPE="StandardStMan",
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SPEC=[BUCKETSIZE=1000],COLUMNS=["col2","col3"]]
</div>
<!--l. 3078--><p class="nopar" > The case of the keyword names used (e.g. NAME) is important. They have to be given in uppercase. The
following keywords can be given: <br 
class="newline" /><span 
class="cmtt-10x-x-109">NAME </span>defines the unique name of the data manager. <br 
class="newline" /><span 
class="cmtt-10x-x-109">TYPE </span>defines the type of data manager. <br 
class="newline" /><span 
class="cmtt-10x-x-109">SPEC </span>is a list of keywords giving the characteristics of the data manager. This is highly data manager type
specific. If shapes have to be given here, they always have to be in casacore format, thus in Fortran order.
TaQL has no knowledge about these internals. <br 
class="newline" /><span 
class="cmtt-10x-x-109">COLUMNS </span>is a list of column names defining all columns that have to be bound to the data
manager.
</p><!--l. 3092--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-660008"></a>Counting in a table</h3>
<!--l. 3093--><p class="noindent" >TaQL does not have a GROUPBY command (yet). However, it has a command that can be used to count
the number of occurrences in a table.
</p><!--l. 3096--><p class="indent" >   The exact syntax is:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-114">
&#x00A0;&#x00A0;COUNT&#x00A0;column-list&#x00A0;FROM&#x00A0;table-list&#x00A0;[WHERE&#x00A0;expression]
</div>
<!--l. 3099--><p class="nopar" > It counts the number of rows for each unique tuple in the column list of the table (after the possible
WHERE selection is done). For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-115">
&#x00A0;&#x00A0;COUNT&#x00A0;TIME&#x00A0;FROM&#x00A0;my.ms
</div>
<!--l. 3105--><p class="nopar" > counts the number of rows per timestamp.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-116">
&#x00A0;&#x00A0;COUNT&#x00A0;ANTENNA1,ANTENNA2&#x00A0;FROM&#x00A0;my.ms
</div>
<!--l. 3109--><p class="nopar" > counts the number of rows per baseline.
</p><!--l. 3112--><p class="indent" >   As in the other TaQL commands a column in the column list can be any expression, but that will be
slower than straight columns.
</p><!--l. 3115--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-670009"></a>Calculations on a table</h3>
<!--l. 3116--><p class="noindent" >TaQL can be used to get derived values from a table by means of an expression. The expression can result
in any data type and value type. For example, if the expression uses an array column, the result
might be a vector of arrays (an array for each row). If the expression uses a scalar column, the
result might be a vector of scalars or even a single scalar if a reduction function like SUM is
used.
</p><!--l. 3123--><p class="indent" >   The exact syntax is:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-117">
&#x00A0;&#x00A0;CALC&#x00A0;expression&#x00A0;[FROM&#x00A0;table_list]
</div>
<!--l. 3126--><p class="nopar" > The part in square brackets can be omitted if no column is (directly) used in the expression. The
examples will make clear what that means. <br 
class="newline" />The following syntax is still available for backward compatibility:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-118">
&#x00A0;&#x00A0;CALC&#x00A0;FROM&#x00A0;table_list&#x00A0;CALC&#x00A0;expression
</div>
<!--l. 3132--><p class="nopar" >
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-119">
&#x00A0;&#x00A0;CALC&#x00A0;1in&#x00A0;cm
</div>
<!--l. 3136--><p class="nopar" > is a simple expression not using a table. It shows how the CALC command can be used as a desk
calculator to convert 1 inch to cm.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-120">
&#x00A0;&#x00A0;CALC&#x00A0;mean(column1+column2)&#x00A0;FROM&#x00A0;mytable
</div>
<!--l. 3142--><p class="nopar" > gives a vector of scalars containing the mean per row.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-121">
&#x00A0;&#x00A0;CALC&#x00A0;sum([SELECT&#x00A0;FROM&#x00A0;mytable&#x00A0;GIVING&#x00A0;[mean(column1+column2)]])
</div>
<!--l. 3147--><p class="nopar" > gives a single scalar giving the sum of the means in each row. Note that in this command the CALC
command does not need the FROM clause, because it does not use a column itself. Columns are only used
in the nested query which has a FROM clause itself.
</p><!--l. 3153--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-6800010"></a>Examples</h3>
<!--l. 3154--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-6900010.1"></a>Selection examples</h4>
<!--l. 3155--><p class="noindent" >Some examples are given starting with simple ones.
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.1.1   </span> <a 
 id="x1-7000010.1.1"></a>Reference table results</h5>
<!--l. 3157--><p class="noindent" >The result of the following queries is a reference table, because no expressions have been given in the
column-list. This will be the most common case when using TaQL.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable WHERE column1 </span><!--l. 3161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>
     <span 
class="cmtt-10x-x-109">0  </span><br 
class="newline" />selects the rows in which the value of column1 <!--l. 3162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>
     0
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT column0,column1 FROM mytable  </span><br 
class="newline" />selects 2 columns from the table.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT column0,column1 FROM mytable WHERE column1</span><!--l. 3167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math><span 
class="cmtt-10x-x-109">0</span>
     <br 
class="newline" />is a combination of the previous selections.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM [SELECT FROM mytable ORDERBY column0 DESC]  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">WHERE rownumber()</span><!--l. 3171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math><span 
class="cmtt-10x-x-109">10</span>
     <br 
class="newline" />selects the 10 highest values of <span 
class="cmtt-10x-x-109">column0</span>.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable ORDERBY column0 DESC LIMIT 10  </span><br 
class="newline" />is a more elegant solution using the newer LIMIT clause.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable ORDERBY column0 DESC GIVING outtable  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">SELECT FROM outtable WHERE rownumber()</span><!--l. 3178--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math><span 
class="cmtt-10x-x-109">10</span>
     <br 
class="newline" />is the SQL-like solution for the previous problem. It is less elegant, because it requires two
     steps.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable WHERE column0 IN  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[SELECT column0 FROM mytable ORDERBY column0 DESC][1:10]  </span><br 
class="newline" />is similar to above, but can select more rows if there happen to be several equal values.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM some.MS WHERE  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">near(MJD(1999/03/30/17:27:15), TIME)  </span><br 
class="newline" />selects the rows with the given time from a MeasurementSet. <br 
class="newline" />Note that the TIME is stored in seconds, but will automatically be converted to days.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM some.MS where TIME in  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmtt-10x-x-109">MJD(1999/03/30/17:27:15),MJD(1999/03/30/17:29:15)</span><span 
class="cmsy-10x-x-109">}</span><span 
class="cmtt-10x-x-109">]  </span><br 
class="newline" />selects the rows in the given closed time interval.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM some.MS where TIME in  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[MJD(1999/03/30/17:27:15),MJD(1999/03/30/17:29:15)]  </span><br 
class="newline" />selects the rows having one of the given times. <br 
class="newline" />Note the difference with the previous example where an interval was given. Here a set of two
     individual time values is given.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM resource.table WHERE </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">any(PValues == pattern(&#8217;synth*&#8217;)) </span><br 
class="newline" />selects the rows in which an element in array <span 
class="cmtt-10x-x-109">PValues </span>matches the given regular expression.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM table WHERE ntrue(flags) &#x003E;= 3 </span><br 
class="newline" />selects rows where at least 3 elements of array <span 
class="cmtt-10x-x-109">flags </span>are set.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM book.table WHERE nelements(author) &#x003E; 1 </span><br 
class="newline" />selects books with more than 1 author.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM my.ms WHERE any(ANTENNA1==[0,0,1] &amp;&amp; ANTENNA2==[1,3,2]) </span><br 
class="newline" />selects the antenna pairs (baselines) 0-1, 0-3, and 1-2. <br 
class="newline" />Note that the two comparisons result in a boolean vector. If a bool in the and-ed vectors is
     true, that baseline matches.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM this.ms t1, that.ms t2 </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">WHERE !all(near(t1.DATA, t2.DATA, 1e-5)) </span><br 
class="newline" />selects all rows where the DATA columns in both tables are not equal (with some tolerance).
     Note the use of shorthands t1 and t2.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable WHERE </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">cos(0d1m) </span><!--l. 3229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>
     <span 
class="cmtt-10x-x-109">sin(52deg) * sin(DEC) + cos(52deg) * cos(DEC) * cos(3h30m - RA)  </span><br 
class="newline" />selects observations with an equatorial position (in say J2000) inside a cone with a radius of 1
     arcmin around (3h30m, 52deg). To find them the condition DISTANCE<!--l. 3232--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math>RADIUS
     must be fulfilled, which is equivalent to COS(RADIUS)<!--l. 3233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">=</mo></math>COS(DISTANCE).
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable WHERE </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[RA,DEC] INCONE [3h30m, 52deg, 0d1m]  </span><br 
class="newline" />does the same as above in an easier (and faster) way.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT FROM mytable WHERE object == pattern("3C*") &amp;&amp; </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[RA,DEC] INCONE [3h30m, 52deg, 0d1m]  </span><br 
class="newline" />finds all 3C objects inside that cone.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">select from MY.MS where DATA</span><span 
class="cmtt-10x-x-109">_DESC</span><span 
class="cmtt-10x-x-109">_ID in </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">[select from ::DATA</span><span 
class="cmtt-10x-x-109">_DESCRIPTION where </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">SPECTRAL</span><span 
class="cmtt-10x-x-109">_WINDOW</span><span 
class="cmtt-10x-x-109">_ID in [0,2,4] giving [ROWID()]] </span><br 
class="newline" />finds all rows in a measurement set matching the given spectral windows.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">select from MY.MS where TIME in </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">[select from ::SOURCE where REST</span><span 
class="cmtt-10x-x-109">_FREQUENCY </span><!--l. 3250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>
     <span 
class="cmtt-10x-x-109">180000000. </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">giving [TIME-INTERVAL/2 =:= TIME+INTERVAL/2]] </span><br 
class="newline" />finds all rows in a measurement set observing sources with a rest frequency less than 180
     Mhz.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">select from MS, </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">[select from MS where sumsqr(UVW[1:2]) &#x003C; 625] as TIMESEL </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">where TIME in [select distinct TIME from TIMESEL] </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">&amp;&amp; any([ANTENNA1,ANTENNA2] in [select from TIMESEL giving </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">[iif(UVW[3] &#x003C; 0, ANTENNA1, ANTENNA2)]]) </span><br 
class="newline" />finds all antennas which are shadowed at a given time. <br 
class="newline" />The query in the FROM command finds all rows where an antenna is shadowed (i.e. its
     UV-distance less than 25 meters) and creates a temporary table. This selection is done in the
     FROM command, otherwise two 2 equal selections are needed in the main WHERE command.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">select from MS </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">where DATA</span><span 
class="cmtt-10x-x-109">_DESC</span><span 
class="cmtt-10x-x-109">_ID in [select from ::DATA</span><span 
class="cmtt-10x-x-109">_DESCRIPTION </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">where SPECTRAL</span><span 
class="cmtt-10x-x-109">_WINDOW</span><span 
class="cmtt-10x-x-109">_ID in [select from ::SPECTRAL</span><span 
class="cmtt-10x-x-109">_WINDOW </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">where NET</span><span 
class="cmtt-10x-x-109">_SIDEBAND==1 giving [ROWID()]] giving [ROWID()]] </span><br 
class="newline" />finds all rows in the MeasurementSet with the given NET_SIDEBAND. <br 
class="newline" />The MeasurementSet uses a table to map spectral-window-id to data-desc-id. Hence two
     nested subqueries are needed.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">select findcone(REFERENCE</span><span 
class="cmtt-10x-x-109">_DIR[0,], </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">[16h34m33.805,62d45m36.83, 12h29m06.7,2d3m9], 1arcsec) </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">from MS/FIELD </span>//compares the direction given in the first argument with the directions given
     in the second function argument using the search radius given in the third argument. It
     returns the index of the first matching cone (thus 0 or 1). If no cone matches, it returns -1.
     <br 
class="newline" />It can be used in the following example to find the name of the source matching a direction.
     </dd><dt class="description">
 </dt><dd 
class="description"><span 
class="cmtt-10x-x-109">select [&#8217;unknown&#8217;,&#8217;3C343&#8217;, &#8217;3C273&#8217;][1+int(findcone(...))] </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">from MS/FIELD </span>where ... is the findcone argument list given in the previous example. 1 is
     added to cope with the case that no cone matches. <br 
class="newline" />Note that the conversion to int is done to circumvent a small bug in TaQL.</dd></dl>
<!--l. 3294--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.1.2   </span> <a 
 id="x1-7100010.1.2"></a>Plain table results</h5>
<!--l. 3295--><p class="noindent" >The following examples result in a plain table, thus in a deep copy of the query results, because the
column-list contains an expression or a data type.
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT column0+column1 FROM mytable  </span><br 
class="newline" />creates a table of 1 column with name Col_1. Its data type is on the expression data type.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT column0+column1 Res I4 FROM mytable  </span><br 
class="newline" />creates a table of 1 column with name <span 
class="cmtt-10x-x-109">Res</span>. Its data type is a 4 byte signed integer.
                                                                                         

                                                                                         
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT colx colx R4 FROM mytable  </span><br 
class="newline" />creates a table of 1 column with name <span 
class="cmtt-10x-x-109">colx</span>. The sole purpose of this selection is to convert
     the data type of the column.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">SELECT means(DATA,0) AS DATA</span><span 
class="cmtt-10x-x-109">_MEAN C4 FROM my.ms  </span><br 
class="newline" />creates  a  table  of  1  column  with  name  <span 
class="cmtt-10x-x-109">DATA</span><span 
class="cmtt-10x-x-109">_MEAN</span>.  Column  DATA  in  a  Casacore
     MeasurementSet is a 2-dimensional array with axes polarization and frequency. This command
     calculates and stores the mean in each polarization. If no data type was given, the means
     would have been stored as double precision complex (which is the expression data type). <br 
class="newline" />Note that this command is valid when using python style; in glish style <span 
class="cmtt-10x-x-109">MEANS(DATA,2) </span>should
     be used.
     </dd></dl>
<!--l. 3324--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.2   </span> <a 
 id="x1-7200010.2"></a>Modification examples</h4>
<!--l. 3325--><p class="noindent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">update MY.MS set VIDEO</span><span 
class="cmtt-10x-x-109">_POINT=MEANS(DATA,2) where isdefined(DATA)  </span><br 
class="newline" />sets the VIDEO_POINT of each correlation to the mean of the DATA for that correlation.
     Note that the 2 indicates averaging over the second axis, thus the frequency axis.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">update MY.MS set FLAG</span><span 
class="cmtt-10x-x-109">_ROW=T where isdefined(FLAG) &amp;&amp; all(FLAG) </span><br 
class="newline" />sets FLAG_ROW in the rows where the entire FLAG array is set.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">delete from MY.MS where FLAG</span><span 
class="cmtt-10x-x-109">_ROW </span><br 
class="newline" />deletes all flagged rows.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">insert into MY.MS select from OTHER.MS where !FLAG</span><span 
class="cmtt-10x-x-109">_ROW </span><br 
class="newline" />copies all unflagged rows from OTHER.MS to MY.MS.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">insert into MY.MS/DATA</span><span 
class="cmtt-10x-x-109">_DESCRIPTION </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">(SPECTRAL</span><span 
class="cmtt-10x-x-109">_WINDOW</span><span 
class="cmtt-10x-x-109">_ID,POLARIZATION</span><span 
class="cmtt-10x-x-109">_ID,FLAG</span><span 
class="cmtt-10x-x-109">_ROW) </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">values (1,0,F) </span><br 
class="newline" />adds a row to the DATA_DESCRIPTION subtable and initializes it.
     </dd></dl>
                                                                                         

                                                                                         
<!--l. 3348--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.2.1   </span> <a 
 id="x1-7300010.2.1"></a>Applying running median to an image</h5>
<!--l. 3349--><p class="noindent" >The following piece of Python code shows how a running median can be applied to an Casacore
image.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-122">
&#x00A0;&#x00A0;t1&#x00A0;=&#x00A0;tablecommand&#x00A0;(&#8217;update&#x00A0;my.imgd&#x00A0;set&#x00A0;map&#x00A0;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;map&#x00A0;-&#x00A0;runningmedian(map,25,25)&#8217;)
</div>
<!--l. 3354--><p class="nopar" > First the image is copied and thereafter the running medians are subtracted from the data in the copy. It
uses a half window size of 25x25, thus the full window is 51x51. <br 
class="newline" />When doing this, one should take care that in case of a spectral line cube the image is not too large,
otherwise it won&#8217;t fit in memory. If too large, it should be done in chunks like:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-123">
&#x00A0;&#x00A0;t1&#x00A0;=&#x00A0;tablecommand&#x00A0;(&#8217;update&#x00A0;my.imgd&#x00A0;set&#x00A0;map[,,sc:ec,]&#x00A0;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;map[,,sc:ec,]&#x00A0;-
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;runningmedian(map[,,sc:ec,],25,25)&#8217;)
</div>
<!--l. 3365--><p class="nopar" > where <span 
class="cmtt-10x-x-109">sc </span>and <span 
class="cmtt-10x-x-109">ec </span>are the start and end frequency channel. In this example it is assumed that the axes of
the image are RA, DEC, freq, Stokes. <br 
class="newline" />Note that <span 
class="cmtt-10x-x-109">imagecalc </span>is used to copy the image. It might also be done with table functions, but
<span 
class="cmtt-10x-x-109">imagecalc </span>has the great advantage that it also works on FITS and Miriad images.
</p><!--l. 3374--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.3   </span> <a 
 id="x1-7400010.3"></a>Table creation examples</h4>
<!--l. 3375--><p class="noindent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">create table mytab (col1 I4, col2 I4, col3 R8)  </span><br 
class="newline" />creates table <span 
class="cmtt-10x-x-109">mytab </span>of 3 scalar columns.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">create table mytab  </span><br 
class="newline" />creates an empty table.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">create table mytab colarr R4 ndim=0  </span><br 
class="newline" />creates a table of 1 array column with arbitrary dimensionality.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">create table mytab colarr R4 [shape=[4,128],  dmtype=&#8217;TiledColumnStMan&#8217;]  </span><br 
class="newline" />creates  a  table  of  1  array  column  with  the  given  shape.  The  column  is  stored  with  the
     TiledColumnStMan storage manager using its default settings.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">create table mytab colarr R4 shape=[4,128]  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">dminfo [TYPE=&#8217;TiledColumnStMan&#8217;, NAME=&#8217;TCSM&#8217;,  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">SPEC=[DEFAULTTILESHAPE=[4,32,64]],   COLUMNS=[&#8217;colarr&#8217;]] </span><br 
class="newline" />creates  a  table  of  1  array  column  with  the  given  shape.  The  column  is  stored  with  the
     TiledColumnStMan storage manager using the given settings.</dd></dl>
                                                                                         

                                                                                         
<!--l. 3400--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.4   </span> <a 
 id="x1-7500010.4"></a>Calculation examples</h4>
<!--l. 3401--><p class="noindent" >
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc 1+2  </span><br 
class="newline" />uses TaQL as a desktop calculator.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc 7-Apr-2007 - 20-Nov-1979  </span><br 
class="newline" />calculates the number of days between these dates.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc (1-1-2006 - 1-1-1950)%365  </span><br 
class="newline" />calculates the number of leap days in this time span.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc sum([select from MY.MS giving [ntrue(FLAG)]])  </span><br 
class="newline" />determines the total number of flags set in the measurement set.
     </dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc mean(abs(DATA))  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">from [select from MY.MS where ANTENNA1==0]</span>
     <!--l. 3417--><p class="noindent" >calculates for each row the mean of the data for the selected subset of the measurement set.
     </p></dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc mean([select from MY.MS where ANTENNA1==0  </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">giving [mean(abs(DATA))]])</span>
     <!--l. 3423--><p class="noindent" >looks like the previous example. It, however, calculates the mean of the mean of the data in
     each row for the selected subset of the measurement set.
     </p></dd><dt class="description">
 </dt><dd 
class="description">  <span 
class="cmtt-10x-x-109">calc max([select from MY.MS where isdefined(DATA)  </span><br 
class="newline" /> <span 
class="cmtt-10x-x-109">giving [max(abs(VIDEO</span><span 
class="cmtt-10x-x-109">_POINT-MEANS(DATA,0)))]])</span>
     <!--l. 3430--><p class="noindent" >shows the maximum absolute difference between VIDEO_POINT of each correlation and the
     mean of the DATA for that correlation. Note that the 2 indicates averaging over the first axis,
     thus the frequency axis.
</p>
     </dd></dl>
<!--l. 3438--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-7600011"></a>Interface to TaQL</h3>
                                                                                         

                                                                                         
<!--l. 3439--><p class="noindent" >User and a programmer interfaces to TaQL are available. The program <span 
class="cmtt-10x-x-109">taql </span>and some Python and Glish
functions form the user interface, while C++ classes and functions form the programmer
interface.
</p><!--l. 3444--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.1   </span> <a 
 id="x1-7700011.1"></a>Python interface <span 
class="cmtt-10x-x-109">pyrap</span></h4>
<!--l. 3445--><p class="noindent" >The main TaQL interface in Python is formed by the <a 
href="../../../pyrap/docs/pyrap_tables.html#pyrap.tables.table.query" ><span 
class="cmtt-10x-x-109">query</span></a> function in module <a 
href="../../../pyrap/docs/pyrap_tables.html" ><span 
class="cmtt-10x-x-109">table</span></a>. The function can
be used to compose and execute a TaQL command using the various (optional) arguments given to the
<span 
class="cmtt-10x-x-109">query </span>function. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-124">
&#x00A0;&#x00A0;&#x00A0;tab&#x00A0;=&#x00A0;table(&#8217;mytable&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;seltab1&#x00A0;=&#x00A0;tab.query&#x00A0;(&#8217;column1&#x00A0;&#x003E;&#x00A0;0&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;seltab2&#x00A0;=&#x00A0;seltab1.query&#x00A0;(query=&#8217;column2&#x003E;5&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sortlist=&#8217;time&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;columns=&#8217;column1,column2&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;name=&#8217;result.tab&#8217;)
</div>
<!--l. 3459--><p class="nopar" > The first command opens the table <span 
class="cmtt-10x-x-109">mytable</span>. The second command does a simple query resulting in a
temporary table. That temporary table is used in the next command resulting in a persistent table. The
latter function call is transformed to the TaQL command: <br 
class="newline" /><span 
class="cmtt-10x-x-109">SELECT column1,column2 FROM $1 WHERE column2&#x003E;5 </span><br 
class="newline" /><span 
class="cmtt-10x-x-109">ORDERBY time GIVING result.tab </span><br 
class="newline" />During execution $1 is replaced by table <span 
class="cmtt-10x-x-109">seltab1</span>. <br 
class="newline" />Note that the <span 
class="cmtt-10x-x-109">name </span>argument generates the <span 
class="cmtt-10x-x-109">GIVING </span>part to make the result persistent.
</p><!--l. 3471--><p class="indent" >   The functions <span 
class="cmtt-10x-x-109">sort </span>and <span 
class="cmtt-10x-x-109">select </span>exist as convenience functions for a query consisting of a sort or
column selection only. Both functions have an optional second <span 
class="cmtt-10x-x-109">name </span>parameter to make the result
persistent.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-125">
&#x00A0;&#x00A0;&#x00A0;t1&#x00A0;=&#x00A0;tab.sort&#x00A0;(&#8217;time&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;t1&#x00A0;=&#x00A0;tab.select&#x00A0;(&#8217;column1,column2&#8217;)
</div>
<!--l. 3478--><p class="nopar" >
</p><!--l. 3480--><p class="indent" >   The <span 
class="cmtt-10x-x-109">calc </span>function can be used to execute a TaQL <span 
class="cmtt-10x-x-109">calc </span>command on the current table. The result can
be kept in a variable. For example, the following returns a vector containing the median of the <span 
class="cmtt-10x-x-109">DATA</span>
column in each table row:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-126">
&#x00A0;&#x00A0;med&#x00A0;=&#x00A0;t.calc&#x00A0;(&#8217;median(DATA)&#8217;)
</div>
<!--l. 3486--><p class="nopar" >
</p><!--l. 3488--><p class="indent" >   It is possible to embed Python variables and expressions in a TaQL command using the syntax
<span 
class="cmtt-10x-x-109">$variable </span>and <span 
class="cmtt-10x-x-109">$(expression)</span>. A variable can be a standard numeric or string scalar or vector. It
can also be a table tool. An expression has to result in a numeric or string scalar or vector.
E.g
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-127">
&#x00A0;&#x00A0;from&#x00A0;pyrap.tables&#x00A0;import&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;tab&#x00A0;=&#x00A0;table(&#8217;mytable&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;coldata&#x00A0;=&#x00A0;tab.getcol&#x00A0;(&#8217;col&#8217;);
&#x00A0;<br />&#x00A0;&#x00A0;colmean&#x00A0;=&#x00A0;sum(coldata)&#x00A0;/&#x00A0;len(coldata);
&#x00A0;<br />&#x00A0;&#x00A0;seltab1&#x00A0;=&#x00A0;tab.query&#x00A0;(&#8217;col&#x00A0;&#x003E;&#x00A0;$colmean&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;seltab2&#x00A0;=&#x00A0;tab.query&#x00A0;(&#8217;col&#x00A0;&#x003E;&#x00A0;$(sum(coldata)/len(coldata))&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;seltab3&#x00A0;=&#x00A0;tab.query&#x00A0;(&#8217;col&#x00A0;&#x003E;&#x00A0;mean([SELECT&#x00A0;col&#x00A0;from&#x00A0;$tab])&#8217;)
</div>
<!--l. 3502--><p class="nopar" > These three queries give the same result. <br 
class="newline" />The substitution mechanism is described in more detail in <a 
href="../../../pyrap/docs/pyrap_util.html" >pyrap.util</a>.
</p><!--l. 3507--><p class="indent" >   The other function that can be used is <a 
href="../../../pyrap/docs/pyrap_tables.html#pyrap.tables.taql" >taql</a> (or its synonym <span 
class="cmtt-10x-x-109">tablecommand</span>). The full TaQL command
has to be given to that command. The result is a table object. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-128">
&#x00A0;&#x00A0;t&#x00A0;=&#x00A0;taql(&#8217;select&#x00A0;from&#x00A0;GER.MS&#x00A0;where&#x00A0;ANTENNA1==1&#8217;);
</div>
<!--l. 3514--><p class="nopar" >
</p><!--l. 3516--><p class="indent" >   By default, these commands will use the Python style for a TaQL statement. The <span 
class="cmtt-10x-x-109">style </span>argument can
be used to choose another style.
</p><!--l. 3520--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.2   </span> <a 
 id="x1-7800011.2"></a>Interface to Glish</h4>
<!--l. 3521--><p class="noindent" >The Glish interface is formed by script <span 
class="cmtt-10x-x-109">table.g</span>. By default, it will use the Glish style for a TaQL
statement. For example:
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-129">
&#x00A0;&#x00A0;include&#x00A0;&#8217;table.g&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;tab&#x00A0;:=&#x00A0;table(&#8217;mytable&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;seltab1&#x00A0;:=&#x00A0;tab.query&#x00A0;(&#8217;column1&#x00A0;&#x003E;&#x00A0;0&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;seltab2&#x00A0;:=&#x00A0;seltab1.query&#x00A0;(query=&#8217;column2&#x003E;5&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sortlist=&#8217;time&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;columns=&#8217;column1,column2&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;name=&#8217;result.tab&#8217;)
&#x00A0;<br />&#x00A0;&#x00A0;t&#x00A0;:=&#x00A0;tablecommand(&#8217;select&#x00A0;from&#x00A0;GER.MS&#x00A0;where&#x00A0;ANTENNA1==1&#8217;,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;style=&#8217;&#8217;);&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;use&#x00A0;default&#x00A0;(glish)&#x00A0;style
&#x00A0;<br />&#x00A0;&#x00A0;med&#x00A0;:=&#x00A0;t.calc&#x00A0;(&#8217;median(DATA)&#8217;)
</div>
<!--l. 3536--><p class="nopar" >
</p><!--l. 3538--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.3   </span> <a 
 id="x1-7900011.3"></a>Program <span 
class="cmtt-10x-x-109">taql</span></h4>
<!--l. 3539--><p class="noindent" >The program <span 
class="cmtt-10x-x-109">taql </span>makes it possible to execute TaQL commands from the shell. <br 
class="newline" />The first way to run it is by giving the TaQL command as a single (quoted) argument. It will execute the
command and exit. <br 
class="newline" />The other way is to run it interactively by giving no command argument. It will run until the user stops
via the command <span 
class="cmtt-10x-x-109">exit</span>, <span 
class="cmtt-10x-x-109">quit</span>, or <span 
class="cmtt-10x-x-109">q </span>or by giving ctrl/D. A few types of commands can be given:
</p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10x-x-109">help</span>, <span 
class="cmtt-10x-x-109">h </span>or <span 
class="cmtt-10x-x-109">? </span>shows brief help information.
     </li>
     <li class="itemize">A full TaQL command. If no GIVING part is given, the resulting table is not kept. It shows
     the number of matching rows.
     </li>
     <li class="itemize">A full TaQL command preceeded by <span 
class="cmtt-10x-x-109">varname=</span>, where <span 
class="cmtt-10x-x-109">varname </span>is the name under which the
     resulting table is kept in this session. Thus the result is not a persistent table (unless GIVING
     was given), but it is kept temporarily. The name can be used in subsequent commands like
     <span 
class="cmtt-10x-x-109">SELECT FROM $varname</span>.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">varname= </span>without a further command removes the temporary result.
     </li>
     <li class="itemize"><span 
class="cmtt-10x-x-109">varname </span>shows the number of rows in the temporary result. It can be followed by one or more
     question marks to show the column names and details about them. <br 
class="newline" />Note that if an unknown varname is given, it is treated as a TaQL command resulting in a
     parse error.</li></ul>
<!--l. 3565--><p class="noindent" >If columns are selected in the TaQL command, their values are printed. Epoch, position, and direction
measures are printed in a formatted way. Also the result of CALC commands is printed. Otherwise only
the number of selected (or updated or deleted) rows is printed.
</p><!--l. 3571--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.4   </span> <a 
 id="x1-8000011.4"></a>C++ interface</h4>
<!--l. 3572--><p class="noindent" >The C++ programmer can use TaQL commands and expressions at various levels,
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">11.4.1   </span> <a 
 id="x1-8100011.4.1"></a>TaQL query string</h5>
<!--l. 3574--><p class="noindent" >The function <span 
class="cmtt-10x-x-109">tableCommand </span>in <a 
href="../html/classcasa_1_1TableParse.html" >TableParse.h</a> can be used to execute a TaQL command. The result is a
<a 
href="../html/classcasa_1_1Table.html" >Table</a> object. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-130">
&#x00A0;&#x00A0;Table&#x00A0;seltab1&#x00A0;=&#x00A0;tableCommand
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;("select&#x00A0;from&#x00A0;mytable&#x00A0;where&#x00A0;column1&#x003E;0");
&#x00A0;<br />&#x00A0;&#x00A0;Table&#x00A0;seltab2&#x00A0;=&#x00A0;tableCommand
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;("select&#x00A0;column1,column2&#x00A0;from&#x00A0;$1&#x00A0;where&#x00A0;column2&#x003E;5"
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"&#x00A0;orderby&#x00A0;time&#x00A0;giving&#x00A0;result.tab",&#x00A0;seltab1);
</div>
<!--l. 3586--><p class="nopar" > These examples do the same as the Glish ones shown above. <br 
class="newline" />Note that in the second function call the table name <span 
class="cmtt-10x-x-109">$1 </span>is replaced by the object <span 
class="cmtt-10x-x-109">seltab1 </span>passed to the
function. <br 
class="newline" />There is no style argument, so if an explicit style is needed it should be the first part of the TaQL
statement. Note that no style defaults to the Glish style.
</p><!--l. 3595--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">11.4.2   </span> <a 
 id="x1-8200011.4.2"></a>Expression string</h5>
<!--l. 3596--><p class="noindent" >The function <span 
class="cmtt-10x-x-109">parse </span>in <a 
href="../html/classcasa_1_1RecordGram.html" >RecordGram.h</a> can be used to parse a TaQL expression. The result is a
<a 
href="../html/classcasa_1_1ExprNode.html" >TableExprNode</a> object that can be evaluated for each row in the table. E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-131">
&#x00A0;&#x00A0;Table&#x00A0;tab("mytable");
&#x00A0;<br />&#x00A0;&#x00A0;TableExprNode&#x00A0;expr&#x00A0;=&#x00A0;RecordGram::parse&#x00A0;(tab,&#x00A0;"column1&#x003E;0");
&#x00A0;<br />&#x00A0;&#x00A0;Table&#x00A0;seltab1&#x00A0;=&#x00A0;tab(expr);
</div>
<!--l. 3606--><p class="nopar" > The example above does the same as the first example in the previous section. There are, however, better
ways to use this functionality.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-132">
&#x00A0;&#x00A0;Table&#x00A0;tab("somename");
&#x00A0;<br />&#x00A0;&#x00A0;TableExprNode&#x00A0;expr&#x00A0;=&#x00A0;RecordGram::parse&#x00A0;(tab,&#x00A0;"ANTENNA1=1");
&#x00A0;<br />&#x00A0;&#x00A0;for&#x00A0;(uInt&#x00A0;row=0;&#x00A0;row&#x003C;tab.nrow();&#x00A0;++row)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;(expr.getBool(row))&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;expression&#x00A0;is&#x00A0;true&#x00A0;for&#x00A0;this&#x00A0;row,&#x00A0;so&#x00A0;do&#x00A0;something&#x00A0;...
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;}
</div>
<!--l. 3617--><p class="nopar" > The example above shows a boolean scalar expression, but it can also be a numeric expression or an array
expression as shown in the example below. Note that TaQL expression results have data type Bool, Int64,
Double, DComplex, String, or MVTime.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-133">
&#x00A0;&#x00A0;TableExprNode&#x00A0;expr&#x00A0;=&#x00A0;RecordGram::parse&#x00A0;(tab,&#x00A0;"abs(DATA)");
&#x00A0;<br />&#x00A0;&#x00A0;Array&#x003C;Double&#x003E;&#x00A0;data;
&#x00A0;<br />&#x00A0;&#x00A0;for&#x00A0;(uInt&#x00A0;row=0;&#x00A0;row&#x003C;tab.nrow();&#x00A0;++row)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;expr.get&#x00A0;(row,&#x00A0;data);
&#x00A0;<br />&#x00A0;&#x00A0;}
</div>
<!--l. 3629--><p class="nopar" >
</p><!--l. 3631--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">11.4.3   </span> <a 
 id="x1-8300011.4.3"></a>Expression classes</h5>
<!--l. 3632--><p class="noindent" >The other expression interface is a true C++ interface having the advantage that C++ variables
can be used directly. Class <a 
href="../html/classcasa_1_1Table.html" >Table</a> contains functions to sort a table or to select columns or
rows. When selecting rows class <a 
href="../html/classcasa_1_1TableExprNode.html" >TableExprNode</a> (in ExprNode.h) has to be used to build a
WHERE expression which can be executed by the overloaded function operator in class <span 
class="cmtt-10x-x-109">Table</span>.
E.g.
                                                                                         

                                                                                         
</p>
   <div class="verbatim" id="verbatim-134">
&#x00A0;&#x00A0;Int&#x00A0;limit&#x00A0;=&#x00A0;0;
&#x00A0;<br />&#x00A0;&#x00A0;Table&#x00A0;tab&#x00A0;("mytable");
&#x00A0;<br />&#x00A0;&#x00A0;Table&#x00A0;seltab&#x00A0;=&#x00A0;tab(tab.col("column1")&#x00A0;&#x003E;&#x00A0;limit);
</div>
<!--l. 3645--><p class="nopar" > does the same as the first example shown above. See classes <a 
href="../html/classcasa_1_1Table.html" >Table</a>, <a 
href="../html/classcasa_1_1TableExprNode.html" >TableExprNode</a>, and
<a 
href="../html/classcasa_1_1TableExprNodeSet.html" >TableExprNodeSet</a> for more information on how to construct a WHERE expression.
</p><!--l. 3655--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">12   </span> <a 
 id="x1-8400012"></a>Writing user defined functions</h3>
<!--l. 3656--><p class="noindent" >A user defined function has to be written as a class in C++ derived from the abstract base class
<a 
href="../html/classcasa_1_1UDFBase.html" >UDFBase</a>. The documentation of this base class describes how to write a UDF. Furthermore one
can look at class <a 
href="../html/classcasa_1_1UDFMSCal.html" >UDFMSCal</a> that contains the UDFs described in subsection <a 
href="#x1-510004.10.16">User defined
functions</a>.
</p><!--l. 3665--><p class="indent" >   Note that a class can contain multiple UDFs as done in UDFMSCal. Also note that a single UDF can
operate on multiple data types which is similar to a function like <span 
class="cmtt-10x-x-109">min </span>that can operate on scalars and
arrays of different data types.
</p><!--l. 3670--><p class="indent" >   TaQL finds a UDF by looking in a dictionary that maps the UDF name to a function constructing an
object of the UDF class. If not found, it tries to load the shared library with the lowercase
name of the library part of the UDF (like in <span 
class="cmtt-10x-x-109">derivedmscal.pa1</span>). If the load is successful, it
calls an initialization function in the shared library that should add all UDF functions in the
library to the dictionary. The description of the <a 
href="../html/classcasa_1_1UDFBase.html" >UDFBase</a> class shows how this should be
done.
</p><!--l. 3679--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">13   </span> <a 
 id="x1-8500013"></a>Possible future developments</h3>
<!--l. 3680--><p class="noindent" >In the near or far future TaQL can be enhanced by adding new features and by doing optimizations.
</p>
     <ul class="itemize1">
     <li class="itemize">Implement the GROUP BY and HAVING clause, possibly with ROLLUP and CUBE.
     </li>
     <li class="itemize">Add explicit JOIN clause (probably only equi-joins).
     </li>
     <li class="itemize">Add UNION, INTERSECTION, and DIFFERENCE.
                                                                                         

                                                                                         
     </li>
     <li class="itemize">Add masked arrays.
     </li>
     <li class="itemize">Optimize by removing an <span 
class="cmtt-10x-x-109">IN </span>node if the righthand operand is empty. This cannot be done if
     the lefthand operand is variable shaped.
     </li>
     <li class="itemize">Handle invalid subexpressions (e.g. exceeding array bounds) as undefined values which can
     be tested with the function ISDEFINED.
     </li>
     <li class="itemize">Optimize IN if righthand is an integer bounded set by turning it into a boolean vector.</li></ul>
    
</body></html> 

                                                                                         


